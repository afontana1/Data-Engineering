OTA Requestors should invoke the ApplyUpdateRequest command once they are ready to apply a previously downloaded Software Image (Section ApplyUpdateRequest Command).

The 'WiFiSecurityBitmap' data type encodes the supported Wi-Fi security types present in the Security field of the WiFiInterfaceScanResultStruct.

Defined in Section 2.11.2.2, “Subscribe Interaction Limits”.

The subject key identifier of the DAC is 96:C2:D9:24:94:EA:97:85:C0:D1:67:08:E3:88:F1:C0:91:EA:0F:D5.

Matter is the foundation for connected things, serving as an industry-unifying standard for reliable, seamless, and secure connectivity across smart home devices and ecosystems.

An interaction is defined as a sequence of transactions.

Secure Session Message Counters exist for as long as the associated security session is in effect.

The revisions mentioned in the revision history of the On/Off Light device are: - 0 Represents device definitions prior to Zigbee 3.0 - 1 Initial Zigbee 3.0 release - 2 New data model format and notation

The KeySetRead command sends a SUCCESS status code back to the initiator upon success, or NOT_FOUND if the requested GroupKeySetID did not exist.

The Manual Pairing Code can be used in certain situations next to or instead of the QR code for device setup.

When EnableTagCompression is false or not present, Attribute and ListIndex tags have specific semantics, such as selecting all attributes within the specified Node, Endpoint, Cluster, or selecting specific attributes or list items.

The DAC is signed using the ecdsa-with-SHA256 signature algorithm.

Example encoding for concatenated Onboarding Payloads in a QR Code: MT:<onboarding-base-38-content1><onbo arding-base-38-content2><onboarding-ba se-38-content3> Example encoding for NFC tag using NDEF URI Record Type Definition: 0xD1 0x01 <URI payload size> 0x55 0x00 MT:<base-38-content>

In this user journey, the user first initiates an interaction with a Commissioner and then indicates an intention to commission existing devices on the IP network without providing additional information about them. The Commissioner then sends the Commissionable Node Discovery broadcast message, constructs a list of Commissionees discovered, and presents the list to the user for selection.

The Time Synchronization Cluster provides attributes for reading a Node’s current time and allows Administrators to set the current time, time zone, and daylight savings time (DST) settings.

The MsgCounterSyncReq message is sent when a message is received from a peer whose current message counter is unknown.

If the verification fails, the receiver silently ignores the MsgCounterSyncRsp message.

The Administrator Commissioning Cluster is used to trigger a Node to allow a new Administrator to commission it. It defines Attributes, Commands, and Responses needed for this purpose.

The Group Session ID provides receiving nodes with a means to efficiently identify potential Operational Group Key candidates without the need to attempt decryption using all available keys. While the Group Session ID may not serve as the sole means for locating the associated Operational Group Key due to potential collisions within the fabric, it significantly narrows down the candidate keys for decryption. Upon receipt of a groupcast message, receiving nodes attempt decryption using all valid, installed Operational Group Key candidates referenced by the given Group Session ID. This approach minimizes the computational overhead by reducing the number of keys that need to be tried for decryption, enhancing the efficiency of message processing.

In Matter, all messages, including transport headers, must fit within the minimal IPv6 MTU of 1280 bytes. Therefore, the maximum message size allowed for messages transmitted over UDP is 1280 bytes.

The Status field indicates the result of an attempt to retrieve diagnostic logs.

It indicates the currently measured output voltage of the battery, in mV (millivolts).

Matter certificates do not use ASN.1 OIDs; instead, each valid ASN.1 OID is mapped to a Matter TLV tag within its reference category.

Protection against physical attacks is needed for some Devices, as determined by the manufacturer, especially those impacting cybersecurity.

The key usage extension shall be encoded with exactly two flags: keyCertSign and CRLSign.

Upon receipt of Msg3, the responder performs several steps to validate the message and initialize the session.

ProductID is encoded as an AttributeTypeAndValue entry with the type equal to 1.3.6.1.4.1.37244.2.2, following the encoding specified in Section 6.1.1.

The Valid Read Attribute Paths table defines valid attribute data paths for Read Request or Subscribe Request actions. It provides combinations of specific and wildcard paths for accessing attribute data from clusters, endpoints, and nodes.

The MaxIntervalCeiling parameter specifies the requested highest maximum interval value.

The operational root of trust, identified by the Root CA's public key, is responsible for allocating correctly scoped fabric identifiers. The uniqueness of identifiers within any root CA is ensured through collaboration between the commissioner and the root CA.

The 'InterfaceEnabled' attribute indicates whether the associated network interface is enabled or not.

Yes, it may be partitioned over multiple entries in the Device Attestation PKI Revocation Distribution Points Schema.

The automatic retry mechanism in MRP is triggered after a period of mrpBackoffTime milliseconds without receiving an acknowledgment.

The ID of the command is 0x00, and its name is ResetCounts.

Devices use random initialization vectors.

The Year field represents years from 1900 to 2155, with a range of values from 0 (1900) to 255 (2155).

Each peer in a Secure Unicast Session maintains its own message counters, with independent counters being used for each unique session.

An ICD typically determines its mode based on the presence of active Exchanges in the Message Layer. While Exchanges are active, the ICD remains in Active Mode. Once all Exchanges are closed and there are no other reasons for staying active, the ICD transitions to Idle Mode. Additional modes and logic for switching may be utilized by the ICD.

Action Attribution should be recorded against the Incoming Subject Descriptor rather than against any matched Access Control Entry’s contents.

The elements are DataVersion, Path, and Data.

Unique local address

If PBKDFParamRequest.hasPBKDFParameters is True, the responder does not include the PBKDF parameters (i.e., salt and iteration count) in the Crypto_PBKDFParameterSet.

DeltaSystemTimestamp is used to encode a delta change in system timestamp relative to a prior event in a TLV structure.

The Super Disco Ball cluster supports features such as Axis, Wobble, Pattern, Statistics, and Reverse.

The future-extension tag allows for the inclusion of any valid ASN.1 OID for future extensions in the Matter certificate structure.

A downstream subscription is when clients subscribe to the proxy.

Unsecured communication is limited to Discovery, User Directed Commissioning (UDC), and Session establishment.

For session resumption to succeed in CASE, both the Initiator and Responder must possess and utilize the SharedSecret computed during the previous session establishment. This SharedSecret is used to compute the resumption ID, facilitating the resumption process.

No, a ProductID value is not present in either the subject or issuer fields of the PAA certificate.

Nodes SHOULD validate configuration and input for length, and acceptable values and ranges before applying them. This validation is dependent on the configuration or input being applied (see Access Control Cluster). Configuration and input validation is explicitly defined in relevant sections of the specification.

The status codes used in StatusReport messages in the BDX protocol are listed in Table 80. These codes signify reasons for failing or rejecting a transfer.

The Management Opcodes for BTP Control Frames are defined in Table 28, “BTP Control codes”.

The Node Operational Credentials Cluster is used to add or remove Node Operational credentials on a Commissionee or Node, as well as manage the associated Fabrics.

The Interaction Model layer defines a set of interactions between a client and server device, like reading or writing attributes, based on the elements defined at the Data Model layer.

The RxDataCount attribute indicates the total number of received unique MAC Data frames.

It indicates an action as defined in the Interaction Model specification.

The PAI certificate includes Basic Constraint (critical, CA:TRUE, pathlen:0), Key Usage (critical, Certificate Sign, CRL Sign), Subject Key Identifier, and Authority Key Identifier extensions.

Matter incorporates privacy-preserving mechanisms in its core specification, such as unique random node identifiers, session establishment with configurable privacy, and encryption of node identifiers in messages to prevent eavesdropping entities from identifying communicating parties.

They are not generated by any Node but are stored and transmitted to a Commissioner by a Commissionee during the conveyance of the Attestation Information in response to an Attestation Request command.

The Read Request Action includes fields such as AttributeRequests, DataVersionFilters, EventRequests, EventFilters, and FabricFiltered, specifying the requested attribute and event data, data versions, event numbers, and fabric-scoped filtering.

The NFC Tag is used as an alternative to the QR Code and Manual Pairing Code for retrieving the Onboarding Payload. It provides a convenient method for commissioning devices using NFC-enabled devices such as smartphones.

There are two commands: Proxy Discover Request and Proxy Discover Response.

The layer should process the Subscribe Request action according to the defined Incoming Read Request and Subscribe Request Action Processing.

Protocol Data Unit

The AddNOC command immediately responds to errors by sending an NOCResponse with the prescribed StatusCode field. It leaves all non-volatile state of the device untouched and ensures that the information about the last CSR state associated with the session remains intact.

A key word that used to describe that the requirement is the inverse of the behav­ ior specified (i.e. SHALL NOT, MAY NOT, etc)

The ListIndex tag is nullable, and the null value indicates a list append operation when used in an AttributeDataIB.

Based on the Action field in the ApplyUpdateResponse command, the OTA Requestor can proceed with applying the update, await further action, or discontinue the update process (Section Update application process).

Comprehensive security in Matter is implemented with a layered approach, incorporating authentication and attestation for commissioning, protection of every message, and securing over-the-air firmware updates.

Group Session IDs are sized to fit within the context of the Session Identifier field of a message, ensuring compatibility with message formats and protocols. When utilized in message processing, the Group Session ID value enables receiving Nodes to identify the appropriate message encryption key from the set of active operational keys currently installed. This identification process streamlines message decryption by directing Nodes to the correct encryption key without extensive trial and error. Thus, Group Session IDs play a critical role in optimizing message processing efficiency by providing a concise yet effective means of key identification within message contexts.

Unsigned integer schema types are encoded using the TLV unsigned integer type, with the width selected automatically at runtime based on the actual value.

Each device type definition must include specific clusters as a minimum set, based on defined conformance. The table assumes the Zigbee conformance condition is TRUE.

To associate the four new Nodes (0x3333_3333_3333_3333, 0x4444_4444_4444_4444, 0x5555_5555_5555_5555, and 0x6666_6666_6666_6666) with an existing node (0x2222_2222_2222_2222) into a CAT group, the Administrator issues NOCs to all five nodes with a CAT value of 0xABCD_0001. This CAT value is encoded as subject value 0xFFFF_FFFD_ABCD_0001.

It is derived from an octet string with UTF-8 encoding characters, recommending constraints on maximum string length.

When a Fabric is removed, either through the RemoveFabric command or factory reset, the Node Operational Identifier, including the FabricID and NodeID, is permanently removed from the Node's memory.

A value of 0 for the passcodeID corresponds to the PAKE passcode verifier for the currently-open commissioning window, if any.

- Matter revision 1 is considered equivalent to revision 16. - Subsequent releases of Matter start at revision 17.

Each endpoint supporting the Pump device type SHALL include the following clusters: - On/Off Server - Pump Configuration and Control Server - Identify Server - Level Control Server - Scenes Server - Groups Server - Temperature Measurement Server - Pressure Measurement Server - Flow Measurement Server - Temperature Measurement Client - Pressure Measurement Client - Flow Measurement Client - Occupancy Sensing Client

The Report Data Action includes fields such as SuppressResponse, SubscriptionId, AttributeReports, and EventReports, specifying whether to suppress response, subscription ID, and lists of attribute and event reports.

The Version nibbles in the BTP Handshake Request frame are used to negotiate the highest version capability between a Device pair. Supported versions are listed once each, newest first, in descending order. Unused version fields are filled with ‘0’.

The VerificationKey field provides a verification key that is used for clients with administrator permissions to modify entries.

- Conformance expressions support boolean logic using NOT, OR, AND, XOR, equal, and not equal operators. - Expressions represent dependencies. - The order of operations is defined. - If an expression is false, there is no assumption of general optionality.

The FabricDescriptorStruct type encodes a Fabric Reference for a fabric within which a given Node is currently commissioned. It contains fields such as RootPublicKey, VendorID, FabricID, NodeID, and Label.

ReportDataMessage is used to send reports containing attribute and event data in a TLV structure format.

AttributeDataIB is used in Write Request and Report Data actions. It represents information about the data to be written or reported, including the data version, change type, path, and data itself.

The Peer Session Identifier is assigned by the peer during session establishment and is used in the Session ID field of every outgoing message associated with the session, so that it can be interpreted as the Local Session Identifier by the remote peer.

When DeltaEpochTimestamp is present, all other timestamp tags are omitted.

It only supports CMS version v3.

The EventTrigger field indicates the test or test mode which the client wants to trigger.

The provisional items listed in the specification include: - Support for Heating/Cooling Unit is provisional. - Support for Fan device type is provisional.

The available schemas include Vendor Schema, PAA Schema, DeviceModel Schema, DeviceSoftwareVersionModel Schema, Compliance Schema, and Device Attestation PKI Revocation Distribution Points Schema.

Epoch keys are marked as disabled by assigning them the maximum start time. This action renders the corresponding epoch key slot unused within the system. By disabling epoch keys in this manner, their usage is effectively terminated, preventing any further communication or data exchange secured under these keys. This mechanism ensures that outdated or compromised keys are effectively removed from circulation, maintaining the integrity and security of group communication within the fabric.

The RegisterClient command allows a client to register itself with the ICD to be notified when the device is available for communication.

Status codes are either global Interaction Model status codes or cluster-specific status codes unique to the cluster.

The Onboarding Payload is the information necessary to initiate the commissioning process of a Device, containing data required for secure integration into a network.

An Epoch Time value can be interpreted in local clock date/time by considering the local time offset as 0, or converted to UTC time by subtracting the associated local time offset.

The Basic Constraint extension is marked critical with cA field set to TRUE and pathLen field set to 0.

A request path may be expanded into a list of existent paths, with each wildcard path replaced by a complete list of existent paths.

The actions carried out by a Pump device on receipt of commands are: - Off: If the pump is powered on, store the current level then immediately power it off. - On: If the pump is powered off, power it on and move immediately to the level stored by a previous Off command. If no such level has been stored, move immediately to the maximum level allowed for the pump. - Toggle: If the pump is powered on, proceed as for the Off command. If the device is powered off, proceed as for the On command.

The response to the ResetCounts command is YES (Y) with an optional (O) ERRCNT attribute.

The main focus of the System Model Specification is to establish and manage relationships between endpoints and clusters, enabling automated data flow and control within a system.

A Device exits commissioning mode after 20 failed commissioning attempts.

A publisher discovers loss of synchronization by not receiving a Status Response to a Report Data message that expects a response, or by receiving an error Status Response.

A manufacturer can use the Fixed Label Cluster to identify characteristics of an endpoint, such as indicating the orientation of a luminaire's endpoints.

Values and descriptions of ProductFinishEnum are: 0 - Other (Product has some other finish not listed below), 1 - Matte (Product has a matte finish), 2 - Satin (Product has a satin finish), 3 - Polished (Product has a polished or shiny finish), 4 - Rugged (Product has a rugged finish), 5 - Fabric (Product has a fabric finish).

The type of certification for the CD, such as development and test purposes, provisional, or official.

The PacketMulticastRxCount attribute indicates the number of multicast packets received by the Node.

Octet string types are encoded using TLV Byte Strings.

Devices SHOULD protect the confidentiality of attestation (DAC) private keys. The level and nature of protection for these keys may vary depending on the nature of the Device. [CM77 for T22]

A group path targets endpoints that are members of a group using a group ID instead of indicating a node and endpoint.

Matter devices must be tolerant of IPv4 addresses and may ignore those addresses for the purposes of Matter operations, ensuring compatibility and coexistence with IPv4 network infrastructure.

The default value is unspecified.

ClusterPathIB is a common information block used in attribute paths. It consists of fields such as Group, Node, Endpoint, and Cluster, each specifying certain identifiers or types within a path.

The ProductAppearanceStruct provides a description of the product’s appearance, including fields like Finish and PrimaryColor.

A Software Image is a data blob used by a Node to update its software, conforming to the OTA Software Image File Format for the purposes of OTA Software Update.

Threat T24: Factory provisioned keys captured in factory, transit, or store (e.g., with fault injection or other tampering). [CM23, CM113]

The RemoveFabric command is used by Administrators to remove a given Fabric and delete all associated fabric-scoped data.

A message received for reliability processing in MRP is processed by first verifying the legal combination of reliability flags, then proceeding to Exchange Message Matching and Received Acknowledgment Processing.

The StableDataVersion attribute indicates the Network Data Version for the stable subset of data the Node currently uses.

Upon receipt of the ApplyUpdateRequest command, OTA Providers should respond with an Action field consistent with the next action the OTA Requestor should take, including any possible time delay (Section ApplyUpdateRequest Command).

Configuration for secure channel protocol is carefully negotiated and validated by both parties.

Bindings are created and managed using the Binding cluster on an endpoint, where a director (remote client) can create one or more binding entries indicating remote node's endpoint or cluster.

No, the Time Synchronization Cluster MAY be present on the root node endpoint, but it SHALL NOT be present on any other endpoint of any Node.

A DeviceSoftwareVersionModel is identified by a unique combination of VendorID, ProductID, and SoftwareVersion.

The data type of ProductFinishEnum is derived from enum8.

The Fabric ID, a 64-bit value, is chosen randomly or algorithmically but allocated uniquely within the set of all possible Fabric IDs for which a given Root CA will sign operational certificates. The Commissioner attempts to ensure reuse of existing Fabrics before allocation, and the uniqueness constraint is enforced within the scope of the serving Root CA.

Access to Validator Nodes is tightly restricted, for example, with a VPN that only permits Validator Nodes, Observer Nodes, and authenticated clients with write access.

The EventReportIB is used to report event-related information.

The InvokeResponseIB is used to respond to an invoked command.

Administrators should strive to minimize resource usage by combining entries where appropriate and considering the use of CASE Authenticated Tags (CATs) for commonly used sets of Nodes.

A NOC should be protected against unauthorized access to the Node Operational Private Key, leaving the Private Key on the device, privacy violations, and lack of wiping if the Node is factory reset.

The node impacted by the ActionID is specified in the provided text.

The initiator uses the I2RKey for encryption and integrity protection of messages, and the R2IKey for decryption and message verification. Conversely, the responder uses the R2IKey for encryption and integrity protection of messages, and the I2RKey for decryption and message verification.

Projects in Matter are used to track larger efforts that don't fit in issues, have multiple subsystems involved, or may span multiple milestones. They are also used to track burn down on larger tasks and categorize broader efforts without a definite time scope.

Protocol layers below this layer may have constraints that only support a subset of the functionality described here.

Best practices for IoT security include ensuring proven device identity/authenticity, secure communication, and access control.

The ResumeAction command resumes a previously paused action, changing the action’s state to Active.

For regional roll-outs, it is recommended to use manufacturer-specific schemes in addition to the common flows described in the cluster, as the common flows do not support regional roll-outs (Section 11.19.5.1).

If an Incoming Write Request action cannot be executed due to the maximum supported number of Write interactions already in progress, a Status Response action with the BUSY Status Code SHALL be submitted to the message layer, and this interaction SHALL terminate.

Administrators should aim for best-effort eventual consistency.

The TLV Type for AttributeDataIB is Structure.

The CheckInNodeID field provides the registered client NodeID to remove from storage.

An MEI identifies an item in an MEC and has no meaning beyond the context of that MEC. It consists of a prefix that encodes a source (standard, scoped, or a particular MC) and a suffix that encodes an item’s key (in context of MEC + source).

The payload of CASE messages follows a TLV encoding format. Each message has its own TLV encoding structure, as listed in Table 23 of the specification.

Group paths target endpoints belonging to specific groups using group IDs instead of node and endpoint identifiers, as explained in this section.

The TxAckedCount attribute indicates the total number of unique MAC frame transmission requests that were acknowledged.

The basic constraints extension shall be encoded with is-ca set to true.

A Group ID is a 16-bit identifier for a group that is scoped to a particular fabric, also indicated by an accompanying fabric index.

The User Label Cluster has the LabelList attribute.

Yes, for example, reading cluster 0x0000_ABCD on endpoint 1 might return mandatory attribute 0x0000_0001, optional attribute 0x0000_0009, and manufacturer-specific (MS) attributes 0x000A_0001 and 0x000A_0002.

It indicates an event defined in a cluster specification and shall be a Manufacturer Extensible Identifier.

Similar to previous sections, it tracks revisions of the cluster specification.

Manufacturers might utilize the Data field to store structured data, including metadata and cryptographic signatures. This data could be used, for example, to verify a fabric's Access Control List by generating a canonical bytestream from the Access Control Entries and verifying the signature against it.

The AccessControlEntriesPerFabric attribute specifies the minimum number of ACL Entries per fabric supported by the server. This value should not decrease across time as software updates occur.

The Type field indicates the type of the interface using the InterfaceTypeEnum.

RequestCommandElement = { CommandPath = [[ Endpoint = 10, Cluster = Disco Ball, Command = Stop Request ]] }

The Delay attribute is null when there is no dataset configured.

The ICD Counter attribute returns the value of the ICD Counter.

The Status Codes define valid values for the Status field in the StatusIB, indicating whether the action was successful or encountered errors.

Transmission Control Protocol

The BTP session handshake allows devices to check BTP protocol version compatibility and exchange other data before establishing the session. Once established, the session is used to send and receive BTP SDUs (such as Matter messages) as BTP Message Segments.

Matter treats networks as shared resources, allowing for the overlay of multiple Matter networks over the same set of IP networks without stipulating exclusive ownership or access.

The Device Type specification defines the pattern used for composition, either by a table listing device types for tree pattern or stating support for full-family pattern.

A Role defines a set of related behaviors of a Node, with each Node capable of having multiple roles within a network.

Access privileges are granted by explicitly codified rules within Access Control Entries (ACEs) in the Access Control List (ACL) of each Node. The Access Control system verifies all attempted access against these rules. During the commissioning phase, administrative access privileges are implicitly granted to an Administrative Subject. Access privileges are categorized based on the AccessControlEntryPrivilegeEnum enumeration.

- For messages sent from the BTP Client to BTP Server, the BTP uses the GATT Write Characteristic Value sub-procedure. - For messages sent from the BTP Server to BTP Client, the BTP uses the GATT Indications sub-procedure.

The Attribute and Cluster fields within the Path element must always be present.

The Session ID field, an unsigned integer value, identifies the session associated with the message. It determines the encryption key and encryption/message integrity algorithm to use for the message. The Session ID field is always present in a message.

In the context of the Binding cluster specification, the global ClusterRevision attribute value is set to the highest revision number listed in the Revision Description table, ensuring consistency and clarity regarding the latest version of the Binding cluster specification.

No, not every X.509 certificate can be represented as a Matter certificate, although every Matter certificate can be represented as a corresponding X.509 certificate.

The ID of the event is 0x00, and its name is Disconnection.

The direction of the ResetCounts command is Client ⇒ Server.

Upon Factory Data Reset, the Access Control Cluster is empty, meaning it contains no entries in the Access Control List (ACL).

List entries in the DSTOffset attribute shall be sorted by ValidStarting time.

Operational group keys play a crucial role in facilitating secure communication and collaboration within operational groups. These keys are shared among Nodes within a group and enable them to exchange messages confidentially and without fear of manipulation by non-members. By utilizing operational group keys, Nodes can prove their membership in the associated group, exchange messages securely, and encrypt data in such a way that only group members can decrypt it. This ensures the integrity and confidentiality of communications within the operational group.

In a single network topology, all Matter devices are connected to a single logical network, which could span multiple Wi-Fi and/or Ethernet segments if bridged at the link layer.

The purpose of the Write Path Data Process is to process each data field indicated by the path, ensuring it complies with the constraints defined by the cluster specification, and generating AttributeStatusIB accordingly.

A list is an ordered collection of member elements, each of which may be encoded with a tag.

An acknowledgement is considered invalid if the acknowledged sequence number does not correspond to an outstanding, unacknowledged BTP packet sequence number.

Defined in Section 11.17.5, “Attributes”.

It refers to the quality of information in an information block.

In encrypted messages of Group Session Type, arriving messages with counters in the range [(max_message_counter + 1) to (max_message_counter + 2^31 - 1)] (modulo 2^32) are considered new and update the max_message_counter value. Messages with counters from [(max_message_counter - 2^31) to (max_message_counter - MSG_COUNTER_WINDOW_SIZE - 1)] (modulo 2^32) are considered duplicate.

In the context of Access Control Entries (ACEs), "Wildcards" refer to the capability to grant a given privilege to multiple Subjects or Targets within the ACEs. An empty Subjects list signifies that every possible Subject using the stated Authentication Mode is granted the privilege over the Targets. Similarly, an empty Targets list means that every Cluster on every Endpoint exposed by the Node is accessible using the granted privilege to any matching Subject. Wildcards provide flexibility in defining access control policies, especially for common view/read/discover access based on Authentication Mode.

An Exchange is bound to exactly one underlying session, which can be one of the following session types: secure unicast (established by PASE or CASE), unsecured (used for the initial session establishment phase of a PASE/CASE session), secure group, or MCSP.

In Example 5, the user can prevent the automated steps from occurring by using the DisableAction command, changing the action’s state to Disabled. Alternatively, the user can specify a time period for the disabling using the DisableActionWithDuration command.

It is derived from enum16.

- If the Duplicate condition applies to child endpoints of an Aggregator representing multiple independent bridged devices, the endpoints should make metadata available, such as the NodeLabel attribute of the Bridged Device Basic Information cluster. - For sibling endpoints with Content App device types, the Node should ensure that the ApplicationName attribute of the Application Basic cluster on each endpoint has a unique value. - In all other cases, each endpoint affected by the Duplicate condition should have a TagList attribute with distinct tags from any overlapping sibling endpoint.

Secure session establishment mechanisms are provided using either certificates (CASE) or shared passcodes (PASE).

If a nonce is duplicated for a given key, the security consequences are isolated only to the specific key with which the duplicate nonce occurred — a key that has not been updated prior to rollover and has been presumably abandoned or aged out.

The CounterClockwise value indicates that the disco ball is currently rotating in the counterclockwise direction.

The purpose of the Access Control features is to regulate access to a Node's Endpoint Clusters (referred to as "Targets") from other Nodes within the Matter ecosystem. It ensures that only authorized Nodes can access specific application-layer functionality exposed by the Data Model through the Interaction Model, thereby serving as a fundamental link between the Secure Channel and the Interaction Model.

The UnregisterClient command allows a client to unregister itself with the ICD, typically used when a client is leaving the network to prevent burden on the ICD.

If the server determines that it and the client do not share a supported BTP protocol version, it closes the BLE connection to the client. Additionally, timers are started by both the client and server upon sending/receiving handshake requests. If these timers expire before receiving appropriate responses, the BTP session is closed, and an error is reported to the application.

Vendors can add new device models associated with their VendorID and update certain information such as product details and firmware. TestHouse roles can write test statuses, while ZBCertificationCenter roles can confirm or revoke compliance status.

The SupportsConcurrentConnection attribute indicates whether the device supports "concurrent connection flow" commissioning mode.

Matter provides guidance to device manufacturers to select appropriate platform security based on risk and threat analysis of their devices' use cases.

After initial Commissioning of a Device, subsequent Commissioning SHALL only be triggered by an Administrator or an equivalent entity where the user gives administrative consent.

The responder sets the Peer Session Identifier in the Session Context to the value PBKDFParamRequest.initiatorSessionId.

The initiator generates the S2K key using Msg2.responderRandom as Responder Random and Msg2.responderEphPubKey as Responder Ephemeral Public Key.

Universal Group Identifier

The ActiveCalendarType attribute represents the calendar format that the Node is currently configured to use when conveying dates.

In an example scenario depicted in Figure 24, the client sends a three-segment buffer to the server once it receives the server’s handshake request. The handshake request occupies one slot in the client’s initial receive window, while the server's initial window is empty. Both client and server have a maximum window size of 4. The diagram illustrates how packet acknowledgements are managed as part of the flow control mechanism defined in the BTP protocol.

Upon receipt of the StayActiveRequest command, the server increases the remaining time in active mode by one ActiveModeThreshold.

The different IntentEnum types are EndUserSupport, NetworkDiag, and CrashLogs.

Matter allows device manufacturers to select the appropriate platform security based on the risk and threat analysis of their device's use cases, ensuring it does not compromise ease of use and functionality.

If the RequestedProtocol is set to BDX and the Node does not support BDX, the Node shall utilize the LogContent field of the RetrieveLogsResponse command to transfer as much of the current logs as it can fit within the response, and the Status field of the RetrieveLogsResponse shall be set to Exhausted.

It serves as the main method of delivering interoperable and universally accessible revocation information for Matter Commissioners and Administrators.

Read access to DCL is public, allowing access to device model information, compliance states, and Product Attestation Authorities certificates.

The Binding attribute is used to represent bindings between endpoints, specifying communication relationships.

The Namespace type identifies the namespace used for a semantic tag.

Example 4 illustrates a wake-up routine where the lights in the bedroom gradually become brighter and change in color temperature to simulate a sunrise.

The privacy encoding process is depicted graphically in Figure 10, titled "Matter Message Privacy".

Matter is an open standard, allowing anyone to inspect the template for interactions between legitimate Matter nodes.

The TimedRequest tag in InvokeRequestMessage indicates if the request is timed, meaning it has a specific time constraint.

The incremented outgoing message counter is stored in the OutgoingMessageCounter element associated with the Session Context for the message. If the message counter wraps around from 0xFFFF_FFFF to 0x0000_0000 and the message is of Secure Unicast Session Type, the Encryption Key is expired in the Session Context, requiring renegotiation of the session to resume communication after transmission of this final message.

They are reserved for future use and should be ignored at read time, set to zero at issuance time.

The TestEventTrigger command provides a means for certification tests to trigger testplan-specific events necessary to assist in automation of device interactions for certification test cases.

The BatChargeFaultEnum data type specifies various fault conditions related to battery charging, including ambient temperature, battery temperature, battery absence, charger voltage, and charging safety timeout.

The DataVersion attribute indicates the full Network Data Version the Node currently uses.

Applications presenting the Manual Pairing Code should provide mechanisms (e.g., copy button) for easy conveyance of the information to other commissioners on the same device. Applications acting as commissioners should provide mechanisms (e.g., paste button) for easy conveyance of the information from an administrator on the same device. The receiving application should be robust against characters like dashes and spaces for readability.

Matter functional security embodies comprehensive, strong, easy to use, resilient, and agile properties.

An Endpoint is a component within a Node that is individually addressable, representing a specific functional element of the Device.

When used in Matter Operational Certificate (TLV) format, Matter-specific DN attribute types are encoded as unsigned integers with the specified length.

The ProtocolCode of Protocol-Specific Status represents the specific status code within the protocol being reported.

The TimeZoneDatabase attribute indicates whether the node has access to a time zone database, which allows it to handle time zone changes and update DSTOffset attributes as required.

The revisions mentioned in the revision history of the Color Temperature Light device are: - 0 Represents device definitions prior to Zigbee 3.0 - 1 Initial Zigbee 3.0 release - 2 New data model format and notation

It performs the generate and encrypt computation on a payload and associated data using a symmetric key and nonce, outputting the ciphertext and tag truncated to the specified MIC length.

The attributes of the Wi-Fi Network Diagnostics Cluster are BSSID, SecurityType, WiFiVersion, ChannelNumber, RSSI, BeaconLostCount, BeaconRxCount, PacketMulticastRxCount, PacketMulticastTxCount, PacketUnicastRxCount, PacketUnicastTxCount, CurrentMaxRate, and OverrunCount.

The InterfaceTypeEnum "WiFi" indicates a Wi-Fi interface.

Matter uses passcodes and certificates for setting up secure sessions and employs device attestation to ensure authenticity.

A Pump device is a pump that may have variable speed. It may have optional built-in sensors and a regulation mechanism. It is typically used for pumping fluids like water.

Upon receipt of a Status Response Action with an error Status Code, the interaction layer terminates the current transaction and interaction and submits the error to the layer above.

It is recommended that every implementer of OTA Provider logic implement a transparent and easy-to-use functionality for allowing Users to provide or deny consent for software updates (Section User consent recommendations).

If the Report Data action is generated successfully, it is submitted to the message layer for further processing.

The Classification of the Basic Information Cluster is as follows: Hierarchy - Base, Role - Utility, Scope - Node, PICS Code - BINFO.

It indicates the ID of the preferred chemistry of the battery source.

A Command involves requests for action on a value, expecting a response. It may include parameters and yields a response that carries a status and possibly other parameters.

- Each added extension generates an event with ChangeType Added. - Each changed extension generates an event with ChangeType Changed. - Each removed extension generates an event with ChangeType Removed.

The version field must be set to 2 to indicate a v3 certificate.

Cryptographic Message Syntax

The Data field in the AccessControlExtensionStruct type is used to store arbitrary TLV-encoded data, which manufacturers can use to include various metadata and cryptographic signatures related to a fabric's Access Control Entries.

A Dimmable Plug-In Unit is a device capable of being switched on or off and having its level adjusted by means of a bound controller device such as a Dimmer Switch or a Color Dimmer Switch. It is typically used to control a conventional non-communicating light through its mains connection using phase cutting.

User Datagram Protocol

The AttachAttemptCount attribute indicates the number of attempts made to attach to a Thread network while the Node was detached from all Thread networks.

The future extension field is encoded as OCTET STRING and is an exact copy of the DER encoded extension field (including the DER encoded ASN.1 OID of the extension) in the corresponding X.509 certificate. The extension fields in a Matter certificate shall be encoded in the same order as they appeared in the original X.509 certificate.

The special value 0 in the not-after field indicates that there is no well-defined expiration date for the certificate.

The Administrator managing the group is responsible for determining which Nodes are part of the group and ensuring that communication among these Nodes is appropriate for the given application and security requirements. This involves composing groups of Nodes where communication is suitable and managing access to shared keys accordingly. The Administrator must also oversee the distribution and revocation of credentials required for generating operational group keys to maintain the security of the system.

The ASN.1 OID iso(1) member-body(2) us(840) ansi-x962(10045) curves(3) prime(1) prime256v1(7) represents the prime256v1 elliptic curve.

Threat T169: DoS/DDoS of Validator Nodes. [CM163]

No, the ordering of items within the SupportedLocales attribute should not express any meaning.

The Power Source Configuration Cluster describes the configuration and capabilities of a Device’s power system and provides an ordering overview of power sources associated with a Node.

All member elements of an array must be anonymous elements, encoded with an anonymous tag.

An ec-signature in the context of the Matter certificate structure is the encoding of the signature, represented as an OCTET STRING with a length of (CRYPTO_GROUP_SIZE_BYTES * 2) octets, adhering to the specifications outlined in Section 3.5.3, “Signature and verification”.

The support for an Invoke Interaction with multiple paths or wildcard paths is provisional, meaning it's under consideration and not yet a permanent part of the standard.

The context-specific tag authority-key-id [5] is used to identify an authority key identifier extension entry in the Matter certificate extensions list.

Threat T117: Incorrect fusing of production Devices. [CM113]

Exactly one of AdminNodeID and AdminPasscodeID should be set, depending on whether the change occurred via a CASE or PASE session; the other should be null.

- ID, Name, Field, Conformance, Access, Summary

The steps include OTA Provider announcement, OTA Requestor querying the OTA Provider, obtaining user consent, obtaining and downloading the new Software Image, notifying the OTA Provider of download completion, applying the update, and notifying the OTA Provider of successful update application.

The ClientList attribute lists each cluster ID for the client clusters present on the endpoint instance.

Each Bridged Node root endpoint must include clusters such as Actions and Identify based on the specified conformance.

The ArmFailSafe command is used to arm or re-arm the "fail-safe timer" with an expiry time set for a duration specified in seconds.

The PASE protocol relies on a Password-Based Key Derivation Function (PBKDF), where the passcode is used as the password, in conjunction with Section 3.10, "Password-Authenticated Key Exchange (PAKE)," to establish the session.

The 'ScanMaxTimeSeconds' attribute specifies the maximum duration, in seconds, taken by the network interface to provide scan results.

The ThreadMetricsStruct type represents metrics related to individual threads, including ID, name, and memory usage.

Matter: Commissioning, HomeKit: Pairing, Weave: Pairing, Thread: Commissioning, Zigbee: Association

The DataVersion field in AttributeDataIB represents the version of the data being written or reported. It is not present for group or wildcard paths and may be present for paths in Write Request or Report Data actions.

Matter's Docker/remote container workflow has been tested on macOS 10.5, Windows 10 Pro with WSL and Ubuntu 18 LTS, and Linux with Fedora Core 35 distribution.

The Stopped event is generated when the Run attribute changes from true to false.

Similar to the first example, the sample CSA CD Signing Certificate and Private Key provided are for exemplary purposes and are not official CD signing material. They are used in the example for demonstration.

If the list is writable, it shall support writing or deleting the entire list, updating or deleting one or more individual entries by indicating an index per updated or deleted entry, and adding one or more individual entries.

The Revision History section lists the revision numbers and descriptions of changes made to the device type.

The PAASubject field contains the PAA certificate’s Subject field as defined in the PAA Certificate.

All BTP packets sent over a BLE connection adhere to the BTP Packet PDU binary data format, which includes a header flags byte and an 8-bit unsigned sequence number. Optional fields in the packet include an 8-bit unsigned received packet acknowledgement number, 16-bit unsigned buffer length indication, and a variable-length buffer segment payload.

Enables the initiator to specify the trusted root, fabric, and node targeted in the Sigma1 message.

Fusing of Production Devices is done correctly, ensuring measures like disabling debug interfaces and programming trust anchors for secure boot. Various options are available to secure fusing on the factory floor.

In step 6, the AEAD generate and encrypt operation is executed according to Section 3.6.1, "Generate and encrypt".

The MTop key in the CommissioningCustomFlowUrl indicates the passcode embedded in any onboarding payload should not be used for secure channel establishment with the device. It allows passing device identification information to the server specified in the URL.

ResponseCommandElement = { CommandPath = [[ Endpoint = 10, Cluster = Disco Ball, Command = Stats Response ]], CommandData = { LastRun = 100, Patterns = 1 } }

The DataUrl field indicates the URL where to obtain the information in the format indicated by the RevocationType field.

The NextHop field specifies the Router ID for the next hop in the route to the node corresponding to the route table entry.

The DeviceTypeList attribute is a list of device types and corresponding revisions that declare endpoint conformance, ensuring that an endpoint conforms to all listed device types.

A server must ensure it can handle a single Read Interaction from a client on each fabric containing up to 9 paths, with allowances for Read Interactions without an accessing fabric under certain conditions.

The <command> component of a command path must have the form <command ID>, according to this section.

An action is defined as a single logical communication from a source node to one or more destination nodes, conveyed by one or more messages.

The BeaconLostCount attribute indicates the count of the number of missed beacons the Node has detected.

To prepare a Protocol Message for transmission in MRP, the message undergoes piggyback acknowledgment processing and message retransmission processing.

The ProtocolId is encoded as a 32-bit value, consisting of the Protocol Vendor ID in the upper 16 bits and the Protocol ID under that Protocol Vendor ID in the lower 16 bits. This encoding is similar to how message Protocol ID and Protocol Vendor ID are encoded in the Protocol Header.

A proxy only needs to deserialize/serialize data to/from its internal data stores, without the need for semantic interpretation.

Users and manufacturers are concerned about security and privacy in IoT devices, seeking solutions to address these issues.

The TLV Data, which is variable-length TLV data using the TLV format, may be included in machine-readable formats to provide optional information. More details about the TLV can be found in Section 5.1.5, “TLV Content”.

The authority key identifier extension shall be treated as non-critical and marked as non-critical in the corresponding X.509 certificate, but the critical field shall not be encoded in the Matter certificate structure.

The initiator verifies the Resume2MIC by decrypting it using Crypto_AEAD_DecryptVerify with the S2RK key and specific nonce and additional data values.

In a Matter Node Operational Certificate (NOC), the subject DN may encode at most three matter-noc-cat attributes.

Additional details on invalid Matter Distinguished Names encoding can be found in Section 6.5.6.3, “Matter DN Encoding Rules” of the Matter specification.

If there is no entry in the ActionList holding the same action identifier specified in ActionID, a response with the StatusCode NOT_FOUND is generated.

The Global Group Encrypted Data Message Counter is used to generate message counters for encrypted data messages sent to a group.

The device types under the "closures" category are: - 0x000A Door Lock - 0x000B Door Lock Controller

Data explicitly required to persist across resets includes: <br> - Fabrics <br> - CommissionedFabrics <br> - TrustedRootCertificates

Show it as a Manual Pairing Code or QR Code, depending on what the first Administrator's device supports.

A fabric-scoped list defines entry data types that are structs and fabric-scoped. It supports a fabric-filter that filters the view of the list for read and write interactions, showing entries associated with the accessing fabric only.

If any of the validations fail, the initiator sends a status report indicating an invalid parameter and performs no further processing.

The Interaction Model defines interactions, transactions, and actions between nodes.

Matter uses Crypto_VerifyChain() to verify Matter certificates and Crypto_VerifyChainDER() to verify public key X.509 v3 certificates in DER format, performing validity checks as prescribed by RFC 5280.

The elements that may be used in an Onboarding Payload for a Matter device include: Version, Vendor ID and Product ID, Custom Flow, Discovery Capabilities Bitmask, Discriminator value, Passcode, and TLV Data.

Access Control is the fundamental link between the Secure Channel and the Interaction Model.

A key pair is generated using the Crypto_GenerateKeyPair() function, which internally uses the ECCGenerateKeypair() method according to SEC 1 Section 3.2.1.

The Descriptor Cluster reports the device types and clusters on a node’s endpoints, whether they are standard or manufacturer-specific.

The EnableAction command enables a certain action or automation, changing the action’s state to Active.

If the Message Counter of an incoming message is outside the valid message counter window, the message is marked as a duplicate. Note that while messages may be outside of the window for reasons other than being a duplicate, they are always marked as such.

The BlockEOF message represents the final block in a data transfer. It may have a data length of zero and signals the end of the ongoing bulk data transfer session. The recipient verifies the pre-negotiated file size against the amount of data received.

The MsgCounterSyncRsp message is sent in response to a MsgCounterSyncReq.

It's a feature that allows an Administrator to start commissioning on a Node.

Common issues include missing Git credentials or SSH keys, issues with GPG signing keys, and DNS problems that prevent the container from resolving archive.ubuntu.com during image creation.

The group security info is hard-coded into the standard's implementation and distributed with the associated code. During the key derivation process, the group security info, represented as the byte stream "GroupKey v1.0" (0x47 0x72 0x6f 0x75 0x70 0x4b 0x65 0x79 0x20 0x76 0x31 0x2e 0x30), is incorporated as part of the Info input to the key derivation function. By including this constant value in the derivation process, each operational group key is diversified, ensuring uniqueness and enhancing security across different versions or instances of the standard's implementation.

CASE messages are structured according to Section 4.4, "Message Frame Format." They are unsecured at the message layer, with the Session ID field set to 0 and the Session Type bits of the Security Flags set to 0. The S Flag and DSIZ fields of the Message Flags are also set to 0.

If validation is successful, the initiator proceeds to generate and send a Sigma3 message.

The "State" field indicates the current state of the action.

The HeaderSize field is encoded as a fixed-width, little-endian-encoded, unsigned 32-bit value indicating the total size, in bytes, of the TLV-encoded Header field.

The TxDataPollCount attribute indicates the total number of unique MAC Data Poll frame transmission requests.

Chapter 10 provides an overview of the Interaction Model Encoding Specification.

The Automation Value indicates an automation, such as a motion sensor controlling lights or an alarm system, which can be started, stopped, paused, or resumed.

The values of C1 and C2 characteristics are limited to a maximum length of 247 bytes. This constraint is imposed to align with the maximum PDU size when LE Data Packet Length Extensions (DPLE) is enabled on Bluetooth 4.2 hardware.

The Event Information Blocks and Paths are used to define event filters and paths for event-related actions.

Matter supports bridging, which makes devices implementing other home automation technologies, transports, and link layers available through a data model node for interoperability.

Each endpoint supporting the Color Temperature Light device type SHALL include the following clusters: - Identify Server - Groups Server - Scenes Server - On/Off Server - Level Control Server - Color Control Server

If a node is unable to achieve time synchronization using the specified steps, it may retry or fall back to the stored Last Known Good UTC Time.

TimedRequestMessage contains a Timeout tag, specifying the time limit for a timed request.

Universally Unique Identifier

The Node Operational Certificate (NOC) is used by the Commissioner to commission a Node within its Fabric.

The RetrieveLogsResponse command is generated as a response to the RetrieveLogsRequest.

Devices SHALL announce in any order of priority on all of the networking technologies they support, including Wi-Fi Soft-AP, BLE, and on IP network discovery.

The acknowledgement message sets the Acknowledged Message Counter field to the value of the Message Counter of the reliable message to be acknowledged.

The responder sends a message with the appropriate Protocol Id and Protocol Opcode, whose payload is the TLV-encoded pbkdfparamresp-struct PBKDFParamResponse with an anonymous tag for the outermost struct.

Threat T20: Firmware (any software on Device that can be modified) is modified by attacker in factory (or remotely through factory). [CM21, CM22, CM244]

The UTCTimeStamp field is included in the RetrieveLogsResponse command if the Status field has a value of Success and the Node maintains a wall clock.

A Controller is a role of a Node with permissions that enable it to control one or more Nodes within a network, facilitating management and operational commands.

Practices such as secure manufacturing, encrypted and authenticated communications, secure over-the-air updates, and compliance with security regulations are used to mitigate cybersecurity challenges in smart homes.

The command should only be invoked after obtaining explicit user consent to avoid unintentional removal of a Fabric association.

The AdminFabricIndex attribute indicates the FabricIndex associated with the Fabric scoping of the Administrator that opened the commissioning window.

Product Attestation Intermediate

Matter-specific DN attribute types convey information about Matter-specific certificate types.

It contains two elements: eContentType and eContent.

The Timeout interval in a Timed Write Transaction starts when the Status Response action acknowledging the Timed Request action with a success code is sent.

The OTA Provider should prefer BDXSynchronous or BDXAsynchronous protocols if supported by the OTA Requestor, otherwise HTTPS, and limit the usage of VendorSpecific protocol (Section Download Protocol selection).

Encoding multiple RDN attributes of the same type in a subject DN allows for flexibility in representing various aspects of the certificate holder's identity.

- ID: 0x00, Name: AccessControlEntryChanged (Priority: INFO, Access: S, Conformance: A, Quality: M) - ID: 0x01, Name: AccessControlExtensionChanged (Priority: INFO, Access: S, Conformance: A, Quality: M)

The TLV Type for CommandDataIB is Structure (Anonymous).

Concatenating multiple Onboarding Payloads allows a single QR code to provide the onboarding payload for a number of devices. This can simplify the onboarding process, especially for multi-device packaging.

The Valid Command Paths table defines valid paths for commands, including combinations with wildcards, non-group (node & endpoint), and group paths.

The revisions mentioned in the revision history of the Dimmable Light device are: - 0 Represents device definitions prior to Zigbee 3.0 - 1 Initial Zigbee 3.0 release - 2 New data model format and notation

The IANA assigned port number for IPv6 Multicast in the Matter protocol is 5540, facilitating standardized communication across devices.

Devices utilize multiple hashes in PBKDF (Password-Based Key Derivation Function).

A 16-bit enumeration is utilized for types needing more than 256 but fewer than 65,536 possible values.

Vendors sign off on some other entity posting data about their products to the DCL.

Session resumption in the CASE protocol allows for the quick resumption of a session using previously established session state. This reduces computation time and is particularly beneficial for low-powered devices.

The DisableAction command has ActionID and InvokeID as its data fields.

The Basic Constraint extension is marked critical with CA:TRUE and pathlen:0.

The Vendor Schema provides contact information associated with the vendor, such as VendorID, VendorName, CompanyLegalName, CompanyPreferredName, and VendorLandingPageUrl.

Nodes may perform time synchronization using a trusted external source, RFC 5905, or by reading the UTC time from the Time Synchronization cluster of another Node with the desired Granularity and TimeSource.

The WobbleSpeed field indicates the speed of the axis wobble, or null to not change the speed.

The objectives of the PASE protocol are to communicate PBKDF parameters and derive PAKE bidirectional secrets.

The Valid Event Paths table lists valid event paths, including combinations with wildcards but excluding group paths. It specifies the events requested from various combinations of nodes, endpoints, and clusters.

The NetworkNamePresent field indicates whether the node has the Thread network's name present in its operational dataset.

An event record is a log entry that defines a record of something that occurred in the past, providing a chronological view of events on the node.

If an attempt is made to create an entry with more subjects than the node can support, it will result in a RESOURCE_EXHAUSTED error, and the entry will not be created.

The GroupKeySecurityPolicyEnum data type represents the security policy for operational group keys, with values indicating trust-first or cache-and-sync synchronization methods.

Matter provides a baseline for building secure IoT devices through a comprehensive, strong, easy, and resilient architecture.

The CertificationDeclaration sequence consists of four elements: version, digestAlgorithm, encapContentInfo, and signerInfo.

The Message Reception State provides tracking for the Control Message Counter of the remote peer.

The CommandFields field contains the full set of arguments as specified in the description of the command request/response, encoded as a TLV structure with each argument encoded appropriately.

Setting a high MinIntervalFloor limits the freedom for an ICD to synchronize its updates, potentially impacting energy usage negatively.

The Status Response Action is generated as a following action for some actions, or when there is an unspecified transaction or interaction error.

DNS Push Notifications with DNS Stateful Operations allow clients on the Thread mesh to be notified of changes to the set of discovered services without expensive polling.

The purpose of MCSP is to securely synchronize the message counter used by a sender of messages encrypted with a symmetric group key, enabling secure messaging within an operational group and protecting against replay attacks.

Service Advertising and Discovery for Matter uses the IETF Standard DNS-Based Service Discovery (DNS-SD) [RFC 6763] without requiring modifications.

After handling Exchange flags, processing proceeds to Section 4.11.5.1, "Reliable Message Processing of Outgoing Messages".

A Matter message consists of three main components: the Message Header, the Message Payload, and the Message Footer. The Message Header includes fields like Message Length, Message Flags, Session ID, Security Flags, and Message Counter. The Message Payload contains the Protocol Message, which consists of fields like Exchange Flags, Protocol Opcode, Exchange ID, Protocol Vendor ID, Protocol ID, and Acknowledged Message Counter. The Message Footer includes the Message Integrity Check.

The Date data type is a struct with fields for Year, Month, Day, and DayOfWeek, allowing for representation of dates with various levels of specificity, from a full date to just a day of the week.

nan

The Access Control Cluster is passive and responsible for maintaining entries in the Access Control List. Administrators are tasked with creating and managing Access Control policy by managing the list and its entries.

The DeviceTypeStruct type indicates the device type definition, ensuring endpoint conformance to the device type definition and cluster specifications required by the device type.

The Subject Key Identifier field is derived from the public key using method (1) described in section 4.2.1.2 of [RFC 5280], where it is composed of the 160-bit SHA-1 hash of the certificate’s subject public key value.

The Power Source cluster provides information about the state of the power source for the bridged device. It includes clusters such as Basic Information and Power Source Configuration.

A status code of 0x01 indicates that the operation was not successful.

Threat T101: Malicious Device or person with local network access attempts to guess setup code via online brute force attack. [CM5, CM100]

Shown below are common information blocks used to submit actions to, and receive actions from, the message layer.

The action in Example 1 has the Name, Type, EndpointListID, and SupportedCommands data fields.

It lets a current Administrator set multiple Nodes for commissioning with a new Administrator using a new setup passcode within a specified time window.

The SoftwareFault Event provides data such as the ID of the thread where the fault occurred and additional fault information.

The 'MaxNetworks' attribute indicates the maximum number of network configuration entries that can be added based on available resources.

The server verifies permissions by checking if the ISD of the command has administrator privileges for the server cluster.

The Acknowledged Message Counter field is an optional unsigned integer value containing the message counter of a previous message being acknowledged by the current message. It is present only when the A Flag in the Exchange Flags field is set to 1, indicating that the message serves as an acknowledgment of a previous message.

The ASN.1 OID for the matter-noc-cat attribute type is also 1.3.6.1.4.1.3724, and it allows UTF8String types in X.509 certificates.

The Access Control Cluster may fail to write and return a RESOURCE_EXHAUSTED error if an attempt is made to create or update an entry or extension such that storage is exhausted.

In the context of obtaining user consent for updating software, "User" refers to an entity with sufficient privileges associated with the Fabric, such as a home dweller with configured Nodes (Section 11.19.3.4).

To Commission a Node into a Fabric means to integrate or bring a Node into a networked system or framework, making it operational within that context.

CASE Authenticated Tag

The Extension attribute is used to store a list of AccessControlExtensionStruct, providing a mechanism for manufacturers to include additional TLV-encoded data related to a fabric's Access Control Entries.

MRP handles received acknowledgments by querying the retransmission table for the Acknowledgement Message Counter contained in the received message. If a match is found, the entry is removed from the table, and the retransmission timer is stopped.

This cluster SHALL be exposed by a Bridge on the Endpoint representing each Bridged Device. When the functionality of a Bridged Device is represented using a set of Endpoints, this cluster SHALL only be exposed on the Endpoint at the top of the hierarchy for the functionality of that Bridged Device.

In an Incoming Invoke Response Action, each entry in InvokeResponses is processed sequentially. If the entry is a CommandStatusIB, it is submitted to the layer above. If the entry is a CommandDataIB, it undergoes further validation, including matching the ClusterPath and command ID, before execution in Invoke Execution.

The RxDuplicatedCount attribute indicates the total number of received MAC frame requests that have been dropped as a result of being a duplicate of a previously received MAC frame request.

A Destination Identifier is generated by concatenating specific octet strings and computing an identifier using Crypto_HMAC() with the IPK as the key.

nan

The Revision History section in the context of the Binding cluster specification provides a record of revisions made specifically to the Binding cluster, ensuring clarity on changes and updates over time.

The different values of the Change field in AttributeDataIB are REPLACE, ADD, DELETE, and MODIFY. They are used to indicate different types of changes to a list, such as replacing the entire list, adding entries, deleting entries, or modifying entries.

Matter is a standard of CSA (Connectivity Standard Alliance), Matter specification defines fundamental requirements to enable an interoperable application layer solution for smart home devices over the Internet Protocol.

If present, it should match the content of an entry in the Distributed Compliance Ledger for the specific device as explained in Section 6.3.2, “Firmware Information”.

Common Action Information fields can be encoded either as a field in the message header or as a context tagged field in the action payload.

The FileIdentifier field is encoded as a fixed-width, little-endian-encoded, unsigned 32-bit value, with a constant value of 0x1BEEF11E.

The context-specific tag sig-algo [2] is used to identify the signature algorithm field in the Matter certificate structure.

It's a commissioning flow where the device requires interaction with custom steps guided by the manufacturer before it can be commissioned. This flow may include the Onboarding Payload on-device or in packaging.

The "SupportedCommands" field is a bitmap used to indicate which commands of the cluster are supported for a particular action, with a bit set to 1 for each supported command.

The HourFormat attribute specifies whether time is conveyed using a 12-hour clock or a 24-hour clock.

The "DelayByProvider" value indicates that the reason for a state change is a request by the OTA Provider to await a delay.

In Matter, the SPAKE2+ verifier is the Commissionee/Responder, and the SPAKE2+ prover is the Commissioner/Initiator, defining their roles in the key exchange process.

The Unspecified Node ID (0x0000_0000_0000_0000) is reserved and never appears in messages or protocol usage, used to detect uninitialized, missing, or invalid Node IDs.

A receiver acknowledges a reliable message by either using a "piggybacked" acknowledgment in the next message destined to the peer, or a standalone acknowledgment, or both.

If KeepSubscriptions is FALSE, all existing or pending subscriptions on the publisher for this subscriber must be terminated.

An OTA Requestor is a Node that implements the OTA Software Update Requestor role, responsible for requesting and receiving software updates from an OTA Provider.

Upon receiving the PBKDFParamResponse message, the initiator sets the Peer Session Identifier in the Session Context, generates the Crypto_PAKEValues_Initiator, and uses it to generate pA.

IdleModeInterval indicates the maximum interval in seconds the server can stay in idle mode. It should not be smaller than the ActiveModeInterval.

Challenges include securely provisioning device identity during manufacturing, protecting devices against remote and physical attacks during operations, and ensuring secure software updates and device resets during maintenance.

AES-CTR decryption is implemented as described in Section 6.5 of NIST 800-38A, with counter generation following the function in Appendix A.3 of NIST 800-38C, using a nonce and q = 2 value.

Paths indicated in AttributeRequests or EventRequests must not target a group.

The ProductID Attribute specifies the Product ID assigned by the vendor that is unique to the specific product of the Node.

EventFilters is used to specify filters for events requested in a Read Request Message.

If the failed action is not a Status Response action, the interaction layer should, if possible, submit a Status Response action to the message layer, with a status code of FAILURE and the same Transaction ID.

The AttestationChallenge is used solely as a challenge during device attestation and is included in the key generation process. It ensures the authenticity of the devices involved in the communication.

The PartsList attribute in the Descriptor cluster lists zero or more endpoints to support a composed device type, defining the composition of endpoints within a complex device type.

A globally unique serial number allocated by the CSA for the Certification Declaration.

An operational group is a logical collection of Nodes that run one or more common application clusters and share a common security domain in the form of a shared, symmetric group key. These groups facilitate secure communication and collaboration among Nodes within a Fabric. For instance, a set of Nodes running a lighting application can form an operational group by sharing a common operational group key. Subgroups can also be created within an operational group by defining distinct Group Identifiers for each set of Nodes, while still sharing the same operational group key.

The Interaction Model layer informs the Exchange Layer of the Protocols it will accept. Messages for unregistered Protocol IDs are dropped by the Exchange Layer.

Certificate Authenticated Session Establishment

Commands in Matter should meet certain conformance requirements. For example, a server should support a command if it is listed in the SupportedCommands data field of one or more actions provided by the server.

The choice allows device manufacturers to tailor security measures according to their device's specific needs and use cases, balancing security requirements with other considerations such as cost and functionality.

If the decryption fails (Success = FALSE), the responder sends a status report indicating an invalid parameter and performs no further processing.

The examples in section 6.5.15.2 illustrate the representation of an Operational Intermediate CA Certificate (ICAC) in both X.509 and Matter TLV formats, along with corresponding private keys, demonstrating compliance with the Matter certificate encoding rules and facilitating interoperability.

Once a peer receives a complete set of BTP segments, it reassembles them in the order received and verifies that the reassembled BTP SDU’s total length matches the value specified by the Beginning Segment’s Message Length field. If they match, the reassembled BTP SDU is passed up to the next-higher-layer. However, if there are discrepancies in length, payload size, or flag sequence, the receiver closes the BTP session and reports an error to the application.

Sleepy End Device

The steps for setting the outgoing message counter for transmission are as follows: 1. Obtain the outgoing message counter of the sending Node as per Section 4.5.5, "Counter Processing of Outgoing Messages". 2. Increment the outgoing message counter by 1. 3. Store the incremented outgoing message counter in the OutgoingMessageCounter element associated with the Session Context for the message.

PAKE (Password-Authenticated Key Exchange) is used in the PASE (Password Authenticated Session Establishment) protocol to securely exchange keys based on a shared password, enhancing security during device pairing.

A commissionable Node makes itself discoverable by using the relevant DNS-SD service (_matterc._udp) and ensuring that the DNS-SD instance name is unique within the namespace of the local network.

The context-specific tag defined for the standard DN attribute type domain-component in a Matter certificate is 16.

The context-specific tag key-usage [2] is associated with the key usage extension.

The initiator generates the session identifier (InitiatorSessionId) for subsequent identification of the session. It must not overlap with any other existing PASE or CASE session identifiers in use by the initiator.

MRP handles duplicate messages requesting acknowledgment by immediately sending a standalone acknowledgment. If the Exchange is marked as an ephemeral exchange, it shall be closed, and the message is dropped.

It should be updated using the 'Breadcrumb' argument.

The BatFaultEnum data type is used to indicate various fault conditions on a battery power source, such as unspecified faults, overtemperature, and undertemperature.

The order of attributes in the subject DN of a Matter certificate can be issuer-specific and is not enforced by Matter specifications.

The PathCost field specifies the cost of the route to the node corresponding to the route table entry.

The public key should be a byte string representation of an uncompressed elliptic curve point as defined in section 2.3.3 of SEC 1.

The signature algorithm in a Matter certificate specifies the cryptographic algorithm used for composing and validating the signature embedded in the certificate's signature component.

The FullDuplex attribute indicates if the Node is currently utilizing the full-duplex operating mode.

Chapter 6 describes the procedures and cryptographic credentials involved in establishing trust between entities, including mechanisms for device attestation and operational credentials for Nodes.

The revision history for this document is as follows: - 0: Represents device definitions prior to device type revision numbers - 1: Initial release of this document - 2: Duplicate condition replaces Multiple condition

Data local to the host is operated on, with more complex data types' external representation noted if applicable. Multi-byte data types used internally are assumed to be in host byte order, unless stated otherwise. All octet strings are presented with the first octet having index 0 and are presented from left to right.

It provides a user-facing description of this battery, which contains information required to identify a replacement.

It indicates the assessed RMS or DC voltage currently provided by the hard-wired source, in mV (millivolts).

Upon receipt of a Subscribe Response action, the subscription becomes active to the subscriber.

The PH key is encoded as a variable-length decimal number in ASCII text and represents a bitmap of methods supported by the Commissionee for entering Commissioning Mode.

The nesting of collection data is conceptually unlimited but defined within cluster specifications, mirroring data structures found in programming languages, as discussed in this section.

The Change field is not encoded directly; instead, it is encoded through the use of special values in the Path and Data fields.

The Commissionee connects to the operational network, with its IPv6 address used or discovered for further communication.

The CommandBits Type data type includes the following command types: InstantAction, InstantActionWithTransition, StartAction, StartActionWithDuration, StopAction, and PauseAction.

The Matter Working Group was officially opened on January 17, 2020.

An attribute path may include field IDs for structure data or entry indexes for list data within the <attribute> component, as described in this section.

A Bridged Node root endpoint serves as a "read me first" endpoint that describes itself and any other endpoints that make up the Bridged Node. It represents a device on a foreign network but is not the root endpoint of the bridge itself.

Field trials with different versions of software or providing dedicated software images to a subset of nodes are conducted for purposes such as A/B-testing, beta testing, or specific diagnosis tasks (Section 11.19.5.2).

An endpoint is a part of a node representing a service or virtual device, conforming to device type definitions.

The purpose of the Pake1 message is to initiate the PAKE protocol by the initiator in response to receiving the PBKDFParamResponse message.

The Fabric ID, in compressed form, is used during operational discovery to provide operational naming separation and namespacing between unrelated collections of devices.

The cluster sends AccessControlEntryChanged events whenever its ACL attribute data is changed by an Administrator.

The ResetWatermarks command resets values related to high and lower watermarks for memory usage tracking.

For encrypted messages of Secure Unicast Session Type, any arriving message with a counter in the range [(max_message_counter + 1) to (2^32 - 1)] is considered new and updates the max_message_counter value. Messages within the range of the bitmap are considered duplicate if the corresponding bit offset is set to true, while all other counters are considered duplicate.

If the Report Data action is not in response to a Subscribe Request action, the SubscriptionId field is omitted from the action.

An existent path is a concrete path that indicates a single existing instance on the node indicated in the path.

The Cluster ID is 0x0042 for the ProxyConfiguration cluster.

The special value 0, when encoded in the not-after field, corresponds to the X.509/RFC 5280 defined special time value 99991231235959Z.

The Software Diagnostics Cluster provides standardized diagnostics metrics that can assist in diagnosing potential problems.

The purpose of the Bulk Data Exchange (BDX) protocol is to facilitate the transfer of files between nodes by modeling files as collections of bytes with attached metadata.

The Subscribe Request Action includes parameters such as MaxIntervalCeiling, MinIntervalFloor, AttributeRequests, and EventRequests.

Chapter 3 introduces the cryptographic primitives, algorithms, and protocol building blocks used in the protocol, providing a functional abstraction for reference throughout the specification. It also maps these primitives to specific instances and offers guidance on their use for compliant implementation.

Passcodes are identified by Passcode IDs and authenticated locally by a PASE session during the commissioning phase. While Passcode ID 0 represents the default commissioning passcode, other Passcode IDs are reserved for future use. ACL entries with PASE authentication mode are not explicitly added to the Access Control List because an invisible implicit administrative entry is always present on the Commissionee during PASE sessions.

An empty targets list indicates a wildcard, meaning the entry grants access to all cluster instances on all endpoints on the Node.

The version field in the PAI certificate is set to 3 (0x2) to indicate a v3 certificate.

Upon observing the UserConsentNeeded field set to True in the QueryImageResponse, the OTA Requestor should proceed to obtain user consent using its onboard means before transferring the OTA Software Image (Section User consent delegation to Nodes).

In PASE authentication, the Passcode ID identifies the required passcode verifier, with a value of 0 indicating the default commissioning passcode.

If the acknowledgment timer triggers before being cancelled in MRP, a standalone acknowledgment shall be sent to the source of the message. Sending this standalone acknowledgment shall not remove the acknowledgment table entry and shall set the StandaloneAckSent field of the entry to true.

Support for the Diagnostic Logs cluster is provisional.

Additional validation steps should be performed, including matching the distributionPoint field and validating the CRLFile.

No, messages sent over TCP or BTP (Bluetooth Transport Protocol) over BLE (Bluetooth Low Energy) transports may exceed the message size limit if both nodes involved in the communication are capable of supporting larger message sizes. However, messages transmitted over UDP must adhere to the 1280-byte limit.

The Administrator Commissioning Cluster hosts commands that enable the entry into commissioning mode for a prescribed time, invoked over a CASE secure channel.

The common subset of principles includes lawfulness, fairness, and transparency; purpose limitation; data minimization; accuracy; storage limitation; cybersecurity (integrity and confidentiality); and accountability.

All Devices include a Device Attestation Certificate and private key, unique to that Device.

BTP packets will still be exchanged every send-acknowledgement interval due to acknowledgements generated by the receipt of previous data or stand-alone acknowledgement packets.

The CSRNonce field is used in the computation of the NOCSR Information.

In Example 6, the user can arm the alarm system by using the EnableAction command.

Devices are ready for commissioning by any Matter commissioner, start advertising automatically, and use standard pairing methods.

Exactly one of AdminNodeID and AdminPasscodeID should be set, depending on whether the change occurred via a CASE or PASE session; the other should be null.

Any IPv6-bearing network, focusing on Ethernet, Wi-Fi, and Thread, to cover provisioning of these link layers and ensure certification testing is suitably bounded.

Matter relies on a strong cryptographic suite, including AES in CCM mode with 128-bit keys for confidentiality and integrity, AES in CTR mode for protecting identifiers, SHA-256 for integrity, and ECC with the "secp256r1" curve for digital signatures and key exchanges.

The GroupTable attribute provides read-only information about how a given logical Group ID maps to a particular set of endpoints, along with a name for the group.

It indicates the ID of the common or colloquial designation of the battery.

The DNS-SD instance name for operational discovery is constructed from a 64-bit compressed Fabric identifier and a 64-bit Node identifier. These identifiers are expressed as fixed-length sixteen-character hexadecimal strings, encoded in ASCII (UTF-8) using capital letters, and separated by a hyphen. For example, the instance name for a Matter Node with specific fabric and node identifiers would be constructed as follows: 2906C908D115D362-8FC7772401CD0696. The uniqueness of this name within the local network namespace is ensured by selecting unique fabric and node identifiers [RFC 6762].

The TemperatureUnit attribute indicates the unit for the Node to use when conveying temperature in communication to the user.

Inputs: List of all entries in the Device Attestation PKI Revocation Distribution Points table. Outputs: For each tuple of (CertificateAuthorityKeyIdentifier, CertificateAuthorityName), a set of RevokedEntitySerialNumber.

The BetterPartitionAttachAttemptCount attribute indicates the number of times a Node has attempted to attach to a different Thread partition that it has determined is better than the partition it is currently attached to.

Derived data types are common types derived from base data types for reuse across multiple cluster specifications, including classifications like Analog, Time, Discrete, etc., to avoid redefinition in each cluster.

The Subscribe Request Action is unicast from the subscriber to the publisher.

Both the Commissioner and Commissionee return to step 2 and repeat each step.

The KeySetWrite command is used by Administrators to set the state of a given Group Key Set, including updating the state of all epoch keys.

All certificates within this specification are based on X.509v3-compliant certificates as defined in RFC 5280. The storage format of the certificates depends on the application (e.g., DAC or NOC chain), but all certificates are directly compatible with X.509v3 DER representation after suitable loading or decompression.

Constraints for various data types, such as numeric, octet string, list, and character string, are defined using specific notation indicating value ranges, sizes, or other constraints.

Matter offers robust and streamlined security features, providing protection against cyber threats and ensuring the safety and privacy of users' data.

During unencrypted sessions, the session context data utilized includes Session Role, Ephemeral Initiator Node ID, and Message Reception State.

The Message Layer constructs the payload format with header fields specifying message properties and routing information, preparing it for transmission over the transport protocol.

Certificate Signing Request

Threat T102: Malicious Device or person with knowledge of passcode verifier uses offline brute force attack to derive setup code. [CM5, CM99]

The OTA Software Image file format consists of a header followed by an opaque body.

- Presence of PAA in the Commissioner’s trusted root store. - Validity of DAC certificate chain using Crypto_VerifyChainDER() function. - Matching VendorID values between DAC and PAI certificate. - Validation of Device Attestation Signature. - Matching AttestationNonce.

The PHYRate attribute indicates the current nominal, usable speed at the top of the physical layer of the Node.

The output C from step 6 contains the tag of CRYPTO_AEAD_MIC_LENGTH_BITS bits (Message Integrity Check) as specified in Section 3.6.1, "Generate and encrypt". The secured outgoing message consists of the concatenation of the additional data octet string A and the output C.

An IPv6 Multicast Address uses Unicast-Prefix-based IPv6 Multicast Addresses (RFC 3306), including a scope based on RFC 7346, a reserved section, a network prefix formed by a locally assigned ULA prefix and the Fabric ID, and a group identifier portion.

[[ matter-rcac-id = 0xCA0000000000001DU ]]

Trusted Root CA certificates are added during the commissioning process by the Commissioner or during root rotation operations by an Administrator trusted by the Node. Nodes cannot modify the TrustedRootCertificates attribute outside of processing Node Operational Credentials cluster commands.

The ChannelMaskPresent field indicates whether the node has available a mask of available channels in its operational dataset.

The HourFormat attribute represents the format that the Node is currently configured to use when conveying the hour unit of time.

Nodes SHALL utilize multiple hash iterations in PBKDF.

The SoftwareVersionString Attribute contains a human-readable representation of the software version running on the Node, suitable for conveying version information to users. It has a maximum length of 64 bytes and is recommended to use simple 7-bit ASCII alphanumeric and punctuation characters for compatibility across cultures.

The Final Protocol Version field indicates the BTP protocol version selected by the server.

The Commissioner should substitute the placeholder values "_" in the CommissioningCustomFlowUrl with desired contents for CallbackUrl (MTcu) and onboarding payload (MTop) if present, according to a specific algorithm. The final URL (ExpandedCommissioningCustomFlowUrl) is used for commissioning.

Undefined values or ranges of an enumeration, field, or identifier are reserved for future revisions and not available for implementation.

Threat T165: Privilege Escalation. [CM149]

The RevocationType field identifies the type of file found at the DataUrl for the entry, supporting values such as 1 for RFC 5280 Certificate Revocation List (CRL) and other values reserved for future use.

The PauseAction command pauses an ongoing action, changing the action’s state to Paused.

If HasPBKDFParameters is set to False, the responder returns the PBKDF parameters.

An octet string used to express various parameters for selecting trusted roots, fabric IDs, and node IDs.

After all commands complete execution in an Incoming Invoke Response Action, Invoke Response Generation is performed.

ClientsSupportedPerFabric specifies the number of clients supported per fabric.

Operational communication, which uses the secured Matter message format between commissioned nodes over an IP transport, can be either unicast or multicast.

References to StatusReport messages take one of the following forms: - When no ProtocolData is present: StatusReport(GeneralCode: <value>, ProtocolId: <value>, ProtocolCode: <value>) - When additional ProtocolData is present: StatusReport(GeneralCode: <value>, ProtocolId: <value>, ProtocolCode: <value>, ProtocolData: <value>)

The SetRegulatoryConfig Command is responsible for adding or updating the regulatory configuration in the RegulatoryConfig Attribute.

The 'NetworkCommissioningStatusEnum' data type describes various status values related to network commissioning.

The InstantAction command triggers an action (state change) on the involved endpoints in a "fire and forget" manner, and afterward, the action's state becomes Inactive.

The SetTimeZone command is used to set the time zone of the node.

The AddOrUpdateThreadNetwork command is used to add or modify Thread network configurations.

The Bridge has a single Access Control Cluster for the entire Node, containing all Access Control Entries for each of its endpoints, including for all Bridged Devices and other native Matter functionality. Access Control can reflect the privilege level a Matter Controller needs for one or more Bridged Devices, which may be a subset of all Bridged Devices on the Bridge.

Threat T92: Microphone in the house can capture person speaking the setup code and use that to MITM Commissioning. [CM3]

The passcodeId corresponds to a particular PAKE passcode verifier installed on the responder.

Descendants of an endpoint are endpoints listed in its PartsList or descendants of endpoints in its PartsList. Children of an endpoint are descendants of that endpoint but not descendants of any endpoint in its PartsList. Sibling endpoints are children of the same endpoint.

The specification details the encoding of the Interaction Model in the Matter TLV format, specifically focusing on the application payload for Matter messages corresponding to the Interaction Model.

The MEI prefix encodes the source Vendor ID with the exception that a Scoped source is encoded using the same prefix as a Standard source. A given MEI shall not permit both Standard and Scoped source types due to the ambiguity in telling them apart.

Common Name (from X.520)

It should be validated using the Crypto_Verify() function and the public key obtained from the CSA’s Certificate Authority Certificate.

The Cluster ID is 0x0044 for the ValidProxies cluster.

Operational communication in the Matter protocol refers to traffic that uses the secured Matter message format between commissioned nodes over an IP transport. This includes both unicast and multicast communication.

The "Unknown" value indicates that the reason for a state change is unknown.

The DCL is a distributed store of information utilized for tracking certification status and vendor-maintained data, such as product details and firmware URLs. It ensures data integrity through cryptographic signatures and is accessible through synchronized servers.

Yes, the server SHALL support a Timed Write transaction for all writeable attributes.

Implementations of Matter certificates should admit serial numbers up to 20 octets in length, and certificate authorities should not use serial numbers longer than 20 octets in length.

"Light Switch Client" signifies an example scenario involving a light switch.

Examples of methods represented by the pairing hint include power cycling, using the device manual, pressing reset or setup buttons, and custom instructions.

The BUSY StatusReport message is sent by a responder when it is unable to fulfill a request to start a new secure session. It indicates to the initiator that it should wait for a specified period before retrying the request.

The KeySetReadAllIndicesResponse command contains the list of GroupKeySetID values for all Group Key Sets associated with the scoped Fabric.

The PROTOCOL SPECIFIC STATUS field provides additional details specific to the protocol.

Node Operational Certificate Signing Request

The BTP Handshake Request frame consists of a Control Flags field and a Management Opcode field. The format is detailed in Table 29, “BTP Handshake Request format”, including Version nibbles, Requested ATT_MTU, and Client Window Size.

The issuer field in the PAA certificate contains the information: CN = Matter Test PAA, 1.3.6.1.4.1.37244.2.1 = FFF1

The flags of the Exchange Flags of the Protocol Header for PASE messages are determined based on the message type. Specifically, the I Flag is set to 1 for PBKDFParamRequest, Pake1, and Pake3 messages, while it is set to 0 for PBKDFParamResponse and Pake2 messages.

Matter: Device, HomeKit: Accessory, Weave: Device, Thread: Device, Zigbee: Device

The LeaderRouterId attribute indicates the 8-bit LeaderRouterId the Node shall attempt to utilize upon becoming a router or leader on the Thread network.

Threat T79: Device marked for destruction reused in network. [CM15, CM16, CM20, CM35]

Various resources required by a Node implementation, along with references to where the minimal requirements for each resource type are defined.

It provides a method to generate the dataset required for determining the revocation status of certificates.

The MSG_COUNTER_SYNC_REQ_JITTER constant specifies the maximum amount of random delay before sending a MsgCounterSyncReq when the synchronization request is triggered by receipt of a multicast message.

Upon receiving this command, an OTA Provider may log it internally and use the information to update its bookkeeping of cached Software Images or for other similar administrative purposes.

NestedPath in AttributePathIB establishes the nesting depth of the attribute path. It indicates zero or more nesting levels within the attribute data.

The ACL attribute represents the Access Control List, containing entries that codify grants of privilege on the Node.

A group key set restricts the key derivation process to Nodes within the respective operational groups, limiting access to operational group keys based on the functionality provided by a Node and/or the privilege afforded to it. For example, certain devices may have access to specific group key sets based on their intended functionality, such as "Physical Access" group key set for security systems or door locks. By associating Nodes with specific group key sets, access to operational group keys is controlled, ensuring that only authorized Nodes have the capability to derive and utilize these keys for group communication.

The Active Mode Threshold attribute defines the minimum amount of time the device will typically remain in Active Mode.

The CDCertificateID field contains the CSA certification's certificate ID for the Certification that applies to a particular software version.

Invalid encodings include: - Encodings where the substring following Mvid: or Mpid: is not exactly 4 uppercase hexadecimal digits. - Encodings where substrings are not correctly formatted. - Encodings where the prefix string is found without a fully correct match. - Encodings where there are occurrences of substrings within other substrings, which may cause confusion.

They should wait at least 30 seconds for a valid response from the cluster server.

A worked example of the Attestation Information to be generated in the AttestationResponse Command when executing the Device Attestation Procedure.

The context-specific tags issuer [3] and subject [6] are used to identify the issuer and the subject DN fields in the Matter certificate structure.

If the EnableKey field is received with all zeroes, the command shall fail with a response status of CONSTRAINT_ERROR.

DataVersionFilters is used to specify filters based on data version numbers in a Read Request Message.

The payload TLV encoding for PASE messages is specified in Table 22, where each message has a corresponding TLV structure. For instance, PBKDFParamRequest uses pbkdfparamreq-struct, PBKDFParamResponse uses pbkdfparamresp-struct, and so on.

The SuppressResponse flag in InvokeRequestMessage indicates whether the response should be suppressed.

The UTCTimeStamp field contains the value of the oldest log entry in the diagnostic logs being transferred if the Status field is set to Success and the Node maintains a wall clock.

Both CASE and PASE produce two shared keys: I2RKey and R2IKey, which are saved to the session’s context and used to encrypt and decrypt messages during the Session Data Phase.

All certificates in the Node Operational credentials must be X.509v3 certificates compliant with RFC 5280 and encoded respecting the constraints in the Operational_Certificate section. They may be encoded as X.509v3 certificates or Matter Operational Certificates ("Matter Certificates") with the signature field calculated using the X.509v3 encoding.

The Device Attestation feature relies on a Device Attestation Certificate (DAC) chain and on a Certification Declaration (CD).

Device types may impose additional constraints on the minimum number of subjects per Access Control Entry.

An Operational Node ID uniquely identifies an individual Node on a Fabric, required as the source and destination address for all messages, ensuring messages are unambiguously associated with Nodes.

Before encrypted application data can be sent in a newly established PASE session, the initiator must receive PakeFinished within the unencrypted session used for establishment. Until then, encrypted application data transmission is not permitted.

The Descriptor cluster replaces support from the Zigbee Device Object (ZDO) for describing a node, its endpoints, and clusters, supporting the description of an endpoint instance independently and in compositions.

The ExtendedPanId attribute indicates the unique 64-bit identifier of the Node on the Thread network.

The AdminNodeID field represents the Node ID of the Administrator that made the change, if the change occurred via a CASE session.

The NeighborTable attribute indicates the current list of Nodes that comprise the neighbor table on the Node.

Quick Response (code)

The 'LastNetworkingStatus' attribute indicates the status of the last attempt to scan or connect to an operational network using the interface.

The termination of a downstream subscription may lead to amendments or terminations in the upstream subscription.

Manufacturer C adds a manufacturer-specific (MS) cluster that doesn’t extend an existing standard cluster. To use an extended version of a standard struct, Manufacturer C must redefine that structure within its cluster definition.

Operational Discovery involves identifying a previously commissioned Node for the purpose of performing operations with that Node, ensuring continued functionality and integration within the network.

The Enumeration data type uses scalars to represent context-specific values available from an enumerated set. It is nullable and requires well-defined values with well-defined conformance for implementation.

Defined in Section 9.6.1, “Binding Mutation”.

In the Key Usage extension, both the Certificate Sign and CRL Sign bits are set, indicating that the certificate can be used for signing certificates and CRLs.

The initiator sends a message with the appropriate Protocol Id and Protocol Opcode from the Secure Channel Protocol Opcodes table, whose payload is the TLV-encoded pbkdfparamreq-struct PBKDFParamRequest with an anonymous tag for the outermost struct.

The NOCResponse command contains fields such as StatusCode, FabricIndex, and DebugText, providing information about the operation's status.

EventRequests is used to specify which events are requested in a Read Request Message.

Matter is adopted by the entire industry from day one, unlike other standards that require new hardware cycles and long adoption curves. It is supported on existing smart home ecosystems and devices already in millions of homes.

Similar clusters and constraints related to the Fail-Safe timer and cluster operation time-outs are used for administrative operations.

The Root Node device type has a condition called CustomNetworkConfig, indicating that the node only supports out-of-band-configured networking.

Concatenation of initiatorRandom, rootPublicKey, fabricId, and nodeId.

A Bridged Node endpoint can support either separate endpoints or one endpoint. In the separate endpoints pattern, all application device types are supported on separate endpoints, and the Bridged Node endpoint's Descriptor cluster PartsList attribute indicates a list of all endpoints representing the functionality of the bridged device. In the one endpoint pattern, both the Bridged Node and one or more application device types are supported on the same endpoint, following application device type rules.

Sequence numbers are used to facilitate the BTP receive window and ensure proper packet ordering. They are defined as unsigned 8-bit integer values that increment by 1 with each packet sent by a peer, wrapping to zero after reaching 255.

The CapabilityMinima Attribute provides the minimum guaranteed values for system-wide resource capabilities not specific to any cluster. It allows clients to optimize communication by using more than the strict minimum values required, though actual server support may exceed the provided values. Clients shouldn't assume permanent unchanging values and not cache them permanently.

If the ConnectNetwork command is received without an armed fail-safe context, then this command shall fail with a FAILSAFE_REQUIRED status code sent back to the initiator.

The 'ThreadInterfaceScanResultStruct' represents a single Thread network scan result.

No, Matter security is self-contained and does not rely on the security of the communication technologies on top of which Matter runs, such as Wi-Fi.

There is exactly one VendorID value present in the subject field of the PAI certificate.

The first Node to send a message in an Exchange assumes the Initiator role, while all other Nodes subsequently participating in the Exchange take on the Responder role. An Exchange is always between one Initiator and one or more peer Responder Nodes.

The attributes provided are Hierarchy, Role, Context, and PICS Code.

The purpose of NOCSR is to allow a Node to create a Certificate Signing Request (CSR) in response to the Commissioner's request.

The Data field in AttributeDataIB represents the actual data being written or reported. Its data type corresponds to the data indicated by the Path field, and if the final nesting level is a list entry index, the data type is that of the list.

The main objectives of the CASE protocol are to provide mutual authentication between peer Nodes, generate cryptographic keys for securing subsequent communication within a session, and exchange operational parameters such as Session Identifier and MRP parameters.

The context-specific tag pub-key-algo [7] is used to identify the public key algorithm field.

The "Failure" value represents that the reason for a state change is the failure of a prior operation.

Device manufacturers carefully consider whether their products that support remotely starting their operation could do harm to the end user. If so, they require some additional operations, such as attended confirmation for remote start.

The Power Source device type must support the ICD Management cluster.

Upon receipt of a Status Response Action with a success Status Code, the interaction layer consumes the status and continues the current transaction and interaction.

There are multiple chapters in the Zigbee Cluster Library, with Chapter 2 specifically related to ZCL commands and interactions.

Administrators should avoid inadvertently removing their own administrative access by updating existing entries or creating new ones before removing the old entry.

The notation used in this section leverages types defined in RFC 5280 such as AlgorithmIdentifier, RelativeDistinguishedName, Validity, Time, UTCTime, GeneralizedTime, or permitted extension types. Additionally, it uses the ASN.1 definitions captured in the provided ASN.1 module.

Session establishment completes when the last CASE or PASE protocol message is sent or received and successfully processed.

Sequence numbers are separately defined for each direction of a BTP session. The sequence number of the first packet sent by the client after the handshake is zero, while the server's first data packet has a sequence number of 1. Peers verify that received packets increment the sender’s previous sequence number by 1, and if this check fails, the session is closed and an error is reported.

AttributeRequests is used to specify which attributes are requested in a Read Request Message.

Context-specific tags can only be assigned to elements that are immediately within a structure.

The Exchange Flags field is an unsigned integer bit field containing subfields such as I Flag, A Flag, R Flag, SX Flag, and V Flag. The I Flag indicates whether the message was sent by the initiator of the exchange, the A Flag indicates if the message serves as an acknowledgment of a previous message, the R Flag indicates if the sender requests an acknowledgement for the message, the SX Flag indicates the presence of Secured Extensions, and the V Flag indicates whether the Protocol Vendor ID is present.

Proxies can select between the two options by 'sniffing' the Proxy Discover Response Command messages emitted by other proxies.

This schema is used to identify the URL where Product Attestation Authorities provide revocation information for Product Attestation Instances and Device Attestation Certificates.

An entry remains in the acknowledgement table in MRP until one of the following conditions is met: 1. The exchange associated with the entry is closed. 2. The exchange associated with the entry has switched to track a pending acknowledgement for a new message counter value. 3. A message that is not a standalone acknowledgment is sent which serves as an acknowledgment for the entry.

Bluetooth Transport Protocol

The Bridge exposes device names in the NodeLabel attribute of the Bridged Device Basic Information cluster on the applicable endpoint. It also exposes grouping using the EndpointLists attribute of the Actions cluster.

No, it's explicitly stated that the key pair is an example and should not be reused in implementations.

The Constraint field specifies the constraints or requirements for the LabelList attribute.

If PBKDFParamRequest.hasPBKDFParameters is False, the responder includes the PBKDF parameters (i.e., salt and iteration count) in the Crypto_PBKDFParameterSet.

It means the value or range is available for non-standard implementation by manufacturers.

They can either immediately expire the fail-safe or wait for it to expire before proceeding.

AttestationNonce, Attestation challenge, Device attestation private key, Device attestation public key, Desired timestamp, Desired timestamp in epoch-s, and vendor-specific values.

The types of sensors included in the "sensors" category are: - 0x0015 Contact Sensor - 0x0106 Light Sensor - 0x0107 Occupancy Sensor - 0x0302 Temperature Sensor - 0x0305 Pressure Sensor - 0x0306 Flow Sensor - 0x0307 Humidity Sensor - 0x0850 On/Off Sensor - 0x0076 Smoke CO Alarm

All Nodes implement three global 32-bit counters: Global Unencrypted Message Counter, Global Group Encrypted Data Message Counter, and Global Group Encrypted Control Message Counter.

The meanings of member elements in a list are denoted by their position within the list, in conjunction with any associated tag value they may have.

All member elements within a structure must have a unique tag compared to the other members of the structure. Member elements without tags (anonymous elements) are not allowed in structures.

CommandFields is used to encapsulate the arguments or parameters for a command request or response in a TLV structure.

Threat T183: DoS on Trustees' approval process. [CM163]

The ReverseRequest command reverses the direction of the disco ball rotation.

Threat T1: Commission an already Commissioned Node for control that may be difficult to detect (e.g., IP Camera to stream video). [CM2]

SuppressResponse is set to FALSE in a Report Data action when reporting data and/or events from the target to the initiator.

The context-specific tag ec-pub-key [9] is used to identify the elliptic curve public key material field.

Some Nodes might not be required to implement communication using group keys, in which case they may omit the Global Group Encrypted Message Counters.

The inclusion of the Level Control cluster on the On/Off Light device is recommended to provide a consistent user experience when the device is grouped with additional dimmable lights and the "with on/off" commands are used. If implemented, the Level Control cluster should not have any effect on the actual light level except for commands that cause an on/off state change. Additionally, the device should accept and process Level Control cluster commands, adjusting the value of the CurrentLevel attribute accordingly.

The Destination Identifier ensures that the initiator has knowledge of both the IPK and one of the responder Node's full identities before triggering the responder to generate a Sigma2 message. It also eliminates ambiguity on the responder's end regarding the selected Fabric.

Password-Based Key Derivation Function (from NIST 800-132)

Node Operational credentials are a collection of credentials enabling a Node to identify itself within a Fabric, distinct from Device Attestation credentials, and installed during Commissioning.

The DebugText field provides additional information or debug messages related to the operation.

Defined in Section 2.11.2.2, “Subscribe Interaction Limits”.

The On/Off Light device is capable of being switched on or off by means of a bound controller device such as an On/Off Light Switch or a Dimmer Switch. Additionally, it can be switched by means of a bound occupancy sensor.

Within this specification, the following certificate formats are defined: - Compressed Node Operational credentials certificate chain elements in Matter Operational Certificate Encoding or "Matter Certificate" format: ◦ Node Operational Certificate (NOC) ◦ Intermediate CA Certificate (ICAC) ◦ Root CA Certificate (RCAC) - Device Attestation certificate chain elements in Standard X.509 DER format: ◦ Device Attestation Certificate (DAC) ◦ Product Attestation Intermediate (PAI) Certificate ◦ Product Attestation Authority (PAA)

The StartRequest command starts the disco ball rotating.

Matter uses the highest level of civilian cryptographic standards for network communications, preventing unauthorized access or tampering of data.

The responder generates a unique ResponderSessionId that does not overlap with any existing session identifiers and sets it in the Session Context.

Matter-specific DN attribute types can be found under the 1.3.6.1.4.1.1.37244 private arc.

The "EndpointListStruct" type holds details of a single endpoint list, relating to a set of endpoints with some logical relation.

In the Key Usage extension, both the Certificate Sign and CRL Sign bits are set, indicating that the certificate can be used for signing certificates and CRLs.

The initiator generates a Sigma1 message by following a specific TLV schema, which includes generating a random number (InitiatorRandom), session identifier (InitiatorSessionId), destination identifier (DestinationId), and an ephemeral key pair (InitiatorEphKeyPair). If the initiator is resuming a session, it also generates a ResumptionID and an initiatorResumeMIC using the SharedSecret from the previous session. The initiator then sends the message with the appropriate Protocol ID and Opcode.

The maximum allowed length for the Name attribute in the Super Disco Ball cluster is 32.

The TxBroadcastCount attribute indicates the total number of unique broadcast MAC frame transmission requests.

Section 4.8.3 describes the process of privacy processing for outgoing Matter messages, specifically focusing on encoding Matter message headers for privacy obfuscation.

The VendorID field in the Vendor Schema uniquely identifies a vendor entry and must match the vendor's assigned Vendor ID.

The DNS-SD instance name for Commissioner Discovery is generated similarly to Commissionable Node Discovery and must adhere to the same requirements, including uniqueness on the local network and collision detection and recovery mechanisms. The DNS-SD service type for Commissioner Discovery is _matterd._udp.

The ConnectionStatus event indicates that a Node’s connection status to a Wi-Fi network has changed, indicating whether it is connected or not.

The DNS-SD service type for Matter operational discovery is _matter._tcp. Additionally, a subtype named "Compressed Fabric Identifier" (_I<hhhh>) is defined, where <hhhh> represents the compressed fabric identifier encoded as sixteen uppercase hexadecimal characters. This subtype enables filtering of devices based on the fabric identifier, reducing the set of results to nodes of interest within a specific fabric [RFC 6335].

Password-Authenticated Key Exchange (from SPAKE2+)

Interval: 1.28 seconds; Window: 11.25 ms.

The subject field in the PAI contains a sequence of RelativeDistinguishedNames.

If this action was unicast and SuppressResponse is FALSE, a Write Response action SHALL be generated and submitted to the message layer to send to the initiator. Otherwise, no Write Response SHALL be sent.

Threat T120: Data from Matter Nodes is shared with non-Matter or unauthorized entities. [CM87]

It has read access.

The sha256 algorithm.

Optional or deprecated data fields that are not implemented and therefore do not exist should not be indicated as the null value. They should have a well-defined default value that is used when the data field is not implemented.

The data structure in the AttributeDataIB is based on the schema description of the specified attribute within the specified cluster.

Cluster inheritance allows new clusters to be derived from existing ones, extending or reducing requirements.

The Role field records whether the node is the initiator of or responder to message counter synchronization, forming a unique key along with the Fabric Index and Peer Node ID to match incoming messages to ongoing MCSP exchanges.

The Read Interaction provides a means to read the contents of all or part of a cluster within the Descriptor Cluster.

The LabelList attribute in the Fixed Label Cluster uses a list of structures as its data structure.

In Thread mesh networks, DNS-SD uses Unicast DNS instead of Multicast DNS, communicating information in unicast packets to and from a designated Service Registry, reducing the use of multicast.

The first successfully validated message, M, by Section 4.7.3, "Security Processing of Incoming Messages", terminates the iteration through Privacy Keys in step 2. Once a successful decryption is achieved, further attempts with different Privacy Keys are not required as the message has been successfully deobfuscated.

Field IDs are encoded as a context tag when the MEI prefix encodes a standard/scoped source, or as a fully-qualified profile-specific tag when the MEI prefix encodes a manufacturer code.

The Duration field specifies the duration for which the ongoing action will be paused before automatically resuming, changing the action’s state back to Active.

Maintaining a compromise between the number of peers and associated memory usage ensures that the table can support a sufficient number of peers sending group messages to a receiver while minimizing memory consumption.

The CommandDataIB is used to provide data associated with a command.

A Discriminator is a 12-bit value used to distinguish between multiple commissionable Matter device advertisements, aiding in the identification and selection process during Commissioning.

Example 4 involves the use of EnableAction, DisableAction, DisableActionWithDuration, PauseAction, and PauseActionWithDuration commands to control the wake-up routine.

The epoch key rotation process involves three main states: Admin Refresh, Admin Update, and Epoch Activate. - Admin Refresh: This state occurs when an entire group key set is freshly written to a Node during commissioning or administration, such as when a new group is added. - Admin Update: This state is entered when an Administrator updates an old epoch key with a new one. It may also be entered during steady state to update additional keys or completely reset the group security. - Epoch Activate: This state is entered when system time progresses to activate a fresh current epoch key, aging out the other epoch key slots. During these states, key distribution operations occur, with changes made by the Administrator indicated in green and activations due to time progression indicated in yellow. These states facilitate the seamless transition and management of epoch keys within the fabric, ensuring the continuity of secure group communication.

The value of the acknowledgement field indicates the sequence number of the acknowledged packet.

The Room Value is used when an endpoint can only be part of one room, such as in physical mapping. Matter controllers can use this logical grouping to automatically place each endpoint in the correct room without user intervention, both initially and upon later updates to the endpoints.

The LabelList attribute in the User Label Cluster uses a list of structures as its data structure.

A fabric-scoped struct only occurs as an entry in a fabric-scoped list, supports a global FabricIndex for associated fabric, and its fields may be fabric-sensitive. It’s implicitly associated with a fabric, and fabric-sensitive fields are not indicated when not matching the accessing fabric.

The recommended minimum number of entries is 5 per fabric per instance of Groups cluster on an endpoint.

No, it's omitted.

Defined in Section 2.11.1.2, “Group Limits”.

During Step 4, the client should wait for the PROXY SCAN PERIOD to aggregate responses and filter them based on certain criteria.

The 'Networks' attribute indicates the network configurations usable on the network interface represented by the cluster server instance.

The subject key identifier extension shall be present.

Attributes include Idle Mode Interval, Active Mode Interval, Active Mode Threshold, Registered Clients, ICD Counter, and Clients Supported Per Fabric.

Commissionable Node Discovery refers to the identification of a Node that can be Commissioned. This includes Nodes that are brand new, have been factory reset, or have previously been Commissioned but are not necessarily in Commissioning Mode, for the purpose of Commissioning.

The GroupKeyMulticastPolicyEnum data type specifies how IPv6 Multicast Addresses are formed for groups using operational group key sets, with values indicating per-group ID filtering or no filtering for all nodes.

A Root Node endpoint’s Descriptor cluster PartsList attribute must contain a list of all other endpoints on the node, following the full-family pattern defined in the System Model specification.

The proxy harmonizes parameters such as Attribute/EventPaths, DataVersionList, EventNumberList, MinimumSyncInterval, MaximumSyncInterval, etc.

The payload of the Manual Pairing Code consists of required and optional data elements, including Vendor ID and Product ID (optional) and Custom Flow information encoded within the code.

- The origin of the Matter Data Model section is from the Dotdot Architecture Model and parts of Chapter 2 of the Zigbee Cluster Library specification that define the data model. - The purpose is to extend and better define the data model architecture without breaking the certifiable cluster specifications in the Zigbee Cluster Library.

The MsgCounterSyncRsp message is secured with the group key, and it includes the current data message counter for the node sending the response as well as the same 64-bit value sent in the Challenge field of the corresponding MsgCounterSyncReq.

Manufacturer B can add instances of the standard statistics struct to track summary statistics over a different period. If B wants to create a new version of that statistics struct without A’s changes, it must declare a new definition of that struct with new fields.

These values are computed using the Crypto_P2 function as specified in SPAKE2+, involving cryptographic operations that derive these keys for secure session establishment.

Long Idle Time ICDs being provisional implies that their operation and standards are still under review and may undergo changes based on testing and feedback.

The paths to the subscription data include only error-free existent paths generated from processing the Subscribe Request.

The AuthMode field in the AccessControlEntryStruct type indicates the authentication mode used for access control, defining the method by which subjects are authenticated for accessing the specified targets.

The ASN.1 OID for the key usage extension is joint-iso-itu-t(2) ds(5) certificateExtension(29) keyUsage(15).

Section 4.8 describes the privacy processing of Matter messages, focusing on the obfuscation and deobfuscation of message header fields after encryption and before decryption.

The associated Key Identifier SHALL be of a length of 20 octets, consistent with the length of derivation method (1) described in section 4.2.1.2 of [RFC 5280].

For generating the Destination Identifier, the originator uses the operational group key with the second newest EpochStartTime if available; otherwise, it uses the single operational group key available.

The number of Access Control Entries per fabric supported by the server is specified by the AccessControlEntriesPerFabric attribute.

The StatusEnum "Success" indicates the successful transfer of logs.

After validating Device Attestation Information, the Commissioner generates a random 32-byte nonce named CSRNonce using Crypto_DRBG() and sends it to the Node, requesting NOCSR Information using the CSRRequest Command. The Node creates a new candidate Node Operational Key Pair, verifies its uniqueness, creates a Certificate Signing Request (CSR) following PKCS #10 format, signs it using the Node Operational Private Key, and returns the NOCSR Information to the Commissioner.

The NOCSR Elements contain metadata related to NOCSR, encoded in Matter TLV, while the NOCSR Information is the combination of a Matter TLV payload containing the NOCSR Elements and a signature over an nocsr_tbs message containing the in-band-transmitted nocsr_elements_message and a secret out-of-band Attestation Challenge.

A Secure Channel is a communication pathway where messages are encrypted and authenticated, ensuring confidentiality and integrity of the data exchanged. Unicast secure channels additionally authenticate each peer involved.

In the given example, the DestinationMessage octets and DestinationIdentifier octets are calculated based on the provided values of root public key, Fabric ID, Node ID, and Identity Protection Key Epoch Key.

The TrustedTimeSource attribute is set by providing the Node ID and endpoint of a trusted time source on the accessing fabric in the SetTrustedTimeSource command.

The steps include obtaining candidates, sorting them, iterating through them to find positive matches, and selecting the newest candidate (Section Conceptual algorithm for matching OTA Software Images).

The Descriptor cluster supports attributes such as DeviceTypeList, ServerList, ClientList, PartsList, and TagList, each serving specific purposes in endpoint description and composition.

The fallback method is included to support less flexible CA infrastructure that may only allow customary RFC 5280 OIDs in the AttributeTypeAndValue entries of RelativeDistinguishedName elements.

The Secure Channel and Message Layer provides a consistent networking service substrate for secure communication between Nodes in the Matter protocol.

Border Router is A router, also known as Edge Router, that provides routing services between two IP subnets (typically, between a hub network and a peripheral network).

DeltaUTCTimestamp is used to encode timestamps as deltas from the previous event, improving compression of large timestamps.

The output of the algorithm is the SubjectDescriptor structure, which includes fields such as IsCommissioning, AuthMode, Subjects, and FabricIndex.

The AttributeStatusIB provides information about the status of attribute data requests, including whether the request path was invalid, there were errors accessing the data, or writing to an attribute path was successful.

The revisions mentioned in the revision history of the Dimmable Plug-In Unit device are: - 0 Represents device definitions prior to Zigbee 3.0 - 1 Initial Zigbee 3.0 release - 2 New data model format and notation

Examples of Capability Tags include: SIT (short idle time intermittently connected device), LIT (long idle time intermittently connected device), Active (node is always able to communicate), and Simplex (one-way communication, client to server).

Certification Declaration

The responder generates the random number ResponderRandom using a cryptographic pseudo-random number generator with a length of 32 bytes.

The Message Flags field is an unsigned integer bit field containing subfields such as Version, S Flag, and DSIZ Field. The Version subfield specifies the version of the Matter Message format used, the S Flag indicates the presence of the Source Node ID field, and the DSIZ Field indicates the size and meaning of the Destination Node ID field.

The key distribution Administrator plays a crucial role in the operational group keys mechanism by overseeing the reliable distribution of select epoch key material to appropriate participants within the network. It is assumed that the key distribution Administrator possesses all epoch keys, maintains knowledge of the group security domain members requiring access to these keys, and is tasked with pushing updates of these credentials to all authorized Nodes in the managed groups. Responsibilities of the key distribution Administrator include managing the distribution of key material using the Group Key Management Cluster and ensuring that key holders can access the necessary information through Attributes with Access Control List (ACL) entries. This ensures that only authorized entities, such as the Administrator, can access the key material, maintaining the security of the key distribution process.

Epoch keys are generated, managed, and stored by an Administrator on a per-Fabric basis. Each epoch key is a random value with a length specified by CRYPTO_SYMMETRIC_KEY_LENGTH_BITS. The generation process utilizes a cryptographic deterministic random bit generator (Crypto_DRBG) to produce keys of the required length. Additionally, each epoch key is associated with a start time, denoting the time at which the key becomes active for use by transmitting Nodes. These start times are represented in absolute UTC time in microseconds using the epoch-us format.

Each endpoint supporting the OTA Requestor device type must include the OTA Software Update Requestor and OTA Software Update Provider clusters based on the specified conformance.

The SubjectsPerAccessControlEntry attribute has a minimum constraint of 4, indicating that there must be at least 4 subjects per Access Control Entry.

The Message Frame Format section describes the encoding of the Matter message format, which provides support for various communication paradigms, including unicast secure sessions, multicast group messaging, and session establishment. It explains the process of encrypting Matter messages, the structure of Matter messages, and how certain types of messages ensure guaranteed delivery over unreliable transports.

After acknowledging the delivery of the handshake request packet, the BTP Client enables indications over C2 characteristics by writing value 0x01 to C2’s Client Characteristic Configuration descriptor.

SuppressResponse is set to TRUE in a Report Data action when reporting with no data or events from the target to the initiator.

The ActionFailed event is generated when there is an error preventing the action from executing as planned, providing feedback to the client about the non-successful progress of the action.

The security type is auto-selected based on the most secure Wi-Fi security type available within the discovered BSSIDs.

The purpose of the Nullable in Range section is to define rules for nullable data fields, ensuring that null is a valid value and specifying support for lengths of 0 (zero) for lists or octet strings if they are nullable.

- An endpoint should not include itself in its PartsList attribute. - Cycles where an endpoint is an ancestor of itself should not occur. - A root node device type should be a singleton on the root node endpoint, with its PartsList listing all endpoints on the node except the root node endpoint. - Each device type in a composed device type indicated in the DeviceTypeList attribute should be supported by an endpoint in the PartsList.

Threat T84: Person with physical access to already installed Device resets Device then scans QR code to gain access. [CM4]

The inclusion of the group security info enhances the security of operational group key derivation by ensuring that each key derivation process results in unique operational group keys. By incorporating a constant and hard-coded value into the derivation process, the group security info diversifies the set of operational group keys, preventing key reuse and enhancing security across different versions or instances of the standard's implementation. This mechanism also enables flexibility for future security updates, as changing the group security info allows for the derivation of new keys, thus adapting to evolving security requirements and ensuring continued protection of group communication.

The Valid Read Attribute Paths table allows various types of attribute paths, including wildcard paths that retrieve all attribute data from specific clusters, endpoints, or nodes, as well as specific paths targeting global or specific attribute data within clusters.

Automated CASE tests can be run using the command "chip-tool tests Test_TC_OO_1_1", which executes a suite of tests communicating with a paired all-clusters-app peer node.

AddNOC is used to commission a Node into a Fabric by providing a usable NOC and ICAC, while UpdateNOC is used to update existing credentials within a Fabric.

If no key is found for the given Session ID, security processing fails, and no further security processing is performed on the message.

The outgoing message counter is obtained as follows: a. For a message of Unsecured Session Type, the current Global Unencrypted Message Counter is used. b. For a message of Secure Unicast Session Type, the current Secure Session Message Counter for the session associated with the Session ID is used. c. For a message of Group Session Type: i. If the Security Flags C Flag = 0, the Global Group Encrypted Data Message Counter is used. ii. If the Security Flags C Flag = 1, the Global Group Encrypted Control Message Counter is used.

The extended key usage extension shall be encoded with exactly one key-purpose-id value: codeSigning.

After completing an update, the OTA Requestor should invoke the NotifyUpdateApplied command to inform the OTA Provider (Section Update application process).

Upon receiving ResumeMsg2, the initiator performs several actions, including generating the S2RK key, verifying the Resume2MIC, and setting session parameters.

Device Attestation Certificate

The DNS-SD records convey various information about the device, including the service instance name, service type, discriminator (short and long), vendor ID, product ID, commissioning mode status, device type, device name, pairing hint, and pairing instruction. Additionally, the records provide details about the host name, port number, and IPv6 address associated with the device.

Status code 0x87 represents a constraint error or invalid value, such as an out-of-range value or a value set to a reserved value.

- AuthorityKeyIdentifier extension of the certificate being queried. - Issuer name field of the certificate being queried. - SerialNumber field of the certificate being queried. - RevocationDataSet indexed by (CertificateAuthorityKeyIdentifier, CertificateAuthorityName), yielding a set of RevokedEntitySerialNumber.

Wi-Fi nodes supported include Controller/Admin and Node, with examples such as chip-tool (Linux/Mac) and all-clusters-app on platforms like M5Stack (ESP) and Linux simulation.

Scan all BLE advertising channels with sufficient duration for quick discovery.

The encryption operation is executed using the obtained Privacy Key (K), the MIC from the message security protection (C), the PrivacyNonce (N), and the message header fields (M) as follows: <br> CP = Crypto_Privacy_Encrypt(K, M, N)

Manufacturer C adds a custom cluster with a sensor attribute and seeks to track summary statistics for the sensor over a recent period. Because this cluster does not extend any previous cluster, it cannot instantiate any extended versions of the SummarizedStats struct defined previously and must redefine the struct within its cluster definition.

The CSA-PNP document provides Organizational Processes and Procedures and is available at https://groups.csa-iot.org/wg/members/document/21624. It is currently at revision 8, dated November 2021, and is marked as provisional.

Lists are encoded as a TLV array, with the list index starting at 0 and a maximum size of 65535 elements.

It indicates the maximum current expected to be provided by the hard-wired source, in mA (milliamps).

The A Flag is set when the message is acting as an acknowledgment.

Path1 = [[ Node = 0x18B430003020203, Endpoint = 10, Cluster = Disco Ball, Attribute = Pattern, ListIndex = 3 ]] // Start tracking path elements.

Commissioner Discovery allows a Commissionee to discover Commissioners on the network, enabling the initiation of the commissioning process. A Commissionee may initiate Commissioner Discovery upon user interaction. This process involves discovering Commissioners and obtaining information such as Vendor ID, Product ID, and friendly name for each Commissioner. Once discovered, the Commissionee may display the list of Commissioners to the user for selection. Upon selection, the Commissionee may use the User Directed Commissioning protocol with the chosen Commissioner to indicate that the user has selected it for commissioning. In essence, Commissioner Discovery serves as a "doorbell" protocol, allowing a Commissionee to request commissioning.

If there is not a preceding successful Timed Request action, the Write Request action MAY be groupcast.

No, the SupportedLocales attribute cannot contain duplicate entries.

Threat T87: Malicious Device or party poses as valid Matter Node using operational credentials. [CM87]

The Endpoint field in the AccessControlTargetStruct type indicates the endpoint ID of the target endpoint, implying that access control privileges apply to the specified endpoint within the network.

The KeySetRemove command is used by Administrators to remove all state of a given Group Key Set.

All implementations shall reject Matter certificates with more than 5 RDNs in a single DN.

Messages are categorized as either secured or unsecured and contain a Session Type, Session ID, and Message Counter field for identification and security purposes.

The Access Control List includes Access Control Entries with fields such as Subjects List, Targets List, Authentication Mode value, and Privilege value.

Bridge Manufacturers should choose which Matter device types they support in the Bridge and expose all connected non-Matter devices that can be mapped to a certified Matter device type. They may decide not to expose certain devices based on compatibility and interoperability reasons or allow users to restrict device exposure further through a Bridge Manufacturer's app.

The IssuerSubjectKeyID field uniquely identifies the PAA or PAI for which the revocation distribution point is provided, via the certificate’s SubjectKeyIdentifier mandatory extension.

The normative reference documents include the Matter Core Specification (Under development) and the Organizational Processes and Procedures from CSA (Provisional).

Examples include a client choosing Read interactions instead of Subscribe interactions, or choosing not to Write or Invoke commands.

After completing an update, the OTA Requestor should invoke the NotifyUpdateApplied command to inform the OTA Provider (Section Update application process).

An OTA Requestor shall not query more frequently than once every 120 seconds, except under certain events like power loss or restart. It is recommended for OTA Requestors to attempt a daily query to ensure timely access to updated software.

Devices have a physical button or trigger for factory reset.

The Name field indicates a human-readable name for the network interface.

The UniqueID attribute, when present, for a Bridged Device should be updated when the Bridge is factory reset.

The Device Type field in the AccessControlTargetStruct type signifies the device type ID associated with the target device type, suggesting that access control privileges apply to all endpoints conforming to the specified device type.

The steps for executing the AEAD generate and encrypt operation are as follows: 1. The bit string key K is set to the Encryption Key obtained from step 1. 2. The nonce N is set to the CRYPTO_AEAD_NONCE_LENGTH_BYTES-octet string constructed according to Table 15, "Nonce". 3. The parameter P is set to the Message Payload. 4. The additional data octet string A is set to the Message Header contents, using little-endian byte order for all scalars, exactly as they appear in the message segments from which they originate. Optional fields are appended according to the Message Flags. 5. The AEAD generate and encrypt operation C = Crypto_AEAD_GenerateEncrypt(K, P, A, N) is executed.

Nodes should adjust their Granularity attribute based on their assessed time synchronization error. Nodes running an NTP server should maintain a Granularity of SecondsGranularity or better and should maintain an accuracy of MillisecondsGranularity or better.

A Product Attestation Intermediate is an entity operating an intermediate level Certificate Authority for the purpose of Device Attestation, acting as an intermediary in the attestation hierarchy.

Threat T39: Guessing security keys via brute force attack. [CM39]

Before starting a PASE session, it must be ensured that the initiator (Commissioner) has somehow obtained the passcode, and the responder (Commissionee) possesses the relevant Crypto_PAKEValues_Responder corresponding to the passcode.

The AttributeRequests parameter provides a list of zero or more request paths to cluster attribute data.

The public key algorithm used in the DAC is id-ecPublicKey with NIST curve P-256.

The TagList attribute is used to disambiguate sibling endpoints in certain situations and provide additional information about an endpoint. Clients can use tags in user interfaces and logic.

The BlockAckEOF message is sent in response to BlockEOF to indicate that the Receiver has received all data. It signals the end of the ongoing bulk data transfer session and a successful transfer of the file.

The EventFilterIB contains fields for Node, EventMin, Path, and IsUrgent.

The Group Session ID records the Group Session ID derived from the Operational Group Key that is being used to encrypt messages within the counter synchronization exchange.

Depending on its type, a TLV element may contain a length field that specifies the length, in octets, of the element’s value field.

The elements are Path, EventNumber, Priority, and Data.

Crypto_Privacy_Encrypt() encrypts a message using a symmetric key and a nonce, outputting the encrypted data.

A "Subject" primarily describes the source for an action, using a given authentication method provided by the Secure Channel architecture.

Matter is described as a unifying, IP-based connectivity protocol built on proven technologies and industry expertise. It simplifies connected experiences, enhances compatibility, and improves security in smart homes and IoT ecosystems.

The Report Data Action is either the first action in a Report transaction, as part of a Subscribe interaction, or a following action to a Read Request action or Subscribe Request action.

At least one attribute or event must be indicated in the Subscribe Request Action.

The signature algorithm in a Matter certificate includes the value ecdsa-with-sha256, which represents the ECDSA with SHA256 algorithm.

Crypto_DRBG() generates random numbers used for security purposes like secret key generation, counters, and cryptographic signature generation.

Threat T86: Leak certificate or Device identity private key to appear as valid Device. [CM23]

In a Timed Write Transaction, the actions involved are Timed Request, Status Response, Write Request, and Write Response.

The validity period of the DAC is from Jun 28 14:23:43 2021 GMT to Dec 31 23:59:59 9999 GMT.

Each session as part of secure session state has a separate 32-bit counter called the Secure Session Message Counter.

All Nodes protect the confidentiality of operational credential private keys, although the level and nature of protection may vary depending on the nature of the Nodes.

The acknowledgment timer for the Exchange is started in MRP when a message is received by adding the message counter of the received message to the acknowledgment table to signal that an outbound acknowledgment is pending, and then starting the timer.

All parameters passed in transactions and queries to the DCL pass input validation checks.

PASE establishes encryption keys between the Commissioner and Commissionee for encrypted communication and attestation challenge during the device attestation.

When a temperature sensor sends a status report to the Bridge over a non-Matter interface, the Bridge processes this as an update to the Measured Value attribute of the Temperature Measurement cluster on the associated endpoint.

MS extensions are only permitted on standard clusters or another existing MS extension of a standard cluster from another manufacturer. A struct extended with new fields must have the same definition across all instances within a given cluster definition.

Operational discovery of Matter Nodes allows for runtime dynamic discovery rather than assuming fixed IPv6 addresses and ports. This approach provides flexibility for the IPv6 network to evolve without disrupting Matter functionality. Similar to other networked consumer electronics products, which also don't rely on a single fixed IP address, dynamic discovery ensures adaptability to network changes over time [RFC 5505].

The Cluster ID of the Group Key Management Cluster is 0x003F.

Returns the signed Attestation Information to the Commissioner using AttestationResponse.

The Protocol Vendor ID field, an optional unsigned integer value, contains the Vendor ID namespacing for the Protocol ID field. It is present only when the V Flag is set, indicating whether the Protocol Vendor ID is present.

The LabelList attribute allows each endpoint to be tagged with zero or more labels.

Persistent data retains its value across a restart, including program restarts, power cycles, user-initiated reboots, and reboots from program image upgrades.

The SendInit message is sent by an Initiator to propose a BDX Transfer session where the Initiator wants to be a Sender, while the ReceiveInit message is sent by an Initiator to propose a BDX Transfer session where the Initiator wants to be a Receiver.

The ProductLabel Attribute specifies a vendor-specific human-readable product label, which may provide a more user-friendly representation compared to the ProductName Attribute. It should exclude the vendor name present in the VendorName Attribute.

The PBKDFParamResponse message serves to respond to the PBKDF parameters request initiated by the PBKDFParamRequest message.

An OTA Requestor can delegate user consent to Nodes by setting the RequestorCanConsent field in the QueryImageRequest to True, enabling the OTA Provider to delegate user consent to the OTA Requestor Node (Section User consent delegation to Nodes).

The NodeOperationalCertStatusEnum type is used by the NOCResponse common response command to convey detailed outcomes of several operations within the Node Operational Credentials Cluster. It includes values such as OK, InvalidPublicKey, InvalidNodeOpId, and others.

Each peer maintains an acknowledgement-received timer, starting it when sending any BTP packet. It restarts the timer when a valid acknowledgement is received for any but its most recently sent unacknowledged packet. If the timer expires or an invalid acknowledgement is received, the peer closes the BTP session and reports an error.

It indicates DC current.

An ec-signature is the encoding of a signature, as defined in Section 3.5.3, “Signature and verification”, represented as an OCTET STRING with a specific length.

A device may report Firmware Information containing its firmware digests only if it implements a secure subsystem capable of securely collecting and reporting firmware digests through a process known as "measured boot."

The GroupKeyMap attribute associates a logical Group Id with a particular group key set.

The Report Data Action shall not include any nested attribute data field or nested event data field that is defined as fabric-sensitive if the associated fabric for that field does not match the accessing fabric for the interaction.

Threat T22: Cloned Device produced (with identical credentials to a proper Device). [CM23, CM77]

The defined subtypes include long discriminator, short discriminator, Vendor ID, device type identifier, and Commissioning Mode.

The Number Field in an event record is a monotonically increasing event number value scoped to the node, preserved across restarts.

BTP splits individual Service Data Unit (SDU) messages into multiple BTP segments, with each segment transmitted via a single GATT write or indication.

There are no VendorID values present in the subject field of the PAA certificate.

The Discovery Capabilities Bitmask contains information about the device’s available technologies for device discovery. It is an 8-bit capabilities bitmask included in machine-readable formats.

nan

CommandPathIB is a TLV structure used to specify the path to a command, including the endpoint, cluster, and command itself.

The Device Attestation PKI Revocation Distribution Points Schema of the Distributed Compliance Ledger.

EventReportIB is used to report the status and data of an event in a TLV structure format.

The main goal of the Network Commissioning Cluster is to associate a Node with or manage a Node’s one or more network interfaces.

The PAA Schema allows approved Product Attestation Authorities Certificates to be uploaded and made available via DCL queries.

If a Node receives an on-link prefix that allows autonomous configuration and has fewer than three routable IPv6 addresses configured, it autonomously configures an IPv6 address out of that prefix.

The Secure Channel Protocol is composed of several sub-protocols, including: <br> - Message Counter Synchronization Protocol (MCSP) <br> - Message Reliability Protocol (MRP) <br> - Passcode Based Session Establishment (PASE) <br> - Certificate Based Session Establishment (CASE)

Universal Time Coordinated

The TestEventTrigger command provides a means for certification tests to trigger testplan-specific events necessary to assist in automation of device interactions for certification test cases.

Threat T72: Code signing key copied, permitting signing of unauthorized code. [CM28]

Message reception state is compressed using a lossy compression scheme that leverages the sequential generation of message counters by the sender. It is represented as a pair of values: the maximum message counter received and a bitmap indicating which preceding messages have been received.

A more general concept where an endpoint can be part of multiple zones, indicating that a user has defined a list of endpoints they would like to control as a group, allowing Matter controllers to provide a way to control them.

The device type specified in the "Temp Sensor Client" example is 3.

MonitoredSubject indicates the monitored Subject ID and is used to determine if a particular client has an active subscription for the given entry. It allows the flexibility of having a different CheckInNodeID from the MonitoredSubject.

Attribute paths are employed to indicate all or part of a cluster attribute, potentially delving into deeper parts of collection type data, as explained in this section.

Matter: Endpoint, HomeKit: Profile, Weave: Resource, Thread: Interface, Zigbee: Endpoint

The length of the ProtocolData section is variable and depends on the additional information required by the protocol. It may be empty if no additional information is needed.

The NotifyUpdateApplied command should be invoked in two circumstances: 1. An OTA Requestor has just successfully applied a Software Image it had obtained from a previous QueryImage response. 2. An OTA Requestor has just successfully applied a Software Image it had obtained through means different than those of this Cluster.

When removing a binding, the client endpoint must end the binding relationship with the removed binding target.

StatusResponseMessage is used to send a response containing a status code in a TLV structure format.

The examples emphasize the efficiency of service discovery and usage on the network, noting that browsing, resolving, and address lookup typically require only a single network round-trip. DNS Additional Record mechanism reduces redundant network operations by storing related records for subsequent steps. Application-layer end-to-end security is crucial due to the potential for malicious or fraudulent replies in Multicast DNS.

The key usage extension defines the purpose of the key contained in the certificate.

The Secured Extensions field is a variable-length block of data for providing backward-compatible extensibility. It is present only if the SX Flag is set to 1 in the Exchange Flags field. The format of the Secured Extensions block is defined in Table 13, and it is encrypted and authenticated based on the Security Flags settings.

Upon receipt of the UnregisterClient command, the server checks whether there is an entry stored for the fabric with the same CheckInNodeID, verifies permissions, checks the verification key, removes the entry from storage if conditions are met, and generates a response.

The "SetupURL" attribute, when provided, indicates a URL that provides additional information for the actions provided by the cluster.

Temperature is represented as a value derived from int16, indicating temperatures in Celsius with a resolution of 0.01°C, where the value equals the temperature in Celsius multiplied by 100.

Commissioners and Administrators carefully control which Nodes get Administer, Manage, or Operate privilege, especially for safety-critical systems like Door Locks and Smoke CO Alarms.

The Access Control Cluster should be present only on the root node endpoint of each Node and not on any other Endpoint of any Node.

The issuer and subject fields of a certificate should use the fallback method only if the relevant Matter-specific OIDs are not present. If the fallback method is used, any mention of "Vendor ID" or "Product ID" with regards to a Device Attestation Procedure step should rely on values obtained with that method. The usage of the fallback method should be consistent within the issuer and subject fields of certificates within the DAC chain.

The source IP address and port are included in the Groupcast Session Context to enable unicast responses to group communication peers, as required for the Message Counter Synchronization Protocol.

The example demonstrates how a commissioned Matter Node advertises its availability for control via the Matter protocol. DNS-SD records are set up using both the dns-sd and avahi command-line test tools. The example includes the host name of the device on Wi-Fi, which is represented by its 48-bit device MAC address (B75AFB458ECD). The example also illustrates how a Matter controller can discover the current IPv6 address and port for the commissioned Matter Node.

A user provides consent by instructing an existing Administrator, who then puts the Node into commissioning mode using steps outlined in Section 5.6.4, "Open Commissioning Window".

The WiredFaultEnum data type is used to indicate various fault conditions on a wired power source, such as unspecified faults, overvoltage, and undervoltage.

A node must support at least one group key per fabric, three group keys per fabric, at least four group table entries per fabric per endpoint with a Groups cluster instance, and one IPv6 multicast group membership for every operational group supported.

To allow the user to easily identify and recognize the various Bridged Devices and expedite the setup/configuration process.

The categories of application device types listed in Chapter 3 are lighting, smart plugs/outlets and other actuators, switches and controls, sensors, closures, HVAC, media, generic, robotic devices, and appliances.

The media-related device types are: - 0x0028 Basic Video Player - 0x0023 Casting Video Player - 0x0022 Speaker - 0x0024 Content App - 0x0029 Casting Video Client - 0x002A Video Remote Control

The Secure Channel emits a CloseSession StatusReport message when a Node chooses to close a session for various reasons, such as completing the interaction between nodes or freeing up resources for a new session.

SPAKE2+ in Matter relies on Crypto_PBKDF for PBKDF, NIST P-256 elliptic curve for the group, Crypto_Hash for hashing, Crypto_HMAC for HMAC, and a specific KDF function defined in Matter.

Parameters and constants in the Secure Channel Protocol are defined in a glossary, providing descriptions and default values for each constant.

Epoch keys are managed using the Group Key Management Cluster. For each group key set published by the key distribution Administrator, there should be at least one and at most three epoch keys in rotation. Key additions or updates are performed using the KeySetWrite command. Key updates are idempotent operations, ensuring that the Administrator remains the source of truth. When updating epoch keys, they should be ordered from oldest to newest. A key update may deliver a partial key set but should include EpochKey0 and optionally EpochKey1 and EpochKey2. Additionally, any update of the key set, including a partial update, should remove all previous keys in the set. An Administrator may completely remove a group key set from a Node using the KeySetRemove command, effectively revoking access to operational group keys associated with that set.

The LatestValue field should be set to NULL if resources are scarce and adequate resources are not available for it.

Both peers in a BTP session establish a maximum window size during the handshake. They decrement a counter for the remote peer's receive window when sending packets and increment it upon acknowledgment. If the counter reaches zero, the window is considered closed, and the peer stops sending packets until it reopens. Peers also maintain a counter for their own receive window size based on the sequence number difference between the last received and acknowledged packet, which helps in sending early packet acknowledgments.

The ChildRoleCount attribute indicates the number of times the Node entered the OT_DEVICE_ROLE_CHILD role.

It should be updated using the 'Breadcrumb' argument.

Passcode-Authenticated Session Establishment

If a peer detects that its receive window has shrunk to two or fewer free slots, it immediately sends any pending acknowledgement as a stand-alone BTP packet to prevent session stalling.

"LabelList" signifies an example scenario involving a list of labels.

Priority is an enumeration used to tag events or data, without a defined ordering, where specific uses may assign values that imply an ordering relationship, such as DEBUG, INFO, and CRITICAL priorities.

The Month field represents months from January (1) to December (12).

The Interaction Model determines whether to allow or deny an action for a request by checking whether the required privilege for the action is present in the set of granted privileges. If the required privilege is present, the action is allowed; otherwise, it is denied.

If an OTA Requestor reaches a terminal failure point for a Software Image transfer, it should reset its entire software updating state and revert to doing a future query at the next possible scheduled time (Section OTA Software Image transfer examples).

Upon receiving Msg2, the initiator generates a shared secret, decrypts the data, and performs various validations.

The MfgCode field, if not null, specifies the Vendor ID, indicating the NamespaceID from the manufacturer's defined namespace. The Tag field is the ID of a semantic tag within that namespace.

Actions are constructed using the Interaction Model, serialized into a binary format for network transmission at the Action Framing layer, then encrypted and authenticated by the Security Layer.

Object Identifier (from ITU ASN.1)

An operational group key is a symmetric key utilized as the Encryption Key during Message Processing for group communication. It serves as the key for encrypting and decrypting messages exchanged within an operational group, ensuring confidentiality and integrity of communication among group members.

The Valid Proxy List attribute contains the list of valid proxies that can proxy the node, with each entry in the list being fabric-scoped.

Threat T174: Malicious Device gains knowledge of Passcode on an uncommissioned Device. [CM41, CM152]

The Exception Value indicates an action executed by the server when a certain condition, which normally does not happen, is not met. For example, locking the doors when the server detects nobody is at home while the doors are unlocked.

Upon receiving Pake1, the responder computes pB, then computes TT, (cA, cB, Ke), and sends Pake2 with pB and cB.

The AccessControlEntryPrivilegeEnum enumeration defines various privilege levels that can be granted by the Access Control system. These levels include View (reading or subscribing to data), Proxy View (reading or subscribing to data from a Proxy), Operate (writing operational data and invoking operational commands), Manage (writing configuration data and invoking configuration commands), and Administer (writing administrative data and invoking administrative commands).

A Certificate Authority (CA) is an entity that issues digital certificates, such as a DAC or NOC, authorizing the use and authenticity of digital entities.

The device type identifier for the primary function of the device.

The payload of the Pake2 message follows the pake-2-struct TLV schema.

The value of the PI key is dependent on the value of the PH key. For example, if bit 8 of the PH key is set, indicating "Press Reset Button for N seconds," then the value of the PI key might specify the duration N. Similarly, if bit 4 of the PH key is set, indicating a custom instruction, then the value of the PI key provides the custom instructions for entering Commissioning Mode.

The PI key provides pairing instructions related to the methods indicated by the PH key. It is encoded as a UTF-8 string and gives additional details or parameters for entering Commissioning Mode, such as the duration of button presses.

The Node inadvertently loses its ability to update the Access Control Cluster beyond Endpoint 2.

Matter certificates only support version X.509 v3, although the version number field is not encoded in the Matter certificate structure.

The Administrator revises the Access Control Entry to grant the same privilege, but only for the pump configuration and control cluster (0x0202) on endpoint 3, and for any door lock cluster (0x0101) on the entire Node, to the same Nodes.

It indicates the quantity of individual battery cells or packs in the battery source.

The default value for the MSG_COUNTER_WINDOW_SIZE constant, which defines the maximum number of previously processed message counters to accept from a given Node and key, is 32.

The AssociationFailure event indicates that a Node has attempted to connect or reconnect to a Wi-Fi access point but is unable to successfully associate or authenticate after exhausting all internal retries of its supplicant.

Defined in Section 4.2.2, “Matter Node Behavior”.

The TxTotalCount attribute indicates the total number of unique MAC frame transmission requests.

Threat T170: Unintended or premature exposure of information. [CM160]

The AccessControlExtensionStruct type is used to provide an extension mechanism for Access Control Entries, allowing manufacturers to store arbitrary TLV-encoded data related to a fabric's Access Control Entries.

Similar clusters and constraints related to the Fail-Safe timer and cluster operation time-outs are used for administrative operations.

It indicates the string representing the IEC designation for the battery.

The Descriptor cluster supports a list of one or more device type identifiers representing conformance to device type specifications and a PartsList attribute for composing endpoints to complex device type patterns.

BTP packet receipt acknowledgements are received as unsigned 8-bit integer values in the header of a BTP packet.

The signature algorithm used in the DAC is ecdsa-with-SHA256.

The UpdateToken field contains the UpdateToken as specified in Section 11.19.3.6.1, “UpdateToken usage”.

The General Commissioning Cluster manages basic commissioning lifecycle and hosts functionalities that don’t fit well in other commissioning clusters.

The PAASubjectKeyID field uniquely identifies the PAA certificate’s Subject Key Identifier mandatory extension as defined in the PAA Certificate.

Disambiguation helps to distinguish between sibling endpoints with overlapping application device types, ensuring clarity for clients and servers.

Examples include a light switch controlling light bulbs and a thermostat subscribing to an occupancy sensor, without knowing the remote endpoints of these devices.

Under the Trust-first policy, the first authenticated message counter from an unsynchronized peer is trusted, and its message counter is used to configure message-counter-based replay protection on future messages from that node.

They use the ArmFailSafe and CommissioningComplete commands of the General Commissioning Cluster.

Nodes shall randomize the initial value of the Secure Session Message Counter per Section 4.5.1.1, “Message Counter Initialization”, on session establishment.

A composed device type is composed of one or more other device types, with its endpoints listed in the PartsList of the endpoint of the composed device type.

The obfuscated output (CP) represents the encrypted message header fields, which are then used in the final private message in place of the original message header fields.

The HardwareFaultChange event data contains the current set of hardware faults detected and the set of faults detected prior to the change event.

The PacketUnicastRxCount attribute indicates the number of unicast packets received by the Node.

The basic constraints extension shall be encoded with is-ca set to false.

The matter-node-id DN attribute type certifies the identity of a Matter NOC.

It indicates a coarse ranking of the charge level of the battery.

Constraints include eviction rules prohibiting the eviction of existing proxies, limitations on the number of direct proxies per source, and considerations for multi-fabric settings.

A Product Attestation Authority is an entity operating a root level Certificate Authority specifically for Device Attestation, ensuring the authenticity and integrity of devices within a network.

Upon sending a Subscribe Response action, the subscription becomes active on the publisher with a min interval equal to the requested MinIntervalFloor and a max interval equal to the MaxInterval field in the response.

The Power Source cluster supports the following features: WIRED for a wired power source, BAT for a battery power source, RECHG for a rechargeable battery power source (requires Battery feature), and REPLC for a replaceable battery power source (requires Battery feature).

Matter implementations SHOULD implement resiliency features (e.g., responding to secure boot failures with recovery or error signaling mode) to detect and handle compromise. [CM57 for T59, T226]

The MRP Standalone Acknowledgement message is formed with an empty application payload, the A Flag set to 1, the Acknowledged Message Counter included in the header, Protocol ID set to PROTOCOL_ID_SECURE_CHANNEL, and the Protocol Opcode set to MRP Standalone Acknowledgement.

MCSP ensures that the recipient of a message encrypted with a group key can trust and process that message only if it has kept the last message counter received from a given sender using that key.

The overridden element requirements for the Extended Color Light device are: - Identify Command TriggerEffect - Scenes Command EnhancedAddScene - Scenes Command EnhancedViewScene - Scenes Command CopyScene - On/Off Feature - Level Control Feature - Level Control Attribute CurrentLevel - Level Control Attribute MinLevel - Level Control Attribute MaxLevel - Color Control Feature Hue/Saturation - Color Control Feature EnhancedHue - Color Control Feature ColorLoop - Color Control Feature XY - Color Control Feature ColorTemperature - Color Control Attribute RemainingTime

The TotalSize field indicates the total size, in bytes, of the entire file, including all fields and Payload.

A cryptographic document that allows a Matter device to assert its protocol compliance.

The NOCStruct type encodes a fabric-sensitive NOC chain, underpinning a commissioned Operational Identity for a given Node. It contains fields such as NOC (for the NOC associated with the fabric) and ICAC (for the ICAC associated with the fabric).

Bulk Data Exchange

Upon discovering loss of synchronization, a subscriber may initiate a re-subscription to resume the subscription.

The DCL, an open-source project, serves as a data repository for device models' information and their compliance status. Additionally, it acts as a secure distribution point for device metadata provided by vendors and Product Attestation Authorities certificates.

Depending on the context, the device either deletes all Matter related data on the node or begins the process of irrevocably deleting associated Fabric-Scoped data.

A binding directs a local endpoint to a target endpoint or cluster on another endpoint, allowing a client to interact with the target endpoint.

The IsOperational field indicates if the Node is currently advertising itself operationally on this network interface and is capable of successfully receiving incoming traffic from other Nodes.

UDC is a process where the Commissionee initiates commissioning by sending a message to the Commissioner.

The ActionFailed event has ActionID, InvokeID, NewState, and Error as its data fields.

Standard DN attributes used in a Matter certificate are represented by context-specific tags logically-ORed with 0x80 to indicate the PrintableString format.

The Cluster ID of the Fixed Label Cluster is 0x0040.

It describes the process by which a client discovers that a source needs a proxy, finds an appropriate proxy on the network, and sets up the proxy to subscribe to the source.

It indicates the relative preference with which the Node will select this source to provide power.

These subranges of Node ID assign access control subjects to specific PAKE keys or groups of peer nodes sharing a single CASE session, respectively, for access control and administrative purposes.

Fabric ID 0 is reserved across all fabric root public key scopes and shall not be used as the identifier of a fabric.

During commissioning, the Commissioner should set the UTCTime and set up the TrustedTimeSource, DefaultNTP, TimeZone, and DSTOffsets as required. However, the Commissioner may opt not to set the time, so the node should not depend on having time during commissioning.

The 'RemoveNetwork' command removes a network configuration from the server.

The MaxGroupKeysPerFabric attribute specifies the maximum number of group key sets that a node supports per fabric.

The DelayedActionTime field in a QueryImageResponse with a Status of Busy conveys the minimum time to wait before sending another QueryImage command or beginning a download from the OTA Provider (Section QueryImageResponse Command).

SuppressResponse is a boolean tag indicating whether to suppress the response message.

The AccessControlTargetStruct type is used to specify targets for access control entries, such as clusters, endpoints, or device types, defining the entities to which access control privileges apply.

For secure unicast sessions, both CASE and PASE allow each participant to choose a unicast session identifier for the subsequent encrypted session. The chosen session identifier must be unique and not overlap with other active sessions.

The BTP GATT service consists of three characteristics: C1, C2, and C3. C1 is the Characteristic for the Client TX Buffer, used by the client to initiate BTP sessions and send data to the server. C2 is the Characteristic for the Client RX Buffer, used by the server to respond to BTP handshake requests and send data to the client. C3 is an optional Characteristic for additional commissioning-related data.

It indicates that the source is available and currently supplying power.

Unsigned Integer data types are defined with various bit widths (8-bit to 64-bit) and have a usable range of [0..2^N-1] if not nullable or [0..2^N-2] if nullable, with specific minimum and maximum values for each width.

The Interaction Model specifies which privilege is required for each data element and how each action is processed, both for request and response. It includes details on how Access Control is used to determine whether to allow or deny the request, and this determination is based on the required privilege for the action and the set of granted privileges for the action, considering the request path and requesting subject.

Matter supports UDP and TCP for Commissionable Node Discovery, both for Commissionees already on the customer’s IP network and for Commissionees in conjunction with Wi-Fi Soft-AP.

The Rotating Device Identifier employs a key derivation algorithm that combines a monotonically increasing lifetime counter with a unique per-device identifier, ensuring security and privacy requirements.

Matter leverages modern security practices and protocols to ensure the security of smart home devices and interactions.

The StopAction command stops the ongoing action on the involved endpoints, and afterward, the action's state becomes Inactive.

In case of a BDX transfer aborted due to unforeseen circumstances, the OTA Provider should validate the length and digest of proxied images whenever possible to avoid continuing a transfer if the data is corrupted (Section OTA Software Image transfer examples).

For example, if the Session ID is 42 (0x002A) and the computed MIC is c5:a0:06:3a:d5:d2:51:81:91:40:0d:d6:8c:5c:16:3b, the PrivacyNonce would be constructed by concatenating "00:2a" with "d2:51:81:91:40:0d:d6:8c:5c:16:3b", resulting in "00:2a:d2:51:81:91:40:0d:d6:8c:5c:16:3b".

The context-specific tag future-extension [6] is used to identify all future extension entries in the Matter certificate extensions list.

The responder verifies TBEData3.initiatorNOC using the Crypto_VerifyChain function with the appropriate certificates, depending on the presence of initiatorICAC.

The Base-38 alphabet is a subset of the 45 available characters (A-Z0-9$%*+./ :-) in the QR code for alphanumeric encoding, with certain characters removed.

The data of the BootReason Event contains the reason for the start-up, represented by the BootReason field.

Once commissioning is completed and the Node is properly configured, Administrators on the newly joined Fabric have access to the Node and can perform all administrative tasks.

With fabric-filtering disabled during a read interaction, the list is reported as a full list with all entries.

The RxErrNoFrameCount attribute indicates the total number of received unique MAC frame requests that have been dropped as a result of missing or malformed frame contents.

StatusResponseMessage is a TLV structure used to send a response containing a status code.

The transaction ID, present in all actions, indicates the logical grouping of those actions.

The purpose of the OTA Software Image header is to provide necessary information for OTA Providers to validate images available for a given OTA Requestor.

Device attestation ensures that a Matter device cannot join a Matter fabric unless proven genuine, enhancing security and ensuring a uniform and compliant ecosystem.

The Report Data Action is generated as part of a Read transaction in direct response to a Read Request action, as part of a Subscribe transaction in direct response to a Subscribe Request action, or as the first action of each synchronized Report Transaction in a Subscribe interaction.

If the HourFormat attribute is null, the hour format is determined by any unit implied through the ActiveLocale attribute. If ActiveLocale is not present, the hour format is unknown.

There is exactly zero or one VendorID value present in the issuer field of the PAI certificate.

The attributes included in the Node Operational Credentials Cluster are NOCs, Fabrics, SupportedFabrics, CommissionedFabrics, TrustedRootCertificates, and CurrentFabricIndex.

- A fabric is a set of nodes that interact by accessing data model elements. - It is a security domain allowing nodes to be identified and communicate within the domain. - A node can be on one or more fabrics.

A Write Interaction is initiated when an initiator wishes to modify the values of one or more attributes located on one or more nodes.

- Nullable: Data field can be nullable. - Non-Volatile: Attribute data is persistent. - Fixed: Value is fixed. - Scene: Attribute is part of a scene. - Reportable: Attribute supports reporting. - Changes Omitted: Data changes are not reported. - Singleton: Cluster is a singleton on the node. - !Q: Disallows a specified quality.

Threat T186: Test House posts incorrect information about a vendor’s product. [CM163, CM167]

Secure Channel Protocol messages are organized based on the underlying sub-protocol using opcode values.

The InstantActionWithTransition command has ActionID, InvokeID, and TransitionTime as its data fields.

Implementations should avoid decreasing the SubjectsPerAccessControlEntry attribute over time to prevent invalidating ACL entries already written. It's recommended to only use the minimum value required and avoid reporting a higher value than necessary.

Data privacy is highlighted as a core concept for all protocols and interaction methods in Matter.

The CertificateChainRequest command is used to request a certificate chain. If the CertificateType is not a valid value per CertificateChainTypeEnum, the command fails with a Status Code of INVALID_COMMAND.

Examples of errors that may invalidate a Matter certificate include: encoding undefined elements, incorrect encoding order, wrong element types, out-of-range lengths, encoding undefined Matter OID values, and invalid Matter Distinguished Names encoding, among others.

The algorithm behaves as if an implicit Access Control Entry were present on the Commissionee to grant Administer privilege for the entire Node.

A DAC proves the authenticity of the manufacturer and certification status of the device’s hardware and software, used during commissioning to admit only trustworthy devices into a Fabric.

The TagList in the Descriptor cluster provides an alternative mechanism for self-description using standardized tags instead of manufacturer-selected strings.

The CertificateChainResponse command is generated in response to a CertificateChainRequest command. It contains a Certificate field, which is the DER encoded certificate corresponding to the CertificateType field in the CertificateChainRequest command.

The project aims to serve as a data store for device models' information and their compliance status, a secure distribution point for device metadata provided by vendors, and a secure distribution point for Product Attestation Authorities certificates.

In the scenario of redundant mains power sources, two Power Source Clusters are defined, one for each mains source with the same order.

Some of the principles underlying data privacy requirements include lawfulness, fairness, and transparency; purpose limitation; data minimization; accuracy; storage limitation; cybersecurity (integrity and confidentiality); and accountability.

NFC tags can be used to retrieve the Onboarding Payload, and they must contain the same data as specified in the QR Code Format. The NFC tag must be one of the types defined by NFC Forum and must use the NFC Data Exchange Format (NDEF) with NDEF messages as defined by NFC RTD 1.0. The Onboarding Payload for the NFC tag must use NDEF URI Record Type Definition as defined by NFC RTD URI 1.0.

The node ID associated with the temperature sensor client in the "Temp Sensor Client" example is 456789.

The CSRRequest command is generated to execute the Node Operational CSR Procedure and return the NOCSR Information in the form of a CSRResponse Command. The CSRNonce field is used in computing the NOCSR Information. If the CSRNonce is malformed, the command fails with an INVALID_COMMAND status code.

Messages are categorized as either secured or unsecured. Secured messages use the Matter message format and have mechanisms for decryption and authentication, while unsecured messages are limited to specific functions like discovery and commissioning initiation.

The purpose of section 5.4.1 is to describe the process by which a device is discovered in order to commission it onto an operational Fabric.

The SystemTimeStamp field in EventDataIB represents the system timestamp of the event occurrence, and it is optional.

The Fabric Index is derived by identifying an Operational Group Key associated with the fabric through successful decryption with that key and verification of the Message Integrity Check.

This specification addresses gaps determined by the Data Model Tiger Team, including multi-element message support, synchronized reporting, reducing message types (commands & actions), complex data type support in all messages, events, and interception attack.

The Data field has a constraint of a maximum length of 128 octets.

If no error-free existent paths remain after processing, the AttributeRequests are considered empty, and no further action is taken for those paths.

The ProductURL Attribute specifies a link to a product-specific webpage, following the syntax specified in RFC 3986. It should resolve to a maintained webpage available throughout the product's lifetime, with a maximum length of 256 ASCII characters.

The examples illustrate an Operational Intermediate CA Certificate (ICAC) both in X.509 and Matter TLV formats.

Wi-Fi commissioning utilizes Soft-AP functionality where the device acts as an Access Point (AP) that doesn’t provide Internet connectivity. Standard Wi-Fi AP advertisement and connection protocols are employed for device discovery and credential conveyance.

Example 6 describes an alarm system where a user can arm or disarm the system using voice commands from a Matter node.

If an ICA issues the NOC, the validity of the NOC is attested by the ICA certificate, and the validity of the ICA certificate is attested by the Root CA certificate associated with the issuer of the ICA certificate.

This user journey allows a user to discover new devices without providing additional information about them, which can be useful when the onboarding payload is hidden or inaccessible on a device already physically installed.

The available commands are Register Client, Register Client Response, Unregister Client, and Stay Active Request.

If this action is not part of a Timed Write transaction, it MAY be groupcast.

A "Subject" in the context of Access Control refers to the source entity for an action within the Matter ecosystem. It is authenticated using a specific authentication method provided by the Secure Channel architecture. Subjects can include passcodes, source nodes authenticated by CASE sessions, or destination groups authenticated by Operational Group Keys. Subjects play a crucial role in determining access privileges within the Access Control system.

The client should discard responses containing a Source Node ID for unintended sources and those not matching any in the Valid Proxy List.

The StartActionWithDuration command has ActionID, InvokeID, and Duration as its data fields.

The GranularityEnum data type indicates the granularity of time synchronization errors and is used to describe the level of accuracy in time synchronization.

The RevokeCommissioning command is used by a current Administrator to instruct a Node to revoke any active Open Commissioning Window or Open Basic Commissioning Window command.

The AccessControlEntryAuthModeEnum data type defines three authentication modes: PASE (Passcode authenticated session), CASE (Certificate authenticated session), and Group (Group authenticated session).

The context-specific tag signature [11] is used to identify the signature field in the Matter certificate structure.

Read, write, invoke, fabric-scoped, and fabric-sensitive. Elements inherit privileges from the next highest element.

Status code 0x7F signifies that the endpoint indicated is unsupported on the node.

When this feature is supported, the device is required to support all associated commands and attributes necessary for proper implementation of the Check-In Protocol.

The TLV Type for AttributePathIB is List.

The RadioFaultChange event indicates a change in the set of radio faults currently detected by the Node.

The Path field in EventDataIB must not have an IsUrgent field present.

The ID of the command is 0x00, and its name is ResetCounts.

By delegating all subscriptions to the proxy, it reduces energy and memory demands on the source device.

Persistence of subscription details across reboots is not necessary, but an implementation may choose to do so.

The receiver does not know the sender’s last message counter in three scenarios: when the encrypted message is the first received from a peer, when the device rebooted without persisting the Group Peer State Table content, and when the entry for the peer in the Group Peer State Table was expunged due to the table being full.

The ClusterRevision attribute indicates the revision of the server cluster specification supported by the cluster instance.

The Path field in EventStatusIB must indicate a concrete path.

The OID for the matter-oid-vid attribute type is 1.3.6.1.4.1.3724, and it allows UTF8String and PrintableString types in X.509 certificates.

The AddNOC command automatically creates an Access Control Entry granting Administer privilege for the entire Node to the appropriate CASE authenticated Subject.

In the PASE protocol, the passcode is used as the password in the Password-Based Key Derivation Function (PBKDF) to generate shared keys.

Commissioners and Administrators SHOULD carefully control which Nodes get Administer, Manage, or Operate privilege, especially for safety-critical systems like Door Locks and Smoke CO Alarms. [CM244 for T17, T20, T59, T94, T230]

Matter serves as the unified standard for connected objects, providing a single development path to a large market, ensuring more reliable user experiences, and allowing developers to focus on innovation and increase return on investment (ROI).

The algorithm used in the subjectPublicKeyInfo field of the PAA certificate is the object identifier for prime256v1.

More information about the assigned UUID can be found at https://www.bluetooth.com/specifications/assigned-numbers/16-bit-uuids-for-sdos.

Protection against physical attacks (especially those that impact cybersecurity) MAY be needed for some Devices, as determined by the manufacturer. [CM62 for T60]

No, the SupportedCalendarTypes attribute cannot contain duplicate entries.

The BlockQuery message is sent by the driving Receiver to request the next block of data. It implies a BlockAck of the previous block if no BlockAck was explicitly sent.

If the verification fails (Success = FALSE), the initiator sends a status report indicating the failure and performs no further processing.

The TxOtherCount attribute indicates the total number of unique MAC frame transmission requests that are not counted by any other attribute.

The contents of the issuer field in the DAC are: CN = Matter Test PAI, 1.3.6.1.4.1.37244.2.1 = FFF1, 1.3.6.1.4.1.37244.2.2 = 8000.

The subject field of the DAC is: CN = Matter Test DAC 0001 Mvid:FFF1 Mpid:8000.

The Block message serves as the container for the actual bulk transfer data. It is sent in ascending and sequential block counter order and can have a payload length that does not exactly match the negotiated max block size.

1. The current Administrator tells the Node(s) to start commissioning with a new passcode and receives confirmation. If some Nodes are asleep, the Administrator can prompt the user to wake them up. 2. The Administrator presents the Onboarding Payload. 3. The new Administrator completes the commissioning process within a set time using the provided information.

It indicates the nominal voltage expected to be provided by the hard-wired source, in mV (millivolts).

The Exchange Layer tracks related messages to facilitate small, discrete transactions and provides a means to multiplex multiple concurrent transactions over a given session. It also integrates the Message Reliability Protocol (MRP) for reliability over UDP transports.

Zigbee Cluster Library

Implementations should avoid decreasing the TargetsPerAccessControlEntry attribute over time to prevent invalidating ACL entries already written. It's recommended to only use the minimum value required and avoid reporting a higher value than necessary.

The 'ConnectNetwork' command attempts to connect to a network using the specified network interface.

Some constraints for OTA Software Image transfer using the BDX protocol include the use of Receiver-Drive mode, Asynchronous mode, and specific block size constraints (Section OTA Software Image transfer examples).

The Sequence Value indicates an action involving a sequence of events or states of associated endpoints, such as a wake-up experience.

The responder validates the incoming destinationId by traversing all its installed Node Operational Certificates (NOCs) to gather associated trusted roots' public keys. It then generates a candidateDestinationId for each tuple of <Root Public Key, Fabric ID, Node ID>. The responder verifies that the incoming destinationId matches one of the candidateDestinationIds. If there's no match, it sends a failure status report; otherwise, it records the associated trusted root, Fabric ID, Node ID, and IPK for subsequent use.

Hexadecimal numbers are prefixed with "0x" and binary numbers with "0b". Binary numbers are grouped in 4-bit groups, separated by a space, e.g., 0b0000 1111 represents the decimal number 15.

Credentials required to generate operational group keys are accessible only to Nodes with a certain level of privilege, typically those considered members of the group. Access to these credentials is restricted to prevent unauthorized access, ensuring that only trusted Nodes can obtain the keys. Access to shared keys is designed to be computationally infeasible for non-trusted parties, barring software errors or compromise of a privileged Node.

SuppressResponse may be set to TRUE for a Report Data action that initiates a Report transaction conveying an empty list of AttributeReports and EventReports. Otherwise, it shall be set to TRUE for a Report Data action that is part of a Read transaction and set to FALSE for a Report Data action that is part of a Subscribe transaction.

It is derived from enum8.

BTP Clients must perform certain GATT operations synchronously, including GATT discovery, subscribe, and unsubscribe operations. GATT discovery, subscribe, or unsubscribe must not be initiated while the result of a previous operation remains outstanding.

The overridden element requirements for the On/Off Light device are: - Identify Command TriggerEffect - Scenes Command EnhancedAd dScene - Scenes Command EnhancedViewScene - Scenes Command CopyScene - On/Off Feature - Level Control Feature - Level Control Attribute CurrentLevel - Level Control Attribute MinLevel - Level Control Attribute MaxLevel

The EnableKey field is a 128-bit value provided by the client to match a value chosen by the manufacturer and configured on the server using manufacturer-specific means.

A QR Code is a machine-readable optical label that encodes information about the item it is attached to, facilitating easy access to this information.

In Example 6, the user can disarm the alarm system by using the DisableAction command, or they can temporarily disarm it for a period using the DisableActionWithDuration command.

Matter uses GitHub issues for problem descriptions or feature requests. All work contributed to the repository in the form of pull requests (PR) should be under the auspices of some open issue. Issues also help form an important basis for release notes.

Request paths may undergo expansion to generate a list of existent paths, potentially replacing wildcard paths with complete lists of existent paths, as detailed in this section.

Concrete paths signify individual element instances, such as events, commands, attributes, struct fields, or list entries, as described in this section.

Matter acts as the IoT compatibility standard and mark, driving category growth, streamlining the purchasing process, enhancing consumer confidence and experiences, and reducing training and operational expenses.

DeltaSystemTimestamp is present when delta encoding the System timestamp relative to a prior event in a given stream of events.

If HasPBKDFParameters is set to True, the responder does not return the PBKDF parameters.

After successful verification, the initiator sets the Resumption ID in the Session Context to the value of TBEData2.resumptionID.

A NOC can be renewed by an Administrator with Administer privileges on the Node to be updated by sending a CSRRequest Command.

Threat T180: Attacker accesses Observer Node or Validator Node with unauthenticated READ CLI protocol. [CM163, CM166]

Structure types are encoded using the TLV structure type.

The Extension attribute allows Administrators to store arbitrary data related to fabric's Access Control Entries.

- URL without query string: https://company.example/matter/flow/vFFF1p1234 - URL with basic query scheme: https://company.example/matter/flow?vid=FFF1&pid=1234 - URL with MTop=_ for QR code: https://company.example/matter/flow?vid=FFF1&pid=1234&MTop=_

EventDataElement = { Path = [[ Endpoint = 10, Cluster = Disco Ball, EventID = Started ]], EventNumber = 1001, Priority = INFO, EpochTimestamp = 102340234293, Data = { /* Event-specific data */ } }

Examples of conditions that will result in a CONSTRAINT_ERROR include: an invalid Privilege enum value, an invalid AuthMode enum value, using PASE AuthMode (reserved for future use), having an invalid Subjects element (e.g., illegal CAT with CASE AuthMode), having an invalid Targets element (e.g., no field present, both Endpoint and DeviceType fields present), and having invalid field combinations (e.g., Administer Privilege with Group AuthMode).

Nodes SHALL stop both commissioning and unsecured rendezvous actions after a specified time period from the beginning of the commissioning mode when commissioning has not been concluded.

The Actions Cluster provides a standardized way for a Node, typically a Bridge, to expose information about logical grouping of endpoints, named actions that can be performed on such groups of endpoints, commands to trigger these actions, and events to receive feedback on the state of these actions.

Cluster classification defines a cluster as either a utility cluster or an application cluster.

Matter software discovering other instances should not expect any IPv4 addresses included in responses, optimizing the content of service discovery messages.

Crypto_TRNG() may follow NIST 800-90B implementation guidelines, but alternate implementations are also permitted.

Matter Nodes configure a link-local IPv6 address and support configuration of at least three routable IPv6 addresses.

Existent paths are concrete paths indicating single, existing instances on specified nodes, as distinguished in this section.

The Vendor Schema provides contact information associated with the vendor, such as Company legal name, preferred brand name, company landing page URL, etc.

Matter's development process is open and transparent, with the GitHub repository containing implementations of security foundations, message framing, interaction model, and data model, supporting multiple transports like Wi-Fi and Thread.

The Application layer handles the high-order business logic of a device, such as turning a light bulb on/off and adjusting its color characteristics.

No, Matter does not specify how firmware images are signed, and the implementation of firmware image signing is manufacturer-specific. However, the Matter TLV certificates have affordances for encoding firmware signing certificates.

The OTA Requestor should use the ApplyUpdateRequest command to proceed with applying a software update (Section UpdateToken usage).

The 'EndpointList' attribute indicates a list of endpoints powered by the source defined by this cluster.

The Local Message Counter is the Secure Session Message Counter for outbound messages, which is initialized at successful session establishment and used to track the sequence of messages sent by the local node.

The LatestValue field represents the latest value of the changed extension.

Scan all allowed 2.4 GHz Wi-Fi channels, prioritizing channels 1, 6, and 11.

The PatternRequest command is used to invoke patterns for operating the disco ball.

In multi-fabric settings, proxies should ideally be commissioned into all fabrics containing sources needing proxying to ensure proper functionality.

In the Key Usage extension, both the Certificate Sign and CRL Sign bits are set, indicating that the certificate can be used for signing certificates and CRLs.

Where practical, the setup code SHOULD NOT be photograph-able or visible when installed (e.g., QR code hidden with a flap). [CM89 for T90]

Matter supports local communications spanning one or more IPv6 subnets, including Wi-Fi/Ethernet subnets or low power and lossy networks (LLN) subnets, with Thread as the supported LLN standard.

Both can have a finite count from 0 to 65534.

Access Control Entries (ACEs) within an ACL codify the access policy for a Node. They specify the privilege level granted to a Subject (entity) for interacting with specific Targets (Endpoint Clusters) on that Node. ACEs contain information such as the FabricIndex scoping, Privilege level (e.g., View, Operate, Manage, Administer), target Clusters, source Subjects, and Authentication Mode, enabling fine-grained access control.

Matter uses a common application layer and data model to deliver interoperability, enabling devices to communicate across multiple IP network technologies.

Interactions with these attributes/events/commands on the Matter side, towards a Controller using the sensor/switch data, SHOULD be identical to interactions with corresponding attributes/events/commands in native Matter sensors and switches, such as attribute readout, subscription, proxying, and eventing.

The payload of the Pake1 message follows the pake-1-struct TLV schema.

DeltaEpochTimestamp is present when delta encoding the UTC timestamp relative to a prior event in a given stream of events.

The Subscribe Request Action includes parameters such as KeepSubscriptions, MinIntervalFloor, MaxIntervalCeiling, AttributeRequests, DataVersionFilters, EventRequests, EventFilters, and FabricFiltered.

If the RemoveNetwork command is received without an armed fail-safe context, then this command shall fail with a FAILSAFE_REQUIRED status code sent back to the initiator.

It indicates the estimated time in seconds before the battery will no longer be able to provide power.

Implementation-specific rules of Access Control should be carefully considered, if applied at all, especially regarding the constraint on incoming session establishment requests. For example, a Node may deny CASE session establishment from an initiator whose identity doesn't match any Access Control Entry. Such rules must balance security requirements with usability and interoperability concerns to avoid incorrectly rejecting valid connections, which could render a Node unreachable.

Conversion involves adjusting the NTP seconds part from the NTP epoch to the Epoch Time epoch and calculating microseconds precision using the most significant 32 bits of the NTP fractional seconds portion.

Either an IPv4 or IPv6 address, with specific octet correspondences for each.

The DataFileSize field is included if it indicates the total size in bytes of the file found at the DataUrl, except when the RevocationType is 1, referring to a type with built-in signatures.

The subject field must be a sequence of RelativeDistinguishedNames. It must have exactly one VendorID value present, and the VendorID value in the subject field must match the one in the issuer field. It must also have exactly one ProductID value present, and if a ProductID value was present in the issuer field, it must match the one in the subject field.

It is of type uint32.

Threat T5: IoT device advertises information that can be used to identify vulnerabilities. [CM6, CM7, CM8]

Chunking involves splitting an Action, such as ReportData and WriteRequest actions, into multiple messages at logical boundaries due to IPv6 UDP packet size limitations.

Administrators can iterate over the list of elements in the Data field and interpret selected elements at their discretion. However, the specific content of each element is not specified and may vary between manufacturers.

The Duration field specifies the duration for which the action or automation will remain disabled before automatically re-starting, changing the action’s state back to either Inactive or Active, depending on the action.

The Message Length field, an optional unsigned integer value, specifies the overall length of the message in bytes, excluding the size of the Message Length field itself. It is present only when the message is transmitted over a stream-oriented channel like TCP. For example, when transmitted over UDP, the payload length of the UDP packet determines the message length.

If a device already has network connectivity (over Wi-Fi, Ethernet, or otherwise) a Commissioner may discover such a device using DNS-based Service Discovery (DNS-SD), conveying credentials to the device over IP.

Used to limit time for critical actions and prevent timing attacks. Requires timed interaction for certain actions.

The 'AddOrUpdateThreadNetwork' command requires SSID, Credentials, and Breadcrumb fields.

Commissioners and Administrators should validate firmware information by referring to canonical databases like the Distributed Compliance Ledger to ensure that the reported firmware information matches what is expected for an authorized Software Image associated with a given Certification Declaration.

The Node tag may be omitted if the target node of the path matches the NodeID of the server involved in the interaction.

A node must guarantee at least four Access Control Entries for every fabric supported, with additional constraints possible based on device types.

Installing a group onto a newly commissioned Node involves several sequential steps to ensure the seamless integration of the Node into the group communication network. The process begins with the Administrator generating a fabric-unique group ID (GID) and a random key (key0) for the group key set ID (K). Subsequently, the Administrator writes the group key set (K) to the remote Node, known as the GroupMember, using the KeySetWrite command. Additionally, the Administrator associates the group ID (GID) with the key set (K) by writing an entry to the GroupKeyMap list attribute. Once the key material is distributed and associated with the Node, the Node subscribes to the IPv6 multicast address generated from the fabric ID and group ID. Finally, the Administrator associates the endpoint with the group ID (GID) by sending the AddGroup command to the endpoint. This process ensures that the newly commissioned Node has access to the necessary key material and is seamlessly integrated into the group communication network, enabling secure communication with other group members.

If the publisher receives a Status Response action with a status code other than SUCCESS in response to a Report Data action, the publisher shall terminate the Subscribe interaction.

Devices have a verified boot based on an immutable root of trust to verify the authenticity of firmware.

The purpose of the BDX Session is to facilitate a series of messages passed between a Sender and Receiver for a bulk data transfer, beginning with transfer negotiation and ending with acknowledgment of all transmitted data.

The Basic Constraint extension is marked critical with CA:TRUE, and the 'pathLen' field is set to 1.

The ASN.1 OID base for the domain-component attribute in a Matter certificate is itu_t(0) data(9) pss(2342) ucl(19200300) pilot(100) pilotAttribute-Type(1) domainComponent(25).

Crypto_Hash() computes the cryptographic hash of a message, returning the hash digest using SHA-256 as defined in FIPS 180-4.

Factory reset removes all local data and key material created during or after commissioning except data explicitly required to persist across resets.

The salt is a random value per device, with a length of at least 16 bytes and at most 32 bytes, used as the PBKDF2 salt to ensure unique key derivation for each device.

The Exchange ID field is an unsigned integer value identifying the exchange to which the message belongs. It is allocated by the initiator of the exchange and is unique within the initiator exchange number space, as specified in Section 4.9.2, "Exchange ID."

1. Initialize IsRevoked to FALSE. 2. Obtain the correct RevocationSet by indexing the RevocationDataSet. 3. If no matching RevocationSet is found, return immediately. 4. Determine if the serialNumber is a member of the set. If it is, set IsRevoked to TRUE.

The two situations described are regional roll-out of software images and roll-out of non-standard software images (Sections 11.19.5.1 and 11.19.5.2).

Sends the AttestationNonce to the Commissionee and requests Attestation Information using AttestationRequest.

An Administrator adds an Access Control Entry to grant Manage privilege, for endpoints 1 and 3, to any Nodes which can authenticate as members of Group 1.

Status code 0x89 indicates that an action or operation failed due to insufficient available resources.

The CSRRequest command fails if the CSRNonce is malformed or if the IsForUpdateNOC field is set to true and the command is received over a PASE session.

The AdminPasscodeID field represents the Passcode ID of the Administrator that made the change, if the change occurred via a PASE session.

The Destination Identifier field allows the initiator to express specific details such as the shared Trusted Root, Fabric ID, and Node ID in a privacy-preserving manner.

The conceptual fields of a certificate include Version Number, Serial Number, Signature Algorithm ID, Issuer Name, Validity period (Not Before, Not After), Subject Name, Subject Public Key Info (Public Key Algorithm, Subject Public Key), Issuer Unique Identifier, Subject Unique Identifier, and Extensions.

Generating a random 32-byte attestation nonce using Crypto_DRBG().

Matter aims to build a universal IPv6-based communication protocol for smart home devices, focusing on interoperability and deploying an application layer on these devices.

Wildcarding is achieved by omission of the respective tag.

It represents the common type AA battery.

The BlockQueryWithSkip message allows a driving Receiver to request the next block of data after skipping forward within the stream. This message specifies an amount to skip forward (BytesToSkip) and is used to seek forward in BDX transfers without terminating and re-opening a new transfer.

Upon receiving the Identification Declaration message, the Commissioner MAY query the DNS-SD service instance indicated in the message, including TXT records, to obtain additional information about the Commissionee.

Subscriptions provide a 'sync' message to infer health, conveyed through status codes like 'NO_UPSTREAM_SUBSCRIPTION'.

A GATT client unsubscribes from characteristic C2 to close a BTP session.

A Group Session ID is a specialized identifier used for group communication, specifically to identify probable operational group keys across a Fabric. When the Session Type is set to 1, indicating a group session, the Session ID is defined as a Group Session ID. It serves as a means for efficiently locating the Operational Group Key used to encrypt an incoming groupcast message. The Group Session ID is derived by treating the output of a key derivation function (Crypto_KDF) against the associated Operational Group Key as a big-endian representation of a 16-bit integer. This derivation process ensures that each Operational Group Key generates a unique Group Session ID, facilitating the identification of the appropriate encryption key during message processing.

The 'Revision History' section provides a description of revisions made to the Network Commissioning Cluster.

Upon initializing the new PASE Session Keys, the Node initializes its Local Message Counter and the Message Reception State in the Session Context, setting the synchronized max_message_counter of the peer to 0.

An endpoint should conform to all device types listed in the DeviceTypeList attribute, supporting shared cluster instances for clusters common to multiple device types.

Sample code is provided in the specification to convert temperatures between Fahrenheit (in a half degF format for 0.5°F resolution) and Celsius (in a format with 0.01°C resolution), ensuring consistent conversion across devices.

Operational group key under GroupKeySetID of 0 for the fabric associated with the originator’s chosen destination. Exclusive use for Certificate Authenticated Session Establishment. Not for operational group communication.

The Bridged Device Basic Information Cluster serves two purposes: to indicate that the functionality on the Endpoint where it is placed (and its Parts) is bridged from a non-Matter technology, and to provide a centralized collection of attributes that the Node MAY collect to convey information regarding the Bridged Device to a user, such as vendor name, model name, or user-assigned name.

The SuppressResponse flag in InvokeResponseMessage indicates whether the response should be suppressed.

The Constraint field specifies the constraints or requirements for the Binding attribute.

The StatsRequest command generates a StatsResponse command.

Examples of "User Consent" include triggering a notification to an interactive application user interface and relaying a previously stored consent signal (Section 11.19.3.4).

After obtaining the outgoing message counter, it is incremented by 1.

Battery-powered Devices SHOULD respond to excessive queries by rate limiting (even limiting the rate to zero if desired). [CM51 for T52, T53]

The 'EndpointList' attribute indicates a list of endpoints powered by the source defined by this cluster. In this context, it could specify the endpoints powered by mains power and battery power for proper operation.

Recommendations include configuring the editor to format on save, enabling the clang-format extension, and exploring additional settings and customization options.

The LocalTime attribute represents the computed current local time of the node, considering the UTC time, time zone offset, and daylight savings time offset.

If there are no available session identifiers, the Node terminates an existing session to free a session identifier.

The purpose is to abstract interactions from other layers, including security, transport, message format, and encoding.

The CertificateChainResponse command is generated in response to a CertificateChainRequest command.

A reliable message is transmitted at most MRP_MAX_TRANSMISSIONS times until an acknowledgment of receipt is received from the peer or a timeout occurs.

Active Mode is when the ICD is reachable on the network and responds promptly. The device remains in Active Mode for at least an Active Mode Interval. During Active Mode, the ICD configures its network interface for Fast Polling.

Defined in Section 4.16.2, “Group Peer State”.

The TimedRequest field flags the action as part of a timed invoke transaction.

AttributeDataIB = { DataVersion = 1, Path = [[ Endpoint = 10, Cluster = Disco Ball, FieldID = Axis ]], Data = 90 }

FIPS 186-4: NIST FIPS 186-4 Digital Signature Standard (DSS), outlining the federal standards for digital signatures. July 2013. URL: https://csrc.nist.gov/publications/detail/fips/186/4/final

FIPS 197: NIST FIPS 197 Advanced Encryption Standard (AES), setting the standards for AES encryption. November 2001. URL: https://doi.org/10.6028/NIST.FIPS.197

FIPS 198-1: NIST FIPS 198-1 The Keyed-Hash Message Authentication Code (HMAC), detailing the standards for HMAC. July 2008. URL: https://csrc.nist.gov/publications/detail/fips/198/1/final

IANA Time Zone Database: Provides a comprehensive database for time zone differences worldwide. URL: https://www.iana.org/time-zones

IEC 60086: IEC 60086 standard for Primary Batteries, specifies requirements for primary batteries. URL: https://www.iec.ch

IEEE 754-2019: "IEEE Standard for Floating-Point Arithmetic," in IEEE Std 754-2019, revises the IEEE floating-point arithmetic standards. July 2019. URL: https://ieeexplore.ieee.org/document/8766229

IEEE 802.11-2020: IEEE 802.11-2020 - IEEE Standard for Information Technology - Telecommunications and Information Exchange between Systems - Local and Metropolitan Area Networks - Specific Requirements - Part 11: Wireless LAN Medium Access Control (MAC) and Physical Layer (PHY) Specifications. URL: https://standards.ieee.org/standard/802_11-2020.html

IEEE 1588-2008: IEEE Standard for a Precision Clock Synchronization Protocol for Networked Measurement and Control Systems. URL: https://standards.ieee.org/standard/1588-2008.html

ISO 639: Language Codes, provides standardized codes for the representation of languages. URL: https://www.iso.org/iso-639-language-codes.html

ISO/IEC 18004:2015: Information technology - Automatic identification and data capture techniques - QR Code bar code symbology specification. URL: https://www.iso.org/standard/62021.html

ITU ASN.1: ITU ASN.1 Project, defines the Abstract Syntax Notation One (ASN.1) which is a standard way to encode data for communication between systems. URL: https://www.itu.int/en/ITU-T/asn1/Pages/asn1_project.aspx


The DayOfWeek field represents days of the week from Monday (1) to Sunday (7).

There are no VendorID values present in the issuer field of the PAI certificate.

DNS-SD records for a Matter Commissioner are set up using commands such as dns-sd -R or avahi-publish-service. The example includes a device on Wi-Fi with the host name represented by its 48-bit device MAC address. The records include the instance name, service type, port number, and optional information such as Vendor ID, Product ID, device type, and device name.

If the proxy cannot view the source’s Access Control Cluster due to insufficient privileges, it does not generate downstream subscription data reports. Instead, it generates a report containing UNSUPPORTED_ACCESS errors for each path in the downstream subscription and tears down the subscription.

nan

The UpdateToken is used to track deferred OTA application or otherwise allow short-term tracking of OTA Requestors (Section UpdateToken usage).

Threat T81: Attacker uses predictable Initialization Vectors to derive crypto keys. [CM78]

Implementations should avoid decreasing the AccessControlEntriesPerFabric attribute over time to prevent invalidating ACL entries already written. It's recommended to only use the minimum value required and avoid reporting a higher value than necessary.

A dynamic device type supports intelligent and supervisory services, such as commissioning, monitoring, trend analysis, scheduling, and central management.

Devices implement Perfect Forward Secrecy key agreement protocols to ensure that session keys will not be compromised even if long-term secrets used in the session key exchange are compromised.

The RxBeaconRequestCount attribute indicates the total number of received unique MAC Beacon Request frames.

There shall be at least 2 entries per supported fabric for Peer Encrypted Group Control Message Status in the Group Peer State table.

There shall be at least 10 entries per supported fabric for Peer Encrypted Group Data Message Status in the Group Peer State table.

DotdotArch: Dotdot Architecture Model, provides a comprehensive model for the Dotdot architecture, facilitating interoperability among devices. Revision 14, February 2019. URL: https://groups.csa-iot.org/wg/matter-tsg/document/18649

ZCL: Zigbee Cluster Library Specification, outlines the specifications for the Zigbee Cluster Library, which defines the standards for Zigbee device interactions. Revision 8, December 2019. URL: https://groups.csa-iot.org/wg/members-all/document/23019

CSA-PNP: Organizational Processes and Procedures, document detailing the processes and procedures for organizational management within the CSA. Revision 8, November 2021. URL: https://groups.csa-iot.org/wg/members/document/21624

The ID of the Binding attribute is 0x0000.

The Subject Key Identifier (SKI) extension value of the PAA certificate, which is the root of trust of the DAC, should be present as one of the values in the authorized_paa_list field.

The star network topology consists of a central hub network (typically the customer’s home Wi-Fi/Ethernet network) and multiple peripheral networks connected via Border Routers.

The NumHopsToSource field indicates the number of hops to the source for which the proxy is subscribed, with sensible values starting at 1.

The GroupKeySetIDs field in the KeySetReadAllIndicesResponse command references the set of group keys that generate operational group keys for use with the accessing fabric.

The ID of the cluster is 0x0038, and its name is Time Sync.

The validation of firmware authenticity and integrity is described in Section 11.19.4.2, “Image Verification”.

The Key field represents the shared secret between the ICD and the registered client and is used in the encryption of the Check-In payload sent to the registered client.

The Path field in EventDataIB must indicate an existent path.

The Matter Core Specification can be found at https://github.com/CHIP-Specifications/connected-homeip-spec/raw/build-sample/pdf/main.pdf.

The rules for sending the MRP Standalone Acknowledgement message are detailed in Section 4.11.5.2.2, "Standalone acknowledgement processing" in MRP.

The ParentChangeCount attribute indicates the number of times a Node has changed its parent.

IP network, BLE, and preferably Wi-Fi Soft-AP.

The Outgoing Subscribe Request Action initiates the Subscribe Interaction.

The Compressed Fabric Identifier serves as part of the salt value used in the key derivation process for operational group keys. It ensures that the resulting operational group keys are unique and specific to the Fabric in which they are derived. By incorporating the Fabric Identifier into the derivation process, operational group keys are tailored to the security context of the Fabric, enhancing security and preventing key reuse across different Fabrics.

The RxOnWhenIdle field specifies if the neighboring node is capable of receiving frames while in an idle state.

Serial numbers in Matter certificates should not exceed 20 octets in length, adhering to the same limitation as specified in [RFC 5280].

A list of one or more Product Attestation Authority (PAA) identified by the Subject Key Identifier (SKI) extension value of its certificate, which is authorized to sign the PAI Certificate for a product carrying this Certification Declaration.

An Administrator adds an Access Control Entry to grant View privilege, for the entire Node, to all CASE authenticated Nodes.

Upon receiving a BTP handshake request from the BTP Client and confirming the client’s subscription to C2, the BTP Server sends a BTP handshake response to the client via a ATT_HANDLE_VALUE_IND PDU on C2. This response contains the window size, maximum BTP packet size, and BTP protocol version selected by the server.

The EventMin field in EventFilterIB specifies the minimum event number to filter events.

Interactions are described as sequences of transactions in this part of the specification.

The primary network interface of a Node should be the one present on the root node endpoint.

The responder generates a new resumption ID using Crypto_DRBG with a length of 128 bits.

The Status Report message encapsulates the result of an operation and is sent as a reply for requests from an initiator.

Defined in Section 2.11.1.2, “Group Limits”.

Fabric-filtered list entries are in the same order as the full list and indexed from 0 with no gaps, as if the other entries did not exist.

Eviction of existing proxies is prohibited to prevent system instability, which could occur due to proxies ping-ponging subscriptions to a source.

In Matter TLV format, the ICAC certificate is represented as a structured sequence of TLV-encoded fields, including serial number, signature algorithm, issuer and subject information, public key details, extensions such as Basic Constraints, Key Usage, Subject Key Identifier, Authority Key Identifier, and the signature.

The QR code format includes a prefix string "MT:" followed by a Base-38-encoded string containing the required and optional TLV content.

Matter: Service Discovery, HomeKit: Service directory, Weave: Service Discovery, Thread: (Not Applicable), Zigbee: (Not Applicable)

The lifetime of operational group keys is managed by assigning an expiration time to each epoch key in a given group key set. By limiting the validity of epoch keys to specific epochs, the duration for which members can derive and operate with operational group keys is constrained. Epoch keys may be rotated periodically, and denying access to updated versions of these keys serves as a mechanism to eject group members. This approach allows for the enforcement of access control and facilitates the periodic renewal of keys to maintain security within the operational group.

A Vendor is the organization that manufactures a Device, responsible for its production and initial software.

The 'AddOrUpdateThreadNetwork' command is used to add or modify Thread network configurations.

The signature algorithm used in the PAA certificate is ecdsa-with-SHA256.

- The VendorID value from the subject DN in the DAC should match the vendor_id field. - The VendorID value from the subject DN in the PAI should match the vendor_id field. - The ProductID value from the subject DN in the DAC should be present in the product_id_array field. - The ProductID value from the subject DN in the PAI, if present, should match one of the values present in the product_id_array field.

The Vendor ID associated with the Certification Declaration.

The Level Control cluster SHALL allow controlling the pump setpoints. However, the transition time is always ignored. The setpoint of the pump is a percentage related to the level.

Commissioners and Administrators should avoid configuring Nodes in ways where it may be ambiguous to end-users which final network configuration will take place.

The Rotate attribute indicates the direction of rotation, either clockwise or counterclockwise.

The arguments for the 'ScanNetworks' command include SSID and Breadcrumb fields.

BTP_ACK_TIMEOUT is the maximum amount of time after receipt of a segment before a stand-alone ACK must be sent. Default: 15 seconds.

More details about the DCL ledger can be found at [https://github.com/zigbee-alliance/distributed-compliance-ledger/blob/master/docs/DCL-Overview.pdf].

It is a CMS (RFC5652)-encoded single-signature envelope whose message is a TLV-encoded certification-elements structure with an anonymous tag.

The key elements of SubscribeResponseMessage include SubscriptionID and MaxInterval, conveying subscription parameters to the client.

CommandDataIB is a TLV structure used to encapsulate the arguments or parameters for a command request or response.

The RotationTime field specifies the interval of time, in hours, for Thread security key rotation.

Additional RDN attributes such as common-name and CASE Authenticated Tags (matter-noc-cat) can be included.

A struct extended with new fields must maintain the same definition in all instances of that struct within a given cluster definition, ensuring consistency across the extended cluster.

The MRP_BACKOFF_THRESHOLD parameter creates a two-phase scheme which begins with linear backoff and then transitions to exponential backoff to provide convergence when the network is congested.

Duplicate messages are handled as follows: a. If the message is marked as encrypted, the appropriate section for encrypted messages is followed. b. If the message is marked as unencrypted, the appropriate section for unencrypted messages is followed. c. If the message is encrypted and marked as a duplicate, i.e. Message Counter is outside the valid message counter window or marked as previously received in the Message Reception State, Section 4.11.5.2, “Reliable Message Processing of Incoming Messages” is performed on the duplicate message. d. Otherwise, the Message Reception State is updated as detailed in Section 4.5.4.1, “Message Reception State”, and the message is accepted for further processing.

A PID is a 16-bit number assigned by the vendor that uniquely identifies a product. It must be unique for each product within a Vendor ID and should not be reused for different product types under the same Vendor ID.

A Commissionable Node is a Node that can be commissioned. It may require specific actions, like a button press, to enter Commissioning Mode, allowing it to undergo the Commissioning process.

Each Matter device is issued an Operational Node ID and a Node Operational Certificate (NOC), which cryptographically binds the device's identity within the Fabric.

The List and String Constraint section defines constraints for lists and strings, specifying the minimum and maximum number of entries or size of strings supported.

It is emphasized that the examples are for illustrative purposes only and that real Matter Nodes and controllers would not use command-line test tools for advertising and discovery. Instead, they would utilize the appropriate DNS‐SD APIs in their chosen programming languages.

The specification defines secure session establishment protocols (CASE and PASE), group communication, a bulk data transfer protocol (BDX), and provisions for defining manufacturer-specific protocols.

The EventTrigger field indicates the test or test mode which the client wants to trigger.

The signature included in a Matter certificate is the signatureValue of the corresponding X.509 certificate, not a signature of the preceding Matter TLV data in the Matter certificate structure.

A Certification Declaration is a digitally signed token that indicates the certification status of a vendor's certified device, conveying its compliance and authenticity.

The random initializer ranges from 1 to 2^28 in order to maximize initial entropy while still reserving the vast majority of the range to actual counter values.

Administrators can view the set of Fabrics on each Device, including attributes for the Node Operational Credentials Cluster.

Each endpoint supporting the Root Node device type must include specific clusters, such as Basic Information Server, Access Control Server, Power Source Configuration, Time Synchronization, Group Key Management, General Commissioning, Network Commissioning, Administrator Commissioning, and others.

Control Flags in BTP Frame specify various parameters such as Handshake, Management Message, Acknowledgement, Ending Segment, Continuing Segment, and Beginning Segment. They control the behavior and structure of BTP packets.

VendorID and ProductID substrings are encoded within the commonName attribute using the specified format, allowing them to be provided anywhere within the commonName value.

Commissioning is the sequence of operations to integrate a Node into a Fabric by assigning an Operational Node ID and Node Operational credentials, ensuring secure and authenticated communication within the network.

Matter's SPAKE2+ implementation is based on the NIST P-256 elliptic curve, ensuring secure cryptographic operations.

The EventPathIB defines paths for events, specifying the node, endpoint, cluster, and event(s) requested.

The MSG_COUNTER_SYNC_TIMEOUT constant defines the maximum amount of time (in milliseconds) that a Node shall wait for a MsgCounterSyncRsp after sending a MsgCounterSyncReq.

The following general status codes are defined: SUCCESS (0): Operation completed successfully. FAILURE (1): Generic failure, additional details may be included in the protocol specific status. BAD_PRECONDITION (2): Operation was rejected by the system because the system is in an invalid state. OUT_OF_RANGE (3): A value was out of a required range. BAD_REQUEST (4): A request was unrecognized or malformed. UNSUPPORTED (5): An unrecognized or unsupported request was received. UNEXPECTED (6): A request was not expected at this time. RESOURCE_EXHAUSTED (7): Insufficient resources to process the given request. BUSY (8): Device is busy and cannot handle this request at this time. TIMEOUT (9): A timeout occurred. CONTINUE (10): Context-specific signal to proceed. ABORTED (11): Failure, may be due to a concurrency error. INVALID_ARGUMENT (12): An invalid/unsupported argument was provided. NOT_FOUND (13): Some requested entity was not found. ALREADY_EXISTS (14): The sender attempted to create something that already exists. PERMISSION_DENIED (15): The sender does not have sufficient permissions to execute the requested operations. DATA_LOSS (16): Unrecoverable data loss or corruption has occurred. If none of the specific codes above fits for application usage, a protocol SHALL use FAILURE and provide more information encoded in the ProtocolId and ProtocolCode subfields.

Tag Rules specify the order in which context tags should be emitted to reduce receiver side complexity.

The hierarchy role of the Super Disco Ball cluster is Application Endpoint.

After initialization, the responder encodes and sends SigmaFinished to indicate the completion of the handshake.

The NetworkInterface Type structure describes a network interface supported by the Node, providing information such as the interface name, operational status, hardware address, IP addresses, and interface type.

The VendorID field is used by an OTA Provider to determine if a Node is the intended recipient of the OTA software update file.

Upon message arrival, the message reception state is queried to determine if the message is new or a duplicate. If new, the state is updated to reflect the arrival of the message. If the arriving message counter is greater than the current maximum counter for that peer, the maximum counter value is updated and the bitmap is shifted accordingly.

The contents of the Data field consist of a top-level anonymous list, with each list element including a profile-specific tag encoded in fully-qualified form.

The Group Key Management Cluster supports the CacheAndSync feature, enabling support for CacheAndSync security policy and MCSP.

It can be either a 48-bit IEEE MAC Address or a 64-bit IEEE MAC Address, in Big-Endian order.

The DataDigest field contains the digest of the entire contents of the associated file downloaded from the DataUrl, encoded in base64 string representation, if present.

The operational states are Idle Mode and Active Mode.

The Bitmap data type is used to represent simple cluster settings or state treated as a whole. It may be used to support up to 8, 16, 32, or 64 boolean values, with reserved bits for future growth.

Answer

AttestationElements field of AttestationResponse and AttestationSignature field of AttestationResponse.

The Location Attribute represents an ISO 3166-1 alpha-2 code indicating the country, dependent territory, or special area where the Node is located. This attribute influences regulatory aspects, such as radio transmission power levels, and may be set during initial commissioning or later reconfigurations.

Each path indicated by the Report Data action must be a Concrete Path. Upon receipt of a Read Request action or Subscribe Request action, each request path is processed, including validation against valid attribute or event paths, checking for unsupported nodes, endpoints, clusters, or events, and handling privilege requirements for access.

DNS-SD allows discovery of both the unicast IPv6 address and port of the offered service, freeing Matter from requiring a single preallocated fixed port.

The Attestation Information should be validated using the checks described in Section 6.2.3.1, “Attestation Information Validation”.

Tag Length Value (refers mostly to Tag-length-value (TLV) Encoding Format)

No, the Diagnostic Logs Cluster is currently provisional, indicating it is in a trial phase and may be revised based on implementation experience and feedback.

The subject key identifier extension shall be treated as non-critical and marked as non-critical in the corresponding X.509 certificate, but the critical field shall not be encoded in the Matter certificate structure.

If all addresses are exhausted, the node may wrap around to the lowest unused address, but addresses previously used for exposed entities won't be reused to prevent confusion.

The subject key identifier extension provides a means of identifying Matter certificates that contain a particular public key.

Sufficient information to provide detailed results of the validation outcome to users.

In order to minimize unnecessary pollution of the crowded 2.4 GHz wireless spectrum, a commissionable device SHALL NOT announce for a duration longer than 15 minutes after announcement commences.

Bridged Device is A non-Matter device that is represented on the Fabric by a Bridge so it can be used by Nodes on the Fabric.

If the Networks attribute list is already full, the command shall immediately respond with NetworkConfigResponse having NetworkingStatus status field set to BoundsExceeded.

Pull requests should be small, easy to review, and address a single, specific change to the code base. They shouldn't combine unrelated changes or make stacks of changes.

No, the order of execution of the validation steps may be optimized by Commissioners.

The Fixed Label Cluster provides a feature for tagging an endpoint with zero or more read-only labels.

An example scenario involves an Action message where the second action is denied privilege due to a prior action updating the Access Control List.

1. Current Administrator sets Nodes for commissioning with a new setup passcode. 2. Current Administrator shows Onboarding Payload. 3. New Administrator finishes commissioning in the set time.

The Subjects field specifies a list of Subject IDs to which the Access Control Entry grants access, defining the entities or users allowed access according to the specified authentication mode.

The MoreChunkedMessages flag is set to 'true' to indicate that there are more chunked messages in a transaction.

The Stub Router connects stub networks to an infrastructure network and provides IPv6 reachability between the two networks.

The extensions list in the Matter certificate structure shall not contain more than one instance of a particular extension.

The first action of a transaction must be initiated by a single node.

nan

Notable characteristics include auto-balancing based on client needs and source capabilities, lack of persistent state or a priori configuration on any node, and robustness to proxy failure.

The hard-coded group security info is used to diversify the set of operational group keys. It ensures that each key derivation process results in unique operational group keys, enhancing security by preventing key reuse across different versions or implementations of the standard. The group security info serves as a constant value incorporated into the key derivation process, enabling flexibility for evolving security mechanisms. For instance, if security upgrades, such as transitioning from AES-128 to AES-256 encryption, are required, changing the group security info ensures that new keys are derived for use in the updated algorithm.

The General Diagnostics Cluster, along with other diagnostics clusters, provides a means to acquire standardized diagnostics metrics that may be used by a Node to assist a user or Administrator in diagnosing potential problems.

Cipher Block Chaining Message Authentication Code

It serves to validate whether a particular device is certified for Matter compliance and legitimately produced by the certified manufacturer.

Threat T23: Counterfeit Device produced (with unique but apparently authorized credentials). [CM24]

The Initiator sets the I Flag in the Exchange Flags of every message it sends in that Exchange. Responders do not set the I Flag. Additionally, Responders do not set the Destination Node ID field to identify any Node other than the Initiator for the Exchange.

Fusing of Devices in production SHOULD be done to limit unintended access to hardware components. For example, vendors may disable debug interfaces, and program trust anchors for secure boot. There are multiple options to secure fusing on the factory floor (e.g., physically securing the fusing station, pre-fusing the silicon, etc). [CM113 for T117]

MRP provides confirmation of delivery for messages that require reliability.

The general status codes are encoded as follows: SUCCESS: 0, FAILURE: 1, BAD_PRECONDITION: 2, OUT_OF_RANGE: 3, BAD_REQUEST: 4, UNSUPPORTED: 5, UNEXPECTED: 6, RESOURCE_EXHAUSTED: 7, BUSY: 8, TIMEOUT: 9, CONTINUE: 10, ABORTED: 11, INVALID_ARGUMENT: 12, NOT_FOUND: 13, ALREADY_EXISTS: 14, PERMISSION_DENIED: 15, DATA_LOSS: 16.

The Disconnection event includes the ReasonCode field, which contains the Reason Code field value for the Disassociation or Deauthentication event that caused the disconnection. The value aligns with Table 9-49 "Reason codes" of IEEE 802.11-2020.

An OTA Provider is a Node that implements the OTA Software Update Provider role, responsible for distributing software updates to devices within a network.

In this user journey, the user first initiates an interaction with a Commissioner and then indicates an intention to commission devices without providing additional information about them. The Commissioner then determines which technologies to use for Device Discovery and constructs a list of Commissionees discovered, allowing the user to select a Commissionee from the list.

They are reserved for future use and should be silently ignored.

AttributeReports and EventReports are optional arrays containing AttributeReportIB and EventReportIB respectively, used to report attribute and event data.

Common validations for AddNOC and UpdateNOC commands include verifying the NOC using cryptographic verification, matching the public key of the NOC with the last generated operational public key, validating DN Encoding Rules, and responding with appropriate error status codes if validation fails.

The Thread Network Diagnostics Cluster supports features such as PacketCounts, ErrorCounts, MLECounts, and MACCounts.

The first octet encodes the prefix length in bits (0 to 128), and subsequent octets encode the contiguous leftmost bits of the prefix, with left justification.

Defined in Section 2.11.2.1, “Read Interaction Limits”.

To ensure the intended device is discovered before connecting for commissioning.

If SuppressResponse is TRUE, a response shall not be generated. Otherwise, a response shall be generated.

Path2 = [[ EnableTagCompression = true, ListIndex = 4 ]] // Node, Endpoint (including wildcard), Cluster, Attribute are re-used from Path1

The NetworkID field in the ConnectNetwork command contains the NetworkID for the entry used to configure the connection: the SSID for Wi-Fi and XPAN ID for Thread.

Reasons include remaining in Idle Mode for a full Idle Mode Interval, needing to report an attribute change to a subscriber, reaching the maximum reporting interval for an active subscription, or encountering an application event that requires processing.

For Devices subject to physical tampering (e.g., doorbell, camera, door lock, devices designed for outdoor use cases), the physical interaction to initiate commissioning and/or the setup code is not accessible to a physical attacker.

Commissioning is initiated with some form of physical user interaction, such as a power cycle or button press.

The Thread Network Diagnostics Cluster provides standardized diagnostics metrics to assist in diagnosing potential problems.

An attribute is cluster data reflecting queryable/settable state, configuration, and capabilities of a device.

Large groups may impose significant message synchronization burden on the sender and induce message queuing pressure or latency on the receiver, particularly when message counter synchronization state is out of sync.

In Group authentication, the Subject ID identifies the required group as defined in the Group Key Management Cluster, determining the entities granted access based on group membership.

Matter Nodes support a number of IPv6 neighbor cache entries at least as large as the number of supported CASE sessions plus the number of supported routes.

Thread is a low-power, IEEE 802.15.4-based IPv6 mesh networking technology designed for home and commercial IoT environments, facilitating reliable, secure, and scalable networking.

The functional mapping is normative with respect to the values computed by the functions but informative regarding how the functions are interfaced within implementations. Implementations can vary as long as the computed values conform to the normative requirements.

The Priority Field in an event record describes the usage semantics of the event.

Endpoint composition is defined by specifying one of two patterns: the tree pattern or the full-family pattern. The tree pattern is defined by listing device types in a table, each of which is represented by one or more endpoints in the PartsList attribute of the Descriptor cluster. The full-family pattern is indicated by stating that the device type supports this pattern, and the PartsList attribute of the Descriptor cluster contains all descendant endpoints.

The Policies, Procedure, and Governance of DCL are managed by Board-approved committees, which include the Test Certification Oversight Committee (TCOC) and the Security Advisory Group (SEC AG).

An application cluster supports the primary operation of the endpoint and supports one or more persistent application interactions.

A message synchronization exchange is initiated by sending the MsgCounterSyncReq message to the peer Node that sent a message with an unknown message counter.

Threat T82: Device buyer dumps memory to find previous owner’s user data. [CM15, CM35]

Commands are executed as defined in the cluster specification. For each data field in CommandFields, if a mandatory field is missing or incoming data violates expected constraints, a CommandStatusIB is generated with corresponding status codes. If the cluster specification defines a following command or success/error status as a response, appropriate CommandDataIB or CommandStatusIB is generated.

It indicates the set of wired faults currently detected by the Node on this power source.

The Commissioner discovers commissionable devices on network interfaces and obtains an out-of-band secret from the device for secure session establishment.

If an NFC Tag is used to convey the Onboarding Payload from a device to a Commissioner, the NFC Tag SHALL only allow the alteration of the Onboarding Payload and the reading thereof in ways and in device states attackers cannot exploit to illicitly onboard the device.

The RxErrInvalidSrcAddrCount attribute indicates the total number of received unique MAC frame requests that have been dropped as a result of containing an invalid source address.

It is emphasized that the examples are for illustrative purposes only. The provided commands demonstrate how DNS-SD records can be set up using command-line test tools such as dns-sd and avahi-publish-service. However, real-world implementations would use appropriate DNS‐SD APIs in chosen programming languages rather than command-line tools.

The ASN.1 OID for the ECDSA with SHA256 algorithm is iso(1) member-body(2) us(840) ansi-x962(10045) signatures(4) ecdsa-with-SHA2(3) ecdsa-with-SHA256(2).

The BDX protocol ensures data-in-transit confidentiality by requiring execution over PASE or CASE encrypted sessions, enforced by allowing only messages transmitted without message security to be the actual PASE and CASE session establishment messages.

Nodes SHOULD protect the confidentiality of Node Operational Private Keys. The level and nature of protection for these keys may vary depending on the nature of the Nodes. [CM87 for T87, T110, T120]

Access Control List

Example 3 demonstrates an automation scenario where a motion sensor controls the lights in a room. The supported commands include EnableAction, DisableAction, PauseAction, PauseActionWithDuration, and ResumeAction.

The Localization Configuration Cluster provides attributes for determining and configuring localization information that a Node shall utilize when conveying values to a user, considering differing common languages, units of measurements, and numerical formatting standards across global regions.

The cluster supports the following features: PacketCounts (PKTCNT) and ErrorCounts (ERRCNT).

Secured messages are transported over UDP, TCP, or BTP (Bluetooth Transport Protocol) with security features, while unsecured messages are transported separately and may use specific protocols like UDP with a basic reliability protocol (MRP) or TCP.

The copyright is held by Connectivity Standards Alliance, Inc.

Matter is an open standard, enabling peer review and validation of protocol and security controls included.

Temporary Local Node IDs contain an implementation-dependent value in their lower 32 bits for internal usage, such as tracking connections or transport-layer links when an Operational Node ID is unavailable.

A status code of 0x81 indicates that the indicated command ID is not supported on the cluster instance, resulting in the command not being carried out.

Devices and Nodes SHALL have a factory reset capability.

The Proposed Transfer Control (PTC) field consists of four subfields: VERSION (4 bits), SENDER_DRIVE (1 bit), RECEIVER_DRIVE (1 bit), and ASYNC (1 bit).

EventReports is an array of EventReportIB structures used to report event data, potentially applying compression schemes to reduce redundant data.

The MaxIntervalCeiling parameter specifies the requested maximum interval boundary ceiling in seconds.

The LsfRevision field is a monotonically increasing positive integer indicating the latest available version of the Localized String File (LSF). It is used to check whether the client has the latest version of the LSF cached.

The TxRetryCount attribute indicates the total number of MAC retransmission attempts.

The interaction is terminated with a FAILURE status code when SuppressResponse is FALSE and the Report Data Action is received.

All parameters passed in transactions and queries to the DCL SHALL pass input validation checks done by the implementation of the DCL. [CM169 for T185]

The ASN.1 OID base for the domain-component attribute in a Matter certificate is itu_t(0) data(9) pss(2342) ucl(19200300) pilot(100) pilotAttribute-Type(1) domainComponent(25).

The Bridge receives value updates, events, and/or commands from Bridged Devices, representing them as attributes, events, and/or commands in the appropriate clusters on the associated endpoints of the Bridge after conversion from the native protocol of the non-Matter devices towards the Matter protocol.

OTA Providers should employ at least the common conceptual algorithm provided in the text, especially if they have access to the Distributed Compliance Ledger (DCL) data (Section Conceptual algorithm for matching OTA Software Images).

RFC 8766: Discovery Proxy, a mechanism for discovering services across different networks. URL: https://www.rfc-editor.org/rfc/rfc8766

RFC 8915: Network Time Security for the Network Time Protocol, enhancing security for NTP. URL: https://www.rfc-editor.org/rfc/rfc8915

draft-lemon-stub-networks: Connecting Stub Networks to Existing Infrastructure, a draft for integrating small networks with larger ones. URL: https://datatracker.ietf.org/doc/html/draft-lemon-stub-networks-02

SEC 1: SEC 1: Elliptic Curve Cryptography, Version 2.0, details elliptic curve cryptography methods. May 2009. URL: https://www.secg.org/sec1-v2.pdf

SEC 2: SEC 2: Recommended Elliptic Curve Domain Parameters, Version 2.0, provides guidelines for elliptic curve cryptography parameters. January 2010. URL: https://secg.org/sec2-v2.pdf

SIGMA: SIGMA: The ‘SIGn-and-MAc’ Approach to Authenticated Diffie-Hellman and Its Use in the IKE Protocols, a cryptographic protocol for secure key exchange. URL: https://doi.org/10.1007/978-3-540-45146-4_24

SPAKE2+: SPAKE2+, an Augmented PAKE (Password Authenticated Key Exchange), enhancing security for password-based authentication. Draft 02, 10 December 2020. URL: https://tools.ietf.org/pdf/draft-bar-cfrg-spake2plus-02.pdf

SRP: Service Registration Protocol, a protocol for registering services in DNS-SD. URL: https://tools.ietf.org/html/draft-ietf-dnssd-srp

Thread: Thread 1.3.0 Specification, a protocol for IoT (Internet of Things) network communications. URL: https://www.threadgroup.org

Verhoeff: Error detecting decimal codes, a study on error detection in coding. J. Verhoeff, 1969. URL: https://ir.cwi.nl/pub/13045

X.501: ITU X.501: Information technology - Open Systems Interconnection - The Directory: Models, part of the OSI model specifications. URL: https://www.itu.int/rec/T-REC-X.501/en

X.509: ITU X.509: Information technology - Open Systems Interconnection - The Directory: Public-key and attribute certificate frameworks, specifies standards for digital certificates. URL: https://www.itu.int/rec/T-REC-X.509/en

Matter uses Bluetooth Low Energy for commissioning purposes.

The Path field in AttributeDataIB indicates the attribute path to which the data change applies. It is defined by AttributePathIB and specifies the attribute or field being modified within the cluster.

"Provisional" items are features or components within the Matter protocol that are not yet finalized and may be subject to change. They are included for testing, feedback, and further development.

The Controller Node sends commands to the Group, which will be interpreted by both the Matter lights and the Bridge, forwarding them to the relevant bridged lights.

Administrators should configure source nodes to grant the 'Proxy View' privilege to proxy clients. This privilege should be granted for the entire source node to ensure the most effective proxy functionality.

The overridden element requirements for the Color Temperature Light device are: - Identify Command TriggerEffect - Scenes Command EnhancedAd dScene - Scenes Command EnhancedViewScene - Scenes Command CopyScene - On/Off Feature - Level Control Feature - Level Control Attribute CurrentLevel - Level Control Attribute MinLevel - Level Control Attribute MaxLevel - Color Control Feature - Color Control Attribute RemainingTime

A SIT ICD sets its Slow Polling Interval to a value greater than or equal to the default and advertises that value per SII. It also sets its Fast Polling Interval to a value greater than or equal to the default and advertises that value per SAI.

Ledger data in DCL is available in various schemas including Vendor, PAA (Product Attestation Authorities), DeviceModel, DeviceSoftwareVersionModel, Compliance, and Device Attestation PKI Revocation Distribution Points.

The Commissioner validates the Device Attestation Signature (attestation_signature) field from CSRResponse Command by performing Crypto_Verify using the public key from DAC, the message from NOCSR Information TBS (nocsr_tbs), and the signature from the Device Attestation Signature (attestation_signature) field.

The private part of the code signing key (used to sign firmware) SHOULD be strongly protected against disclosure or misuse. For example, it could be stored in an HSM on a secure server outside the factory with very restricted access to only a small number of Device Manufacturer employees. [CM28 for T72]

The first transaction of an interaction starts with the first action from the node known as the initiator, with the first action destination referred to as the target, which can be either a node or group. Throughout the interaction, the initiator remains constant, as described in this section.

The highest revision number is 7, as indicated in the Revision History table.

It indicates conformance to a device type and shall be a Manufacturer Extensible Identifier.

The points M and N for SPAKE2+ in Matter are taken from the SPAKE2+ specification and are listed in compressed format, ensuring that they are compatible with the elliptic curve used.

Groupcast sessions are conceptually long-running, lasting the duration of a node’s membership in a group.

The issuer field must be a sequence of RelativeDistinguishedNames. It must have exactly one VendorID value present and may have exactly zero or one ProductID value present.

Restart the device to enable the new firmware, making it ready for Matter.

The Duration field indicates the time in seconds for the disco ball to perform the pattern.

At launch, Matter will run on Wi-Fi, Thread, and Ethernet network layers.

The specific parameters include a nonce length of 13 bytes and a key length that matches the CRYPTO_SYMMETRIC_KEY_LENGTH_BITS bits.

OTA Requestors should interpret the ImageURI field as the URI from which they should download the Software Image (Section QueryImageResponse Command).

nan

Yes, container types can contain other container types, and they can be nested to any depth and in any combination.

A publisher must ensure each fabric can support at least three Subscribe Interactions to the publisher, each subscription supporting at least 3 attribute/event paths, with provisions for larger numbers of subscriptions or paths based on device type specifications.

A Status Code indicates a success or error status as a response to an action in an interaction, including both common status codes and cluster-specific status codes.

It indicates that the source is not currently available to supply power.

The AddNOC command is used to commission a Node into a Fabric by providing a usable NOC and ICAC, with associated Node Operational IDs. The UpdateNOC command is used to update existing credentials within a Fabric, such as rotating the Node Operational Key Pair or updating the contents of the NOC and optionally the ICAC certificates.

Yes, Matter can operate in networks disconnected or firewalled from the global Internet, accommodating environments without IPv6 support from ISPs or with limited IPv6 delegation.

A utility cluster is not part of the primary application operation of an endpoint and may be used for configuration, discovery, diagnostics, etc.

The base data types defined in the specification include Discrete (Boolean), Bitmap (8-bit, 16-bit, 32-bit, and 64-bit), Unsigned Integer (8-bit, 16-bit, 24-bit, 32-bit, 40-bit, 48-bit, 56-bit, and 64-bit), Signed Integer (8-bit, 16-bit, 24-bit, 32-bit, 40-bit, 48-bit, 56-bit, and 64-bit), Analog (Floating Point - Single precision and Double precision), and Composite (String, Octet string, List, Struct).

The LeaderRoleCount attribute indicates the number of times the Node entered the OT_DVICE_ROLE_LEADER role.

The matter-rcac-id DN attribute type certifies the identity of a Matter Root CA Certificate.

Multiple bindings are allowed, including unicast bindings targeting specific remote endpoints, and groupcast bindings targeting groups of remote endpoints.

There are no VendorID values present in the issuer field of the PAA certificate.

It may be used as a prefix in a Manufacturer Extensible Identifier format.

Uniqueness within the Distribution Points Schema is enforced against the tuple containing VendorID, Label, and IssuerSubjectKeyID.

[[ matter-rcac-id = 0xCA0000000000001DU, matter-fabric-id = 0xFAB000000000001DU, common-name = "ROOT CA HOME 3" ]]

The ID of the cluster is 0x0037, and its name is Ethernet Network Diagnostics.

During a write interaction to a fabric-scoped list, fabric-filtering is enabled, and the interaction must be on an accessing fabric; otherwise, the interaction fails.

The KeySetRead command is used by Administrators to read the state of a given Group Key Set.

Matter incorporates privacy-preserving mechanisms in the core specification, including unique random node identifiers, session establishment with configurable privacy, non-trackable IP addresses, and sessions with private message headers. It optionally encrypts node identifiers in messages to prevent eavesdropping entities from identifying communicating parties.

AttributeDataIB = { DataVersion = 1, Path = [[ Endpoint = 10, Cluster = Disco Ball, FieldID = Pattern]], Data = [[ /* List items */ ]] }

The Subscribe interaction is initiated when the subscriber wishes to subscribe to one or more attributes or events located on a target node (the publisher).

The ErrorValue field in the ConnectNetworkResponse command for Wi-Fi association errors contains the Status Code value present in the last frame related to association causing the failure.

The data type of ColorEnum is derived from enum8.

The 'ReorderNetwork' command changes the order of network configurations in the list.

According to the "Light Switch Client" example, the switch endpoint sends On/Off, Level, and Color Control cluster commands to group 1234.

It holds the details of a single action and contains various data fields including ActionID, Name, Type, EndpointListID, SupportedCommands, and State.

The session encryption keys are generated using Crypto_KDF with the SharedSecret, IPK, and TranscriptHash.

Nodes receiving group messages should accept the usage of any key derived from one of the currently installed epoch keys, regardless of whether the start time for the key is in the future or the past. This means that Nodes continue to accept communication secured under an epoch key until that key is explicitly withdrawn by deleting it from a Node's group state by the key distribution Administrator. By accepting keys from the currently installed epoch keys, Nodes ensure seamless communication within the fabric, allowing for backward compatibility and graceful key transitions during rotation or updates.

The 'LastNetworkID' attribute indicates the NetworkID used in the last attempt to connect to an operational network using the interface.

Message counters help detect repeated reception of the same message by maintaining a history window of received message counters, allowing Nodes to discard duplicate messages before they reach the application layer.

The status code 0x02, UNSUPPORTED_PATTERN, indicates that the movement pattern is unsupported on the device even though all values are within constraints.

The Reachable attribute indicates whether the bridged device is reachable by the bridge over the non-Matter network. It allows a Matter Node to get an indication of whether communication with the bridged device might fail (when the attribute is False). However, determination of reachability may not be perfect, so Matter Nodes should be aware of the risk of false positives and negatives in reachability determination.

It indicates the current state of the battery source with respect to charging.

A Fabric is a logical collection of communicating Nodes that share a common root of trust and a distributed configuration state, facilitating secure and coordinated operation within a network.

An Exchange is uniquely identified by the tuple {Session Context, Exchange ID, Exchange Role}, where Session Context represents the underlying session type (Unsecured, Secured, Groupcast, or MCSP).

The subject key identifier extension shall be present.

The StateChanged event is generated when there is a change in the state of an action during execution, providing feedback to the client about the progress of the action.

The Endpoint field contains the endpoint number which has the OTA Provider device type and OTA Software Update Provider cluster server on the ProviderNodeID.

The Matter TLV format supports the following container types: Structures, arrays, and lists.

The algorithm checks for fabric index matching, authentication mode matching, subject matching, and target matching in the Access Control List entries.

Epoch keys serve multiple purposes within the context of operational group keys. Firstly, they enable the limitation of the lifetime of derived operational group keys, enhancing security by ensuring that keys are only valid for a specified period. Additionally, epoch keys provide a mechanism for an Administrator to revoke access to Nodes that have been explicitly excluded from an operational group after a certain period of time. By managing the lifecycle of epoch keys, administrators can enforce access control and security policies within the fabric.

The cluster supports StateChanged and ActionFailed events.

Subjects in Access Control Entries are logical entities configured through policy by Administrators, including Commissioners during the commissioning phase. While the authentication identities assigned to Nodes may be associated with physical end-users in some implementations, Nodes themselves are logical networking entities. Therefore, the access granted by the Access Control system does not directly correspond to specific physical end-users but rather reflects the policy decisions made by Administrators.

A key word that indicates flexibility of choice with no implied preference.

Thread nodes are supported with Border Router and Node combinations such as ot-br (Thread Border Router) paired with RasPi, BeagleBone, and various platforms for lighting-app and lock-app examples.

The "add_granted_privilege" function adds a new privilege to the granted privileges set and also adds any privileges subsumed by the new privilege.

Interval: 30-60 ms; Window: 30 ms.

In a Report Interaction, the actions involved are Report Data and Status Response.

If no error-free existent paths remain after processing, the AttributeRequests or EventRequests are considered empty, and no further action is taken for those paths.

Senders must choose retransmission timeouts based on the session characteristics of the destination Node to ensure they do not attempt to send at a rate beyond the recipient’s capability, especially for intermittently connected devices.

The section describes Service Advertising and Discovery for Matter, covering various contexts such as Commissionable Node Discovery, Operational Discovery, Commissioner Discovery, and User Directed Commissioning.

In Example 5, the user can re-enable the automation by using the EnableAction command.

The Node Operational Key Pair, consisting of a Node Operational Public Key and a Node Operational Private Key, is generated using the Crypto_GenerateKeypair function.

The steps for setting the Security fields are as follows: 1. Set the Session ID field to the value provided in step 1. 2. Set the Security Flags field to the value provided in step 1, updating the Session Type field accordingly.

Context-specific tags identify elements within the context of a containing structure element and consist of a single 8-bit tag number.

Attribute is A data entity which represents a physical quantity or state. This data is com­ municated to other Nodes using commands.

The new Commissioner must have their own Node Operational Certificate (NOC) issued by its Trusted Root Certificate Authority (TRCA).

It should match the CDCertificateID field found in the entry of the DeviceSoftwareCompliance schema in the Distributed Compliance Ledger where the entry’s VendorID, ProductID, and SoftwareVersion field match the respective attributes values found in the Basic Information Cluster.

The cluster supports the following features: TimeZone, NTPClient, NTPServer, and TimeSyncClient.

An attribute path is used to indicate all or part of a cluster attribute, including deeper parts of collection type data.

EventReports is a TLV array containing EventReportIB structures, each representing a specific event with associated data and timestamps.

The purpose is to support the BTP receive window and provide a keep-alive signal when a session is idle to affirm the health and continued operation of a remote BTP stack.

The Access Control Cluster provides a data model view of a Node’s Access Control List (ACL) to manage and enforce access control for the Node’s endpoints and their clusters.

The intermediate outputs section of the first example Certification Declaration includes the encoded TLV of the sample Certification Declaration, which is 54 bytes long.

In the first action of a transaction, the Transaction ID should be a value that uniquely identifies the transaction on the source of the action.

The basic constraints extension identifies whether the subject of the certificate is a CA and specifies the maximum depth of valid certification paths.

The extensions shall appear in the same order in the Matter certificate and in the corresponding X.509 certificates.

Endpoint composition is indicated by the DeviceTypeList, which lists the device type(s) that the endpoint supports, and the PartsList, which indicates the required endpoints for each device type in the DeviceTypeList.

The distribution policy of epoch keys determines which Nodes have access to the input epoch keys required for deriving operational group keys. Nodes are granted possession of specific epoch keys based on predefined policies and mechanisms. Access to epoch keys is carefully controlled and managed to ensure that only authorized Nodes possess the necessary keys for deriving operational group keys. This policy-based approach safeguards the security of group communication by regulating access to the keys essential for deriving operational group keys.

The initiator's random number (InitiatorRandom) is generated using a cryptographic pseudo-random number generator with a length of 32 bytes.

The future extension is treated such that implementations that do not support specific future extensions will ignore them, but they can still be used for Matter certificate signature validation. If an ignored extension is marked as critical, validation of the corresponding Matter certificate shall fail.

No, a client MAY choose to use a Timed Write transaction even if the attribute does not have the Timed Interaction quality.

The two methods of commissioning are Basic Commissioning Method (BCM) and Enhanced Commissioning Method (ECM).

The ID of the event is 0x00, and its name is ConnectionStatus.

The ID of the FullDuplex attribute is 0x0001, and its name is FullDuplex.

The examples in section 6.5.15 of the Matter specification demonstrate the representation of Matter certificates both in X.509 format and Matter TLV format, along with corresponding private keys, ensuring interoperability and providing a clear illustration of the encoding and structure.

The Path field in the EventPathIB must be of type ClusterPathIB and is mandatory.

Each data message requires a response before the next can be sent, ensuring in-order delivery of a chunked set of IBs.

A Matter certificate encodes a subset of the object identifiers (OIDs) specified in X.509, including certain attribute types for relative distinguished names, cryptographic algorithms, and a limited set of extensions.

The Peer Node ID records the node ID of the peer with which message counter synchronization is being conducted.

Idle Mode is when the ICD is unreachable due to not receiving messages for a certain period, limited by the Idle Mode Interval. During Idle Mode, the ICD configures its network interface for Slow Polling.

A client specifies the Node ID of the source it wishes to subscribe to in the Path, different from the Node ID of the proxy.

"Optional" indicates that the data model is only required for some action behavior.

Commissioners SHALL use PAA and PAI certificates to verify the authenticity of a Commissionee before proceeding with the rest of the Commissioning flow.

The Pattern attribute is an ordered list of entries used to operate the disco ball when the Pattern Request command is invoked.

The cryptographic algorithm used in the digital signature of X.509 certificates is identified by its OID.

Matter employs a layered approach with authentication and attestation for commissioning, protects every message, and supports secure over-the-air firmware updates.

The signature field in the Matter certificate structure is identified by the context-specific tag signature [11] and is used to encode the signature of the certificate, following the encoding defined in Section 3.5.3, “Signature and verification”.

No, not all cryptographic primitives are exposed to other parts of the specification. For example, the Crypto_TRNG() primitive should not be called outside of the Crypto_DRBG() implementation.

The 'BatChargeFaultChange' event occurs when the set of charge faults currently detected by the Node on this battery power source changes.

The responder constructs the Crypto_PBKDFParameterSet (PBKDFParameters) based on whether the PBKDFParamRequest.hasPBKDFParameters is set to True or False.

If an attempt is made to write a value to ActiveLocale that is not present in SupportedLocales, it will result in a CONSTRAINT_ERROR error.

In the "Light Switch Client" example, the Node and Cluster fields are omitted.

[[ matter-node-id = 0x0102030405060708U, matter-fabric-id = 0xFAB000000000001DU ]]

The issuer field in the PAI certificate contains the information: CN = Matter Test PAA, 1.3.6.1.4.1.37244.2.1 = FFF1.

The General Diagnostics Cluster attempts to centralize all metrics that are broadly relevant to the majority of Nodes.

The attributes provided are Hierarchy, Role, Scope, and PICS Code.

The HardwareAddress field contains the current link-layer address for a network interface.

The Alarm Value is similar to Notification but with a higher priority, potentially overriding other endpoint states. For example, flashing all lights in the house when a CO sensor triggers.

The fallback method involves encoding VendorID and ProductID within the commonName attribute type ({joint-iso-itu-t(2) ds(5) attributeType(4) commonName(3)}), using substrings. Specifically: - VendorID value is encoded with substring Mvid: followed by exactly 4 uppercase hexadecimal characters without elision of leading zeroes. - ProductID value is encoded with substring Mpid: followed by exactly 4 uppercase hexadecimal characters without elision of leading zeroes.

The RxDataPollCount attribute indicates the total number of received unique MAC Data Poll frames.

The OTA Image Selection Logic determines the availability of a newer Software Image in response to a QueryImage command.

UDC messages are sent unreliably, to an IP address found in a AAAA record associated with the Commissioner Discovery service, using UDP with a destination port as found in the _matterd._udp SRV record.

Crypto_HMAC() uses HMAC-SHA256, computed as defined in FIPS 198-1, using Crypto_Hash() as the underlying hash function, with the hash length specified in the hash function section.

If the transport interface returns an error on the send attempt in MRP, the error is assessed to determine whether the message can be retried. If there is no fatal error, the message is resent.

Request paths are utilized in actions requesting data model elements, serving the purpose of specifying the data to be requested, as outlined in this section.

The AccessControlEntryStruct type includes four fields: Privilege, AuthMode, Subjects, and Targets, providing comprehensive information for defining access control rules and permissions.

The extended key usage extension structure includes the extended-key-usage field, which is an array of key-purpose-id values representing additional purposes for the certified public key.

Bitmap types are encoded using the TLV unsigned integer type, with the width selected automatically at runtime based on the actual value.

The UnregisterClient command includes fields for CheckInNodeID and VerificationKey.

An application device type supports the primary application function of the endpoint and specifies the endpoint as either Simple or Dynamic.

The FeatureMap attribute indicates whether the server supports optional cluster features and their corresponding bit values.

The Clockwise value indicates that the disco ball is currently rotating in the clockwise direction.

The 'ScanNetworksResponse' command contains the status of the last scan operation and associated scan results if successful.

All certificates SHALL NOT be longer than 600 bytes in their uncompressed DER format. This constraint applies to the entire DAC chain (DAC, PAI, PAA) and NOC chain (NOC, ICAC, RCAC).

The HourFormatEnum data type provides options for specifying how time is conveyed, either with a 12-hour clock or a 24-hour clock.

- Key length: 128 bits (16 bytes) - MIC length: 128 bits (16 bytes) - Nonce length: 13 bytes - The q parameter is 2 (encoding of maximum length) - The n parameter is the length of the nonce in bytes

The IdentificationDeclaration message serves to identify the commissionee and is sent by the commissionee to the commissioner.

No, operational group keys are shareable across all types and combinations of Nodes as determined by the Administrator managing the group. All Nodes possessing the current epoch keys for the group can communicate with other Nodes in the group. However, it is the responsibility of the Administrator to compose groups of Nodes where communication is appropriate for the application and security requirements, ensuring that only relevant Nodes have access to the shared keys.

It indicates the assessed frequency of the voltage currently provided by the hard-wired source, in Hz.

The principles include lawfulness, fairness, and transparency; purpose limitation; data minimization; accuracy; storage limitation; cybersecurity (integrity and confidentiality); and accountability.

The NeighborTableStruct type contains information about neighboring nodes, including their addresses, age, and communication details.

Data is sent to the transport protocol (TCP or Matter’s Message Reliability Protocol) for IP management, then travels up the protocol stack at the receiver's end, reversing the sender's operations to deliver the message to the Application.

The context-specific tag ec-curve-id [8] is used to identify the elliptic curve field in the Matter certificate structure.

The TxErrAbortCount attribute indicates the total number of unique MAC transmission request failures caused by an abort error.

The Operational Group Key and Group Session ID in the Groupcast Session Context are used to encrypt and track the incoming group message, ensuring message authenticity and preventing replay attacks.

In X.509 format, the ICAC certificate is represented with its serial number, signature algorithm, issuer and subject information, public key details, X.509 extensions including Basic Constraints, Key Usage, Subject Key Identifier, and Authority Key Identifier, and the signature.

The TimeSinceBoot field contains the time of the oldest log entry in the diagnostic logs being transferred represented by the number of microseconds since the last time the Node went through a reboot, if the Status field is set to Success.

The Administrator updates the ACL of all relevant targets by adding an entry with the subject of the CAT identifier value 0xFFFF_FFFD_ABCD_0001. Any Node with a CAT identifier value of 0xABCD and version value of 0x0001 or higher in their NOC will have the corresponding privilege.

Section 4.8.4 describes the process of privacy processing for incoming Matter messages, specifically focusing on deobfuscating private messages received by Section 4.6.2, "Message Reception".

Updates to the Access Control Cluster shall take immediate effect in the Access Control system.

The Status Response Action conveys status to the interaction layer, indicating either success or an error as part of a transaction or interaction.

A Client can request logs to be transferred using either the ResponsePayload or BDX method.

The default value of the Access Control Cluster is empty, meaning it contains zero elements in each list attribute.

The LastRssi field indicates the Received Signal Strength Indication (RSSI) of the most recently received frame from the neighboring node.

The Administrator-Assisted Commissioning Method ensures that Administrators can support opening a commissioning window on a Node using the mandatory method described in Section 5.6.3, "Enhanced Commissioning Method (ECM)".

The initiator uses I2RKey for encryption and integrity protection of messages, and R2IKey for decryption and verification. Conversely, the responder uses R2IKey for encryption and integrity protection, and I2RKey for decryption and verification.

An operational group key is derived by applying a key derivation function (KDF) with an epoch key and a salt value as inputs. Specifically, the KDF takes the epoch key as the InputKey, the Compressed Fabric Identifier as the Salt, and the string "GroupKey v1.0" as the Info. The length of the resulting operational group key is determined by CRYPTO_SYMMETRIC_KEY_LENGTH_BITS.

Extended Discovery allows a Matter Commissionee to advertise Commissionable Node Discovery service records for longer periods, possibly permanently, even when not in Commissioning Mode.

For example, an endpoint supporting a Temperature Controlled Cabinet device type inside a Refrigerator device type may have leaf endpoints indicating temperature sensors, with each sensor conforming to the temperature sensor device type and having unique TagList attributes.

Yes, for example, 0x0000_0000 represents a Standard/Scoped item 0, and 0x0001_0000 represents MC 1 item 0. The MEI description indicates the source type (Standard, Scoped, or specific Manufacturer Code) and the item number within that context.

Product Identifier (also Product ID)

The SESSION_ACTIVE_INTERVAL (SAI) key/value pair allows a Node to override the default MRP parameter value for the interval when the node is active. Expressed in milliseconds, it ensures efficient network communication by defining the interval for retrying communication when the node is active.

Signed Integer data types are defined with various bit widths (8-bit to 64-bit) and have a usable range of [-(2^(N-1))..2^(N-1)-1] if not nullable or [-(2^(N-1)-1)..2^(N-1)-1] if nullable, with specific minimum and maximum values for each width.

Upon successful receipt of SigmaFinished, the initiator sends a status report indicating the success of the session establishment.

dc:35:dd:5f:c9:13:4c:c5:54:45:38:c9:c3:fc:42:97:c1:ec:33:70:c8:39:13:6a:80:e1:07:96:45:1d:4c:53

The context-specific tag serial-num [1] is used to identify the serial number field in the Matter certificate structure.

The detailed steps for privacy processing of outgoing and incoming Matter messages are described in Section 4.8.3, "Privacy Processing of Outgoing Messages", and Section 4.8.4, "Privacy Processing of Incoming Messages", respectively. They rely on the cryptographic primitives outlined in Section 3.7, "Message privacy".

The Security Flags field is an unsigned integer bit field containing subfields like P Flag, C Flag, MX Flag, and Session Type. The P Flag indicates whether the message is encoded with privacy enhancements. The C Flag identifies if the message is a control message, and the MX Flag indicates the presence of the Message Extensions portion in the message. The Session Type subfield specifies the type of session associated with the message, such as Unicast Session or Group Session.

A Vendor ID (VID) is a 16-bit number that uniquely identifies the Vendor of a Device, facilitating identification and differentiation in networked environments.

The BDX protocol treats files as opaque, without specifying their format, but allows for extensible metadata for higher-level applications to participate in transfer decisions.

It shall be ignored since the Device Attestation PKI Revocation Distribution Points Schema in the Distributed Compliance Ledger is the only supported method of determining up-to-date revocation status.

A Manufacturer Extensible Context (MEC) contains a collection of items that may be extended by manufacturers. Each item in a MEC has a source that is either Standard, Scoped, or a particular Manufacturer Code (MC).

Admins SHOULD only grant privileges to a Bridge or Bridged Device (sending commands from that Bridged Device towards a Matter node) that the User is comfortable implicitly granting to all other Bridged Devices exposed by that Bridge. Background: Matter’s ACL mechanism does not provide a way to grant privileges to only a single endpoint (Bridged Device) from a node (the Bridge). [CM149 for T162, T165, and T167]

Matter minimizes the potential for inadvertent leakage of information by designing protocols to share only the minimum required data for proper and robust operations.

An OTA Requestor can apply the update after multiple retries or if no response is received for over 24 hours, as a measure of last recourse to avoid situations of critical issues affecting the update process (Section Update application process).

The basic CASE protocol achieves mutual authentication and key exchange within 2 round trips. This involves the exchange of ephemeral elliptic curve public keys, certificates to prove identities, and signing of the ephemeral keys and NOC, as illustrated in Figure 15 of the specification.

The ASN.1 OID for the basic constraints extension is joint-iso-itu-t(2) ds(5) certificateExtension(29) basic-Constraints(19).

The ID of the Software Diagnostics Cluster is 0x0034.

The Sigma1 resumption key (S1RK) is generated using Crypto_KDF with the SharedSecret, Sigma1.initiatorRandom, and ResumptionID.

Matter simplifies connected experiences by providing a unified approach to connectivity, while also enhancing compatibility and security.

No, the extended key usage extension shall not be present.

Revision 1 marks the initial release, while Revision 2 adds usage descriptions for TagList.

MRP supports one pending acknowledgment and one pending retransmission per Exchange.

A BTP Frame consists of an 8-bit header followed by one or more optional fields. The format is defined in Table 26, “BTP Packet PDU format”, which includes Control Flags, Ack Number, Sequence Number, Message Length, and Segment Payload.

Granted privileges are determined by iterating through the Access Control List and checking for matches based on various conditions.

MRP is optimized for constrained devices because they may not always be able to receive a message at the point it is due to be delivered.

Matter-specific DN attribute types convey information about Matter-specific certificate types.

Key material is distributed to key holders through the Group Key Management Cluster, which provides a mechanism for managing and disseminating epoch keys and associated group session identifiers. The information exposed in the Group Key Management Cluster includes the group epoch keys and their corresponding group session identifiers. This ensures that key holders have access to the necessary cryptographic material required for secure communication within their respective groups. Additionally, key material is exposed via Attributes with ACL entries that restrict access to authorized entities, such as the key distribution Administrator, ensuring that only authorized parties can access sensitive key information. Through this distribution mechanism, Nodes within the network can securely obtain the key material required for group communication, maintaining the integrity and confidentiality of the key distribution process.

Cluster-specific status codes are indicated by the path to the cluster instance, the global status code (SUCCESS or FAILURE), and the cluster specific status code.

Threat T182: DoS/DDoS of Observer Nodes. [CM166]

A Long Idle Time ICD has a Slow Polling Interval longer than 15 seconds. Typical examples include sensors and light switches, where data reports are initiated by the ICD for an updated sensed value or a switch event.

The "EndPointListID" field provides a unique identifier used to identify the endpoint list.

A simple device type supports local control that is persistent, independent, and unsupervised, typically representing sensors, actuators, lights, and switches.

The data contained in the NFC tag must use the NDEF URI Record Type Definition as defined by NFC RTD URI 1.0, with the payload starting with "MT:" followed by the base-38 content.

The Binding cluster represents a persistent relationship between an endpoint and one or more other local or remote endpoints, informing a client endpoint of potential interaction targets.

ReadRequestMessage is used to request data, including attribute and event requests, in a TLV structure format.

Crypto_Privacy_Decrypt() decrypts encrypted content using a symmetric key and a nonce, returning the decrypted message.

The <attribute> component may include a field ID for structure data or an entry index for list data.

The Passcode serves as proof of possession during commissioning and is included as a 27-bit unsigned integer, encoding an 8-digit decimal numeric value. It is restricted to the values 0x0000001 to 0x5F5E0FE (00000001 to 99999998 in decimal), excluding invalid Passcode values. The Passcode is used as the shared secret in setting up the initial secure channel over which further onboarding steps take place.

The passcode and other info should be shown on a user interface if available, using either a text or QR code format. If only audio output is available, the passcode should be spoken.

Path = [[ Endpoint = 10, Cluster = Disco Ball ]]

The minimum attributes required in a NOCSR include Version, Subject, Public Key Algorithm, Public Key, ASN1 OID, NIST CURVE, and Signature Algorithm.

After successful session establishment, the secure session context records the peer NOC's matter-node-id, the Fabric identifier, and all peer NOC's case-authenticated-tag if present. These fields are committed to the secure session context once the session is successfully established at both peers.

The initiator generates pA using the Crypto_pA function with the Crypto_PAKEValues_Initiator.

The HardwareFaultChange event indicates a change in the set of hardware faults currently detected by the Node.

Threat T112: Malicious Devices or persons with local network access attempts to guess setup code of many Devices via online brute force attack. [CM5, CM100]

The CapabilityMinimaStruct provides constant values related to overall global capabilities of this Node, not cluster-specific, including fields like CaseSessionsPerFabric and SubscriptionsPerFabric.

Data shared between Matter nodes is strictly for defined purposes, specifically for the operations required by the Matter protocol.

Upon receipt of the StayActiveRequest command, the server increases the remaining time in active mode by one ActiveModeThreshold.

The NetworkFaultChange event indicates a change in the set of network faults currently detected by the Node.

The OverrunCount attribute indicates the number of packets dropped either at ingress or egress, due to lack of buffer memory to retain all packets on the network interface.

The Base Cluster Requirements section specifies clusters that must be included in each device type definition as a minimum set, assuming the Matter conformance condition is TRUE.

Device commissioning involves device discovery, security setup with PASE, device attestation verification, information configuration, network joining, security setup with CASE, and commissioning complete message exchange.

The CallbackUrl can have a query with key-value pairs, using "&" as a delimiter. Keys starting with "MT" not covered are for future use. "MTrop" must be included with a specific value.

The value of the PH key may change during the device's lifecycle. For example, a device may have certain bits set when in a factory reset state, and other bits set after it has been commissioned. This reflects changes in the methods supported for entering Commissioning Mode based on the device's state or configuration.

Each node supporting the OTA Provider device type must include the OTA Software Update Requestor and OTA Software Update Provider clusters based on the specified conformance.

The 'Connected' field indicates the connected status of the associated network, showing whether the Node is currently linked to the network technology.

No, there is no cryptosuite negotiation in the protocol. Each version of the Message Format has a defined cryptosuite as detailed in Chapter 3.

Endpoint and Cluster tags can be omitted, and the semantics of such omission depend on the value of EnableTagCompression.

The key usage extension shall be encoded with exactly one flag: digitalSignature.

- In an Aggregator scenario with Color Temperature Lights, disambiguation is achieved using the NodeLabel attribute. - For sibling endpoints with Content App device types, disambiguation is ensured by unique ApplicationName attributes. - In other cases, TagList attributes are used to provide disambiguation, with distinct sets of tags for each affected endpoint.

Cluster aliasing allows multiple Cluster Identifiers to map to a single cluster specification for reuse.

The QR code should employ level M or higher ECC, although in certain situations ECC=L may be used as well.

- Each added entry generates an event with ChangeType Added. - Each changed entry generates an event with ChangeType Changed. - Each removed entry generates an event with ChangeType Removed.

There are no cluster element overrides for the On/Off Light Switch device.

It indicates if the Node detects that the hard-wired power source is properly connected.

IPv6Addresses are represented as a list of unicast IPv6 addresses currently assigned to the network interface.

The algorithm used in the subjectPublicKeyInfo field of the PAA certificate is the object identifier for prime256v1.

If the AEAD operation results in an error, security processing fails, and no further security processing is performed on the message.

Yes, a Controller Node can create Groups and Scenes containing both Matter lights and non-Matter lights.

A Cluster is a specification that defines attributes, commands, behaviors, and dependencies, supporting an independent utility or application function. It can also refer to an implementation or instance of such a specification on an endpoint.

Anonymous tags are used to denote TLV elements that lack a tag value, and such elements are referred to as anonymous elements.

The EventDataIB contains fields for Path, EventNumber, Priority, EpochTimeStamp, SystemTimeStamp, and Data.

The Access Control Cluster defines the ChangeTypeEnum, AccessControlEntryPrivilegeEnum, and AccessControlEntryAuthModeEnum data types.

The AccessControlTargetStruct type includes three fields: Cluster, Endpoint, and Device Type, allowing for specification of targets at different levels within the network hierarchy.

The AttestationChallenge is only used as a challenge during device attestation, as specified in Section 6.2.3 of the document.

AES-CCM-DecryptVerify follows the guidelines in Section 6.2 of NIST 800-38C, including counter generation and formatting functions, to decrypt the payload and verify the tag, returning a success flag and the decrypted payload if successful.

Broadcast is The transmission of a message to every Node in a particular broadcast domain, be it all Nodes on a Ethernet or Wi-Fi link, and/or all Nodes on a Thread mesh.

It indicates an Event instance.

Rollover is not an issue for Global Group Encrypted Message Counters as long as the Epoch Key that generates each operational group key rotates frequently enough.

AttributeDataIB = { DataVersion = 1, Path = [[ Endpoint = 10, Cluster = Disco Ball, FieldID = Pattern, ListIndex = null]], Data = { /* Data fields */ } }

The RxBeaconCount attribute indicates the total number of received unique MAC Beacon frames.

The NetworkFaultChange event indicates a change in the set of network faults currently detected by the Node.

Matter-related SRV records should reference a Matter-specific target hostname that has only IPv6 address records attached, indicating optimized IPv6-only address discovery.

The Outgoing Subscribe Response Action is generated upon receipt of a successful Status Response action from the subscriber for the Report Data action that primes the subscription.

A Color Temperature Light is a lighting device capable of being switched on or off, adjusting the intensity of its light, and adjusting its color temperature. The adjustments can be made using a bound controller device such as a Color Dimmer Switch.

The session encryption keys are computed by performing a key derivation function (Crypto_KDF) using the shared key (Ke), an empty salt, and the SEKeys_Info as input.

Matter: Command, HomeKit: Command, Weave: Command, Thread: Command, Zigbee: Command

Nodes interested in changes in device names or grouping should monitor changes to the NodeLabel attribute or the EndpointLists attribute of the Actions cluster.

The data type of CapabilityMinimaStruct is a structure.

The Speed field indicates the speed of the rotation, or null to not change the speed.

The Default field indicates the default value for the Binding attribute.

True Random Number Generator (from NIST 800-90B)

Before a BTP session can be initiated, a central device must establish a BLE connection to a peripheral device. Once the BLE connection is formed, centrals assume the GATT client role for BTP session establishment and data transfer, while peripherals assume the GATT server role.

After generating pA, the initiator sends a message containing the TLV-encoded pake-1-struct Pake1 with an anonymous tag for the outermost struct.

The EventFilterIB is used to filter events based on specific criteria.

The discovering Node SHOULD walk the entire tree of endpoints via the PartsList attributes and endpoints to discover the list of Bridged Devices.

StatusIB is used to represent the status of an operation or entity, encapsulated in a TLV structure.

The original baseline comes from the Zigbee Cluster Library (ZCL) Chapter 2 related to ZCL commands and interactions.

Matter security is resilient, meaning it is designed to protect, detect, and recover. It provides multiple ways to perform operations, incorporates mechanisms to prevent common denial of service attacks, and introduces measures such as firmware integrity attestation and sophisticated message counter mechanisms to ensure resilience even in challenging scenarios.

After sending Sigma2_Resume, the responder generates the session keys as described in Section 4.13.2.6.7, “Resumption Session Encryption Keys”.

The purpose of the ReleaseNotesURL field is to specify a link to a product-specific webpage that contains release notes for the OTA software update file.

The Device Type Class Conditions category provides classifications of device types. Some of these classifications are dependent on other conditions.

If this action is part of a Timed Write transaction, the TimedRequest field SHALL be TRUE.

The Boolean type represents a logical value, either FALSE or TRUE, with FALSE equivalent to 0 (zero) and TRUE equivalent to 1 (one).

The purpose of the Timed Request Action is to inform the receiver that another action will be sent in the same direction, within the same transaction, and within a specified Timeout interval.

The Revision History in the Thread Network Diagnostics Cluster indicates the evolution of the cluster, starting with the initial release.

Symmetric block ciphers with Authenticated Encryption with Associated Data (AEAD) using AES-CCM mode are used for protecting unicast and multicast messages between Nodes.

The architecture is divided into layers to separate different responsibilities and provide encapsulation among the protocol stack's components, ensuring efficient interaction flow.

The Fabric Index in the ISD maps to a fabric reference.

Proxies must express the type of subscription (proxy or not proxy) in the SubscribeRequest itself.

The compressed fabric identifier is computed using the Crypto_KDF function with inputs including the target operational root public key and the target operational fabric ID. The root public key is the uncompressed elliptical curve public key of the root certificate for the advertised Node's operational certificate chain. The fabric ID is the octet string representing the fabric ID in the advertised Node's operational certificate's subject field. The computation involves using a predefined information string and a length of 64 bytes to derive the compressed fabric identifier [RFC 2782].

Upon receiving the RegisterClient command, the server verifies privileges, checks the verification key, updates the entry, persists client information, and generates a response accordingly.

The 'BatFaultChange' event is generated when the set of battery faults currently detected by the Node on this battery power source changes.

When a distinguished ordering of members is required, the members of the structure are encoded according to the canonical ordering rules specified in Section A.2.4, “Canonical Ordering of Tags”.

The GroupKeySetStruct data type contains fields specifying group key set ID, security policy, epoch keys, epoch start times, and multicast policy.

The context-specific tag extended-key-usage [3] is used to identify an extended key usage extension entry in the Matter certificate extensions list.

Matter devices typically run on MCU (Microcontroller Unit), secure MCU, or SoC (System on Chip) platforms with an optional companion secure element.

It indicates the assessed current presently supplied to charge the battery source, in mA (milliamps).

A key word indicating a mandatory requirement. Designers are required to imple­ ment all such mandatory requirements.

A Matter certificate is encoded with the Matter TLV structured data interchange language instead of the ASN.1 Distinguished Encoding Rules (DER).

The extended key usage extension shall be treated as critical and marked as critical in the corresponding X.509 certificate, but the critical field shall not be encoded in the Matter certificate structure.

Bluetooth Low Energy

After the initial Commissioning of a Device, subsequent Commissioning can only be triggered by an Administrator or an equivalent entity where the user gives administrative consent.

A binary number with unspecified lower bits is represented with an "x" for each unspecified bit, e.g., "0b0000 0xxx" indicates the lower 3 bits can take any value.

Each session encryption key is exactly CRYPTO_SYMMETRIC_KEY_LENGTH_BITS long.

User consent is required for a Node to join another Fabric, and it is obtained by instructing an existing Administrator to put the Node into commissioning mode.

The PAA certificate includes Basic Constraint (critical, CA:TRUE, pathlen:1), Key Usage (critical, Certificate Sign, CRL Sign), and Subject Key Identifier extensions.

An Access Control Entry (ACE) contains several pieces of information, including the FabricIndex scoping, Privilege level granted, list of target Clusters, list of source Subjects, and Authentication Mode. These details define the scope and conditions under which the access privilege is granted to specific entities within the Matter ecosystem.

For Devices subject to physical tampering, the physical interaction to initiate commissioning and/or the setup code (QR code, NFC Tag or Manual code) SHOULD NOT be accessible to a physical attacker. E.g. setup code is removable or not on the device, the button used to initiate commissioning for the lock is inside the house. [CM4 for T3, T84]

Trivial File Transfer Protocol (from RFC 1350)

The subject field in the PAI certificate contains the information: CN = Matter Test PAI, 1.3.6.1.4.1.37244.2.1 = FFF1, 1.3.6.1.4.1.37244.2.2 = 8000.

The TLV Type for DataVersionFilterIB is Structure.

The ChangeReasonEnum data type signifies reasons for a state change during the update process, including Success, Failure, TimeOut, and DelayByProvider.

The BSSID attribute indicates the BSSID for which the Wi-Fi network the Node is currently connected.

Threat T55: Device reconfigured improperly. [CM45, CM46, CM47]

The Header field includes VendorID, ProductID, SoftwareVersion, SoftwareVersionString, PayloadSize, MinApplicableSoftwareVersion, MaxApplicableSoftwareVersion, ReleaseNotesURL, ImageDigestType, and ImageDigest.

Read access from DCL is public, allowing retrieval of device model information, compliance status, and Product Attestation Authorities certificates.

Upon receiving the PBKDFParamRequest message, the responder verifies that the passcodeID is set to 0.

Node Operational credentials include the Node Operational Key Pair, Node Operational Certificate (NOC), Intermediate Certificate Authority (ICA) Certificate (optional), and Trusted Root Certificate Authority (CA) Certificate(s).

UDC messages are structured as specified in Section 4.4, “Message Frame Format,” and are unsecured at the message layer.

Actuators and sensors/switches.

BTP_CONN_IDLE_TIMEOUT is the maximum amount of time no unique data has been sent over a BTP session before the Central Device must close the BTP session. Default: 30 seconds.

The MsgCounterSyncReq message queries the current message counter from a peer to bootstrap replay protection, while the MsgCounterSyncRsp message provides the current message counter from a peer for the same purpose.

For example, a Refrigerator/Freezer endpoint may have a PartsList including the Refrigerator and Freezer endpoints, while the Refrigerator and Freezer endpoints each have a PartsList containing temperature sensor and control endpoints.

The sample CSA CD Signing Certificate and Private Key provided are for exemplary purposes and are not official CD signing material. They are used in the example for demonstration.

An Extended Color Light device type may support device type IDs for both a Dimmable Light and On/Off Light, as they are subsets of an Extended Color Light (the superset).

The two methods are Trust-first policy and Cache-and-sync policy, configurable per-group-key based on the GroupKeySecurityPolicy field of a given group key set.

The SESSION_ACTIVE_THRESHOLD (SAT) key/value pair allows a Node to override the default MRP parameter value for the threshold of session activity. Expressed in milliseconds, it defines the duration of time the node stays active after the last network activity, ensuring optimal communication efficiency by controlling the active duration of the node.

It's a commissioning flow where the device requires user interaction beyond just powering on to enter advertising mode. If additional setup artifacts are needed beyond documentation, the device is considered a Custom Commissioning Flow device.

It should notify the user that commissioning could succeed for some non-genuine devices due to lack of access to necessary information.

The RadioFaultChange event indicates a change in the set of radio faults currently detected by the Node.

The StartAction command triggers the commencement of an action on the involved endpoints, and afterward, the action's state becomes Active.

1. Check if the P Flag is set. If not, no action is taken. <br> 2. Execute the decryption operation specified in Section 3.7.2, "Privacy decryption", using the given Privacy Key, the MIC from the message security protection, the PrivacyNonce, and the encrypted message header fields (CP). <br> 3. Use the deobfuscated output (M) as the message header fields in the final private message.

The tree pattern is commonly used for composed application device types, representing a hierarchical structure of endpoints supporting various functionalities.

Epoch Time in Microseconds represents an offset in microseconds from January 1, 2000 UTC, including a local time offset that may account for time zone and DST, encoded as an unsigned 64-bit scalar value.

Use a voice prompt for the Manual Pairing Code, with an option to repeat it.

The CRLSignerCertificate field contains the issuer certificate who signed the revocation information provided in the distribution point entry, encoded in X.509v3 PEM format.

If the outbound message in MRP is marked for reliable delivery over UDP, the R Flag is set on the message to request an acknowledgment from the peer upon receipt.

The purpose of the QueryImage command is for OTA Requestors to determine the availability of a new Software Image (Section Usage of the QueryImage Command).

The SubjectsPerAccessControlEntry attribute specifies the minimum number of Subjects per entry supported by the server. This value should not decrease across time as software updates occur.

The Duplicate condition is triggered when sibling endpoints have an overlap in application device types.

A Commissioner / Administrator only adds Root Certificates that it trusts to a node.

The GATT client (BTP Client) should perform the following steps before initiating a BTP session: 1. Perform a GATT Exchange MTU procedure. 2. Execute the GATT discovery procedure to discover the BTP Service and its characteristics (C1 and C2). 3. Discover the Client Characteristic Configuration descriptor (CCCD) of the C2 characteristic.

The UpTime attribute indicates a best-effort assessment of the length of time since the Node’s last reboot.

Upon successful execution of the AddNOC command, a new FabricIndex is allocated, an entry is added reflecting the matter-fabric-id RDN within the NOC’s subject, the operational key pair associated with the incoming NOC is recorded, certificate values are stored, an Access Control Entry is created, and the operational discovery service record is updated.

The Interaction Model may allow the action for some request paths while denying it for others within the same action. Additionally, Access Control is just one of the checks used by the Interaction Model, and an action allowed by Access Control may fail for other reasons.

The IPK is the operational group key under GroupKeySetID of 0 for the fabric associated with the originator’s chosen destination. It is exclusively used for Certificate Authenticated Session Establishment.

The 'ThreadScanResults' field in the 'ScanNetworksResponse' command contains Thread network scan results.

The Commissioner should have previously obtained the Device Attestation Certificate chain for the Commissionee, so that the DAC and PAI necessary for the procedure are available.

- The VendorID value from the subject DN in the DAC should match the dac_origin_vendor_id field. - The VendorID value from the subject DN in the PAI should match the dac_origin_vendor_id field. - The ProductID value from the subject DN in the DAC should match the dac_origin_product_id field. - The ProductID value from the subject DN in the PAI, if present, should match the dac_origin_product_id field.

Threat T185: DCL Denial of Service. [CM169]

The Message Integrity Check is included in the Message Footer and serves to verify the integrity of the message during transmission. It ensures that the message has not been altered or corrupted en route.

Bridged Devices can have their software updated independently of the Bridge through Bridge Manufacturer-specific means. These updates may result in changes to their capabilities, such as supported clusters and/or attributes for an endpoint.

"Action Flow" refers to the direction flow of actions.

Use DNS-SD for service discovery.

A cluster is a building block of the data model, defining an interface or service with attributes, commands, etc.

Despite the possibility of collisions in Group Session IDs within the fabric, precautions are in place to mitigate the impact on message authentication. To address collisions, all valid, installed Operational Group Key candidates referenced by the given Group Session ID are attempted for decryption until authentication is passed or no more keys remain. While the chance of a Group Session ID collision is 2^-16, the probability of both a collision and the message MIC (Message Integrity Code) matching two different Operational Group Keys is 2^-80. These probabilities indicate a low likelihood of collision-related authentication failures. By systematically attempting decryption with potential keys, the system ensures robust authentication while efficiently managing potential collisions in Group Session IDs.

Multiple WriteRequestMessages can be sent in a single transaction, with all but the last message having the MoreChunkedMessages flag set to 'true'.

Example TLV encoding for both manufacturer-specific and Matter-common elements is provided, along with the resulting byte representation.

The "get_isd_from_message" function initializes the ISD structure with default values and then determines the AuthMode based on the session metadata retrieved using the session ID from the incoming message. Depending on the AuthMode, it populates the Subjects list accordingly. If the AuthMode is Group, it verifies group membership against the Group Key Management Cluster.

The TLV Type for InvokeResponseIB is Structure (Anonymous).

- The preferred method leaves more space for content in the commonName attribute type. - It is less ambiguous, which may allow simpler processing of certificate issuance policy validations in CAs that support the Matter-specific RelativeDistinguishedName attributes. - It simplifies the audit of certificates where Vendor ID and Product ID appear.

The Exchange Layer matches incoming messages to existing Exchanges by comparing the message properties with the criteria for participation in an Exchange, including matching the Exchange ID, session association, and Exchange Role.

The R Flag should be set on a message in MRP when the upper layer requests a reliable message over a UDP transport.

The Protocol ID field is an unsigned integer value identifying the protocol in which the Protocol Opcode of the message is defined. It specifies the protocol namespace for the message. When the Protocol Vendor ID is the Matter Standard Vendor ID, the Protocol ID corresponds to predefined values specified in Table 12, such as PROTOCOL_ID_SECURE_CHANNEL for the Secure Channel Protocol.

The Basic Information Cluster provides attributes and events for determining basic information about Nodes, supporting both Commissioning and operational determination of Node characteristics, such as Vendor ID, Product ID, and serial number, which apply to the whole Node.

Matter was created with security and privacy as key design tenets.

Examples of Subjects include passcodes, source nodes authenticated by CASE sessions, and destination groups authenticated by Operational Group Keys.

The Global Unencrypted Message Counter is used to generate counters for unencrypted messages.

In the Message Reliability Protocol (MRP), message counters allow receivers to identify messages for acknowledging their receipt.

1. Check if the P Flag is set. If not, no action is taken. <br> 2. Obtain the Privacy Key associated with the Encryption Key used to secure the message. <br> 3. Execute the encryption operation specified in Section 3.7.1, "Privacy encryption", using the obtained Privacy Key, the MIC from the message security protection, the PrivacyNonce, and the message header fields. <br> 4. Use the obfuscated output as the final private message.

The purpose of certification is to ensure a consistent expectation of behavior from a proxy device. Certified proxies may claim compatibility against the Subscription Proxy device type.

The ProtocolId of Protocol-Specific Status indicates the protocol-specific status being reported.

The ICD operating mode is designed to optimize network traffic, reachability, and power consumption for devices that are intermittently connected to the network due to factors like duty cycling, intermittent network availability, device mobility, or intermittent power availability.

PASE messages use PROTOCOL_ID_SECURE_CHANNEL as the Protocol ID and the corresponding Protocol Opcode specified in Table 16, "Secure Channel Protocol Opcodes."

Both the Commissioner and Commissionee return to step 2 and repeat each step.

The steps include concatenating initiatorRandom, rootPublicKey, fabricId, and nodeId, obtaining the appropriate IPK Operational Group Key, and computing the destinationIdentifier using Crypto_HMAC().

Before invoking the ConnectNetwork command in non-concurrent commissioning, the client should re-invoke the Arm Fail-Safe command with a duration that meets specific time requirements.

Information about supported clusters on a node's endpoints can be obtained through the Descriptor Cluster.

Matter: Binding, HomeKit: Event subscription, Weave: Subscription, Thread: Link, Zigbee: Binding

An array of Product IDs which are covered by the same certification.

The TimeSource attribute indicates the method the node is using to sync time and provides information about the time source, including whether it uses NTS, and whether it's internal or external to the Matter network.

The two categories of element types in the Matter TLV format are primitive types and container types.

The MaxInterval field must respect the constraint: MinIntervalFloor ≤ MaxInterval ≤ MAX(SUBSCRIPTION_MAX_INTERVAL_PUBLISHER_LIMIT, MaxIntervalCeiling).

The RouteTableStruct type contains information about routes in a Thread network, including addresses, path cost, and link quality indicators.

A factory reset is not considered a restart for persistence. It is a deliberate behavior to reset persistent data back to its original state when the product left the factory.

When a specification is marked as provisional, it means that there may be sections of the specification text (or smaller pieces of a section) that are not certifiable at that stage. These sections (or smaller pieces) are identified as provisional prior to publishing the specification. The specification uses well-defined notation to mark Provisional Conformance or notes a section of text with the term "provisional".

They use the ArmFailSafe and CommissioningComplete commands of the General Commissioning Cluster.

The Custom Flow element specifies the Device Commissioning Flow and guides the Commissioner on whether steps are needed before commissioning can take place. It is a 2-bit unsigned enumeration included in machine-readable formats.

Abstract Syntax Notation 1 (from ITU ASN.1)

The originator uses the operational group key with the second newest EpochStartTime, if one exists; otherwise, it uses the single operational group key available.

The TestEventTriggersEnabled attribute indicates whether the Node has any TestEventTrigger configured.

A Node's access to other Nodes can be revoked by removing the associated Node ID from Access Control Entry subjects.

Section 4.7.1 specifies the parameters for data confidentiality and integrity cryptographic primitives to be used in securing Matter messages.

Yes, a Node may adjust the Last Known Good UTC Time backwards if it believes the current time is incorrect and has a good time value from a trusted source, with restrictions to not set the time before the build timestamp of its software or the not-before timestamp of its operational certificates.

The RxAddressFilteredCount attribute indicates the total number of received unique MAC frame requests that have been dropped as a result of MAC filtering.

A utility device type supports configuration and settings, defining requirements for utility clusters and possibly representing the physical device or product.

Access Point

It indicates a command defined in a cluster specification and shall be a Manufacturer Extensible Identifier.

Unless otherwise specified, the CASE, PASE, User-Directed Commissioning protocol, and Secure Channel Status Report messages are the only allowed unencrypted messages during the session establishment phase.

A Commissioning Channel is a secure communication pathway used specifically for the Commissioning process, ensuring secure and private establishment of network credentials and settings.

The BTP Client exclusively uses the GATT Write Characteristic Value sub-procedure to send data to the server, while the BTP Server exclusively uses the GATT Indication sub-procedure to send data to the client.

The ResetCounts command resets the following attributes to 0: BeaconLostCount, BeaconRxCount, PacketMulticastRxCount, PacketMulticastTxCount, PacketUnicastRxCount, and PacketUnicastTxCount.

An interaction is defined as a sequence of one or more transactions between nodes, occurring within the context of an accessing fabric or no fabric, in this section.

Figure 26 shows the state machine for BTP session management of a BTP Client Device.

During a commissioning window, the Node maintains its existing configuration, such as its operational network connection and identities, and allows normal interactions from other Nodes.

The ChangeType field indicates the type of change as appropriate.

Upon subscription activation, the minimum and maximum interval parameters determine the timing and expectation of subsequent Report transactions.

Interactions reporting event records can be filtered by event ID and/or event number.

The Length (LEN) field in ReceiveAccept messages specifies the length of the transfer. If a definite length was indicated by the Initiator, this field will contain the proposed length. Otherwise, it indicates the remaining file size or 0 for indefinite length.

The key distribution Administrator plays a crucial role in the operational group keys mechanism by overseeing the reliable distribution of select epoch key material to appropriate participants within the network. It is assumed that the key distribution Administrator possesses all epoch keys, maintains knowledge of the group security domain members requiring access to these keys, and is tasked with pushing updates of these credentials to all authorized Nodes in the managed groups. Responsibilities of the key distribution Administrator include managing the distribution of key material using the Group Key Management Cluster and ensuring that key holders can access the necessary information through Attributes with Access Control List (ACL) entries. This ensures that only authorized entities, such as the Administrator, can access the key material, maintaining the security of the key distribution process.

Commands from the Node Operational Credentials Cluster are used to install, update, and remove Node Operational credentials. Initial credentials are received through the AddNOC command during commissioning, updated with the UpdateNOC command, and removed with the RemoveFabric command.

The Subscribe Response Action activates the subscription in the Subscribe Interaction.

Tag 16 corresponds to the matter-node-id attribute, which certifies the identity of a Matter Node Operational Certificate (NOC).

A CAT is a special subject distinguished name within the Operational Certificate shared during CASE session establishment, functioning as a group-like tag.

The Path field in CommandDataIB and CommandStatusIB must indicate a concrete path.

It indicates the participation of this power source in providing power to the Node as specified in PowerSourceStatusEnum.

The IsUrgent field in EventFilterIB indicates whether the event is urgent.

The AttributeList attribute is a list of the attribute IDs supported by the cluster instance.

The Axis field indicates the angle of the axis of rotation, or null to not change the angle.

Yes, a Matter device can be a member of multiple fabrics, having multiple associated node IDs. This strategy allows for unambiguous resolution of names and credentials.

Individual protocols define the contents of the ProtocolData section and how it is handled.

The elements are CommandPath and CommandFields.

The CommandStatusIB is used to indicate the status of a command response, including whether the command was executed successfully, encountered errors, or was invalid.

The EventRequests parameter provides a list of zero or more request paths to cluster events.

The Diagnostic Logs Cluster should be implemented once for each Node.

OTA updates provide mechanisms for informing OTA Requestors about available OTA Providers, acquiring information about available OTA Software Images, obtaining OTA Software Images through a local proxy, supporting legacy update methods, allowing deferred installation, and obtaining user consent before offering Software Images.

The default values for the MRP parameters are as follows: MRP_MAX_TRANSMISSIONS: 5, MRP_BACKOFF_BASE: 1.6, MRP_BACKOFF_JITTER: 0.25, MRP_BACKOFF_MARGIN: 1.1, MRP_BACKOFF_THRESHOLD: 1, MRP_STANDALONE_ACK_TIMEOUT: 200 milliseconds.

The CurrentMaxRate attribute indicates the current maximum PHY rate of transfer of data in bits-per-second.

Resulting operational group key derived from rootPublicKey, fabricId, and IPKEpochKey.

A status code of 0x8B indicates that the indicated data field or entry could not be found.

If an attempt is made to create an entry with more targets than the node can support, it will result in a RESOURCE_EXHAUSTED error, and the entry will not be created.

It indicates the type of current the Node expects to be provided by the hard-wired source.

Typically, the Global Unencrypted Message Counter is stored in RAM, making it subject to loss whenever the system reboots or loses its state.

A Fabric ID identifies a specific fabric within the Matter ecosystem.

An action in a transaction must have a target destination, which can be either a single node (unicast action) or a group of nodes (groupcast action).

The Cluster ID for the Diagnostic Logs Cluster is 0x0032.

The HardwareVersion Attribute specifies the version number of the hardware of the Node, with the meaning and versioning scheme defined by the vendor.

The RebootCount attribute indicates a best-effort count of the number of times the Node has rebooted.

The responder generates the session identifier (ResponderSessionId) for subsequent identification of the session. It must not overlap with any other existing PASE or CASE session identifiers in use by the responder.

The encoding of the ProtocolData portion of the payload depends on the ProtocolId and potentially ProtocolCode. To decode this data, the ProtocolId has to be examined, and decoding SHALL be done according to that protocol specification. For example, a vendor-specific protocol would encode additional custom error metadata in the ProtocolData, while the Bulk transfer (BDX) protocol does not require additional error information and will always have ProtocolData empty.

Matter: End Device, HomeKit: End Device, Weave: (Not Applicable), Thread: End Device, Zigbee: (Not Applicable)

A list of entries in the Access Control Cluster expressing individual rules which grant privileges to access cluster elements.

The Passcode-Authenticated Session Establishment (PASE) protocol aims to establish the first session between a Commissioner and a Commissionee using a known passcode provided out-of-band. This protocol leverages an augmented Password-Authenticated Key Exchange (PAKE) in conjunction with a shared passcode to generate shared keys.

Crypto_DRBG() can be implemented using one of the DRBG algorithms from NIST 800-90A: CTR DRBG with AES-CTR, HMAC DRBG with SHA-256 or SHA-512, or Hash DRBG with SHA-256 or SHA-512.

The Attestation Elements contain metadata related to attestation, encoded in Matter TLV, while the Attestation Information is the combination of a Matter TLV payload containing the Attestation Elements and a signature over an attestation_tbs message containing the in-band-transmitted attestation_elements_message and a secret out-of-band Attestation Challenge.

The Protocol Opcode field is an unsigned integer value identifying the type of the message. It is interpreted relative to the Matter protocol specified in the Protocol ID field. Opcodes are defined by the corresponding Protocol specification, such as the Secure Channel Protocol.

Devices include protection against known remote attacks that can be used to extract or infer cryptographic key material, if such protection exists.

Unless stated otherwise, all context tags shall be emitted in the order as defined in the appropriate specification to reduce receiver side complexity in dealing with arbitrary order tags.

Access Control Entries are revised by updating the ACL with new entries reflecting the revised privileges and targets.

The Classification of the Group Key Management Cluster is as follows: Hierarchy - Base, Role - Utility, Scope - Node, PICS Code - GRPKEY.

The System Model Specification aligns with current cluster specifications in the ZCL and facilitates cluster updates and evolution into a unified set of data models.

An MEI has a format with a 16-bit prefix that encodes the source and a 16-bit suffix that encodes an item's key. The MEI permits encoding of approximately 65K keys in the suffix.

The number of RDN attributes in the subject field of a Matter certificate shall not exceed five.

A version indication provides versioning of the payload, ensuring compatibility and allowing for future changes. The version for machine-readable formats is 3 bits with an initial version of 0b000, while the version for Manual Pairing Code is 1 bit with an initial version of 0b0.

They ensure secure commissioning and a familiar user experience. However, they should not be easily accessible, such as printed on the device.

Certainly! Here are examples of how StatusReport messages are presented in protocol specifications: - No ProtocolData present: - Example 1: StatusReport(GeneralCode: FAILURE, ProtocolId: BDX, ProtocolCode: START_OFFSET_NOT_SUPPORTED) - Encodes as: 01 00 02 00 00 00 52 00 - Example 2: StatusReport(GeneralCode: SUCCESS, ProtocolId: {VendorID=0xFFF1, ProtocolId=0xAABB}, ProtocolCode: 0) - Encodes as: 00 00 BB AA F1 FF 00 00 - Additional ProtocolData present: - Example: StatusReport(GeneralCode: FAILURE, ProtocolId: {VendorID=0xFFF1, ProtocolId=0xAABB}, ProtocolCode: 9921, ProtocolData: [0x55, 0x66, 0xEE, 0xFF]) - Encodes as: 01 00 BB AA F1 FF C1 26 55 66 EE FF

In a Matter certificate, each relative distinguished name (RDN) is always encoded as a single DN attribute, which may be a set of one or more DN attributes.

Authenticated Encryption with Associated Data

Matter is a unified, open-source application-layer connectivity standard designed to facilitate the connection and development of reliable, secure ecosystems among smart home devices.

The technical details for each counter type are described in the following sections.

For non-composed device types, each affected endpoint has a TagList with distinct tags. In composed device types, disambiguation is achieved similarly, with each affected endpoint having a TagList and additional PartsList to indicate relationships and disambiguate sibling endpoints.

An array is an ordered collection of member elements that may not have distinct meanings, or whose meanings are implied by their encoded positions in the array.

The RotateEnum type has three values: Off (deprecated), Clockwise, and CounterClockwise.

The SetUTCTime command is used by Administrators to set the time on a node.

Derived types (excluding strings) are encoded according to their base type.

The ExtAddress field specifies the IEEE 802.15.4 extended address for the node corresponding to the route table entry.

The RemoveNetwork command is used to remove the network configuration from the Cluster if there was already a network configuration with the same NetworkID.

A proxy should have only one subscription to a given source regardless of the number of subscription requests from clients.

The IsPAA field is set to true if the revocation information distribution point relates to a PAA, otherwise it is set to false, indicating it relates to a PAI, not a PAA.

The purpose of OTA Software Update is to enable IoT devices to receive security and functional feature updates during their lifetime.

The AddNOC command automatically creates an Access Control Entry during commissioning. This entry grants Administer privilege for the entire Node to the appropriate CASE authenticated Subject, which is typically the Node ID, on the corresponding Fabric.

The ID of the event is 0x01, and its name is NetworkFaultChange.

The subject key identifier extension shall be present.

The listed transactions include Read Transaction (request for cluster attribute and/or event data), Subscribe Transaction (creates a subscription to cluster attributes and/or events), Report Transaction (maintains a subscription for the Subscribe interaction), Write Transaction (modifies cluster attributes), and Invoke Transaction (invokes cluster commands).

No, the ProtocolData section in a Status Report message is optional and may include any additional information that a protocol requires.

- A PAI SHALL be assigned to a Vendor ID value. - A PAI MAY further be scoped to a single ProductID value. - If a PAI is used for multiple products, then it cannot be scoped to a ProductID value, otherwise the Device Attestation Procedure will fail policy validations.

The sender sets various fields in the Message Header as specified, creates a new synchronization exchange, sets a challenge field value using Crypto_DRBG, arms a timer for synchronization response, and sends the request message over UDP to the destination.

Attempting to write an entry with AuthMode set to PASE will fail with a status code of CONSTRAINT_ERROR, as the PASE AuthMode is reserved for future use.

The IdentificationDeclaration message provides the DNSSD Instance Name of the commissionee requesting commissioning to the commissioner selected by the user.

Yes, the package may be referenced by inclusion in vertical protocol stack specifications.

Yes, endpoint components of attribute paths may undergo expansion, subject to constraints within specific actions and contexts, as outlined in this section.

A profile-specific tag is a 64-bit number composed of a 16-bit Vendor ID, a 16-bit profile number, and a 32-bit tag number.

Reliability in the BDX protocol is ensured through features of the underlying message layer, with sessions being aborted if messages fail to be delivered within specified parameters.

The OperationalDataset in the AddOrUpdateThreadNetwork command contains the Thread Network Parameters, including channel, PAN ID, and Extended PAN ID.

The Revision History provides a record of changes made to the cluster. The global ClusterRevision attribute value is the highest revision number.

It's derived from an octet string corresponding to the full 16 octets in network byte order as defined by RFC 4291.

Nodes that wish to be notified of changes in Bridged Devices should monitor changes to attributes like DeviceTypeList, PartsList, ServerList, and ClientList in the Descriptor cluster on the root node endpoint and the endpoint holding the Aggregator device type.

The KeySetWrite command validates several conditions against the content of the GroupKeySet field, including null checks, length checks, and epoch time checks.

String types are encoded using the TLV UTF-8 string type.

The Rotate field indicates the rotation direction or null to not change the direction.

Validating the signature in a Matter certificate involves logically converting it to the corresponding X.509 certificate to recover the original tbsCertificate of the basic syntax signed by the Certificate Authority (CA).

The Protocol Message format includes fields such as Exchange Flags, Protocol Opcode, Exchange ID, Protocol Vendor ID, Protocol ID, Acknowledged Message Counter, Secured Extensions, and Application Payload. These fields identify the semantic meaning of the message, associate it with a particular exchange, provide security information, and contain the actual application-specific data or commands.

The PacketUnicastTxCount attribute indicates the number of unicast packets transmitted by the Node.

Defined in Section 4.2.2, “Matter Node Behavior”.

- Unknown elements are ignored and skipped. - Elements must be present according to their conformance. - Elements that are present and conformant are processed.

The OTA Requestor's likelihood of success increases by applying a previously transferred Software Image (Section 11.19.3.6).

It contains a trusted list of revocation distribution points.

- ID: 0x00, Name: AccessControlEntryChanged (Priority: INFO, Access: S, Conformance: A, Quality: M) - ID: 0x01, Name: AccessControlExtensionChanged (Priority: INFO, Access: S, Conformance: A, Quality: M)

The DataVersion tag specifies the version of the data being transmitted and can be omitted if tag compression is enabled, in which case, it is set based on the previous AttributeDataIB with compression disabled.

A proxy is identified by the Subscription Proxy Device Type.

Binding is A persistent attachment between an instance on one Node to one-or-more cor­ responding instances on another (or the same) Node.

The CSRResponse command is generated in response to a CSRRequest Command. It contains NOCSRElements and AttestationSignature fields. The NOCSRElements field contains the serialized nocsr_elements_message octet string, while the AttestationSignature field contains the necessary attestation_signature as described in Section 11.17.4.9, “NOCSR Information”.

The other fields of the Protocol Header for PASE messages are not specific to PASE and follow general protocol specifications.

Matter ensures agility by abstracting all cryptographic primitives in the core specification, allowing for future adoption of new cryptographic primitives without changing the entire specification. The modular design of the protocols also enables the replacement of protocols with new ones in response to evolving security risks and threats.

Threat T230: Spurious commands sent to a Device. [CM244]

NFCForum-TS-NDEF 1.0: Data Exchange Format (NDEF) Technical Specification by NFC Forum outlines the framework for exchanging information between NFC devices. URL: https://nfc-forum.org/our-work/specification-releases/specifications/nfc-forum-technical-specifications

NFCForum-TS-RTD 1.0: Record Type Definition (RTD) Technical Specification by NFC Forum, provides the standard for defining the type of data stored in an NDEF record. URL: https://nfc-forum.org/our-work/specification-releases/specifications/nfc-forum-technical-specifications/

NFCForum-TS-RTD URI 1.0: URI Record Type Definition Technical Specification by NFC Forum, specifies the format for storing URIs in NDEF records for NFC tags. URL: https://nfc-forum.org/our-work/specification-releases/specifications/nfc-forum-technical-specifications/

NIST 800-38A: NIST SP 800-38A Recommendation for Block Cipher Modes of Operation: Methods and Techniques, details block cipher modes for secure data encryption. December 2001. URL: https://nvlpubs.nist.gov/nistpubs/Legacy/SP/nistspecialpublication800-38a.pdf

NIST 800-38C: NIST SP 800-38C Recommendations for Block Cipher Mode of Operation: The CCM Mode for Authentication and Confidentiality, provides guidance on using CCM mode for data security. May 2004 (errata update 2007). URL: https://nvlpubs.nist.gov/nistpubs/Legacy/SP/nistspecialpublication800-38c.pdf

NIST 800-90A: NIST SP 800-90A Rev. 1 Recommendation for Random Number Generation Using Deterministic Random Bit Generators, covers the generation of cryptographic keys. URL: https://csrc.nist.gov/publications/detail/sp/800-90a/rev-1/final

NIST 800-90B: NIST SP 800-90B Recommendation for the Entropy Sources Used for Random Bit Generation, focuses on entropy sources for secure random bit generation. URL: https://csrc.nist.gov/publications/detail/sp/800-90b/final

NIST 800-132: NIST SP 800-132 Recommendation for Password-Based Key Derivation, Part 1: Storage Applications, provides guidelines for secure password storage techniques. December 2010. URL: https://nvlpubs.nist.gov/nistpubs/Legacy/SP/nistspecialpublication800-132.pdf

NIST 800-186: NIST Draft SP 800-186 Recommendation for Discrete Logarithm-Based Cryptography, discusses cryptographic algorithms based on discrete logarithms. October 2019. URL: https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-186-draft.pdf

RFC 1350: The TFTP Protocol (Revision 2), defines the standards for the Trivial File Transfer Protocol used in simple file transfers over a network. URL: https://www.rfc-editor.org/rfc/rfc1350

The "Success" value indicates that the reason for a state change is the success of a prior operation.

The Controller Node on the Fabric MAY send commands to the associated clusters on one or more endpoints on the Bridge's Node.

The 'WiredFaultChange' event is generated when the set of wired faults currently detected by the Node on this wired power source changes.

The AcceptedCommandList attribute is a list of client-generated commands supported by the cluster server instance.

The Interaction Model Specification package includes Data Model, Interaction Model, System Model, Cluster Library, and Device Library.

The InvokeRequests tag in InvokeRequestMessage contains an array of CommandDataIB, specifying the commands to be invoked.

The default value for PROXY SCAN RESPONSE JITTER is 1000 milliseconds, and for PROXY SCAN PERIOD, it is 1100 milliseconds.

The Weighting attribute indicates the Thread Leader Weight used when operating in the Leader role.

In the hypothetical scenario, manufacturer A extends a standard cluster with additional statistics by adding lifetime counts as attributes and quartiles Q1, Q2, and Q3 to the standard SummarizedStats struct, making these quartiles available for all existing instances of the standard struct.

The current transaction and interaction are terminated if the Status Response Action is generated with an error status, which occurs as a result of the immediate previous received action in the current transaction.

The presence of the same CASE Authenticated Tag value with two different version numbers in the subject DN makes the example illegal.

Extra endpoints in the PartsList may extend the device type implementation beyond the required composition, providing additional functionality or features.

The Group Key Management cluster manages group keys for the node. It maintains a list of groups supported by the node, where each group entry includes a single group ID and group key. Modifications to the group list require Administer privilege. Additionally, each group entry includes a membership list of endpoints that are members of the group on the node. The modification of this membership list is done via the Groups cluster, scoped to an endpoint.

The Sigma2 key is generated by hashing a transcript and applying a key derivation function (Crypto_KDF) to derive the key. The input key is the SharedSecret, and the salt includes the IPK, Responder Random, and other values.

Threat T153: Commissioner/Administrator adds untrustworthy Root CA to Node. [CM36]

Matter certificates specify certain attribute types for relative distinguished names and cryptographic algorithms using a simplified structure, without the full ASN.1 OID specification.

The send-acknowledgement timer ensures that a peer always receives acknowledgements for sent packets before its acknowledgement-received timer expires, thereby maintaining the health of the connection.

The Privacy Nonce, used for Privacy Processing, is constructed as a concatenation of the 16-bit Session ID (in big-endian format) and the lower 11 bytes of the Message Integrity Check (MIC). It is created as a CRYPTO_AEAD_NONCE_LENGTH_BYTES-octet string. For example, if the Session ID is 42 and the computed MIC is provided, the PrivacyNonce would be formed by concatenating the Session ID with the lower 11 bytes of the MIC.

The TxDataCount attribute indicates the total number of unique MAC Data frame transmission requests.

The OperationalDatasetComponents type contains flags indicating which components of the Thread operational dataset are present on a node.

All Devices include a randomly generated setup passcode and a corresponding passcode verifier derived from the setup passcode via a PBKDF.

The purpose is to track revisions of the cluster specification.

The Proxy All Nodes field indicates whether the proxy should proxy all nodes when set to true, ignoring the SourceList attribute.

The outgoing Read Request Action must be unicast and generated as the first action in a Read transaction. Additionally, the requested attribute and event paths must be valid, and paths targeting a group are not allowed.

The System Model Specification originates from the Dotdot Architecture Model and Chapter 2 of the Zigbee Cluster Library specification, defining first-order elements and namespaces for endpoints, clusters, attributes, etc.

Message counters are assigned sequentially, by monotonically increasing the counter value maintained by the sender of the message.

A GID is a 16-bit number that identifies a set of Nodes across a Fabric at the message layer and can be bound to one or more Endpoints within each Node at the interaction layer.

For CASE messages, the I Flag values are set as follows: 1 for CASE Sigma1, 0 for CASE Sigma2 and CASE Sigma2_Resume, and 1 for CASE Sigma3. For SigmaFinished messages, the value of the I Flag depends on whether the status message is sent by the Initiator or the Responder.

The Global Group Encrypted Control Message Counter is used to generate message counters for encrypted control messages sent to a group.

BlockAck and BlockQuery in the BDX protocol fulfill the role of application-layer control flow and acknowledgment, rather than providing reliability and retransmission.

The Basic Constraint extension is marked critical with CA:TRUE, and the 'pathLen' field is set to 1.

Grouping and available actions are typically provided by the user or Bridge manufacturer via means not defined in Matter, and therefore provided as read-only to Nodes. For example, a manufacturer-provided app allows a user to set up logical grouping and create/assign scenes for such groups.

An On/Off Plug-in Unit is a device capable of being switched on or off by means of a bound controller device such as an On/Off Light Switch or a Dimmer Switch. It is typically used to control a conventional non-communicating light or other appliances by switching its mains connection.

The CSRRequest command is generated to execute the Node Operational CSR Procedure and subsequently return the NOCSR Information as a CSRResponse command.

The Fixed Label Cluster has the LabelList attribute.

Status code 0x92 indicates that the cluster instance data version did not match the request path.

The TxAckRequestedCount attribute indicates the total number of unique MAC frame transmission requests with requested acknowledgment.

All PASE messages must be sent reliably, which can be achieved either implicitly (e.g., using TCP) or explicitly (e.g., using MRP reliable messaging) in the underlying transport.

The responder initializes its Local Message Counter, Message Reception State, sets the synchronized max_message_counter of the peer to 0, and sets SessionTimestamp.

Access Control Entries should not be used to encode application-level permissions and configurations such as smart lock PIN codes.

A transaction is either the entirety or part of an interaction, consisting of a sequence of one or more actions. Actions within a transaction are defined as first or following to better describe dependencies in the specification.

The Message Counter field, an unsigned integer value, uniquely identifies the message from the perspective of the sending node. It increases monotonically for each unique message generated and remains the same for retransmitted messages. Acknowledgements refer to the values of the message counter being acknowledged. The Message Counter is scoped to a given encryption key and is independent for control messages and data messages.

A Fabric ID is a 64-bit number that uniquely identifies a Fabric within the scope of a particular root CA, comprising the public key of the root CA and the Fabric ID itself.

The subject key identifier of the DAC is 96:C2:D9:24:94:EA:97:85:C0:D1:67:08:E3:88:F1:C0:91:EA:0F:D5.

A node represents a unique, addressable resource on the network with distinct functions and capabilities.

Bootstrapping the source tree is a one-time process that pulls in the third-party dependencies required for Matter development.

It indicates if the battery needs to be replaced.

All certificates SHALL NOT be longer than 400 bytes in their TLV form. This constraint only applies to the NOC chain (NOC, ICAC, RCAC) since the DAC chain (DAC, PAI, PAA) only appears in DER format.

The Message Integrity Check field is a sequence of bytes containing the message integrity check value (MIC) for the message. Its length and byte order depend on the integrity check algorithm specified in Section 3.6, "Data Confidentiality and Integrity." This field is present for all messages except those of Unsecured Session Type. The MIC is calculated as described in Section 4.7.2, "Security Processing of Outgoing Messages."

The nesting of collection data is conceptually unlimited but is well-defined in the cluster specification.

Common action information includes fields such as InteractionModelRevision, Action ID, Transaction ID, Fabric Index, Source Node, Destination Node, Destination Group, and action-specific variable information.

The revisions mentioned in the revision history of the On/Off Plug-in Unit device are: - 0 Represents device definitions prior to Zigbee 3.0 - 1 Initial Zigbee 3.0 release - 2 New data model format and notation

In the context of the Binding cluster specification, the TargetStruct type specifies four possible target types: Node, Group, Endpoint, and Cluster, each serving a distinct purpose in defining binding relationships between endpoints.

The CommissioningErrorEnum Type indicates particular errors in response commands within this cluster.

CheckInNodeID indicates the NodeID to which Check-In messages will be sent when the MonitoredSubject is not subscribed.

Elapsed Time in seconds is an unsigned 32-bit value that denotes the time elapsed for a specific operation or activity, with its precise definition depending on the context of use.

Matter's modular approach allows for easier maintenance by enabling platform vendors to manage updates to cryptographic suites or robustness requirements introduced in future Matter revisions. This can be done seamlessly through field updates with little impact for the device manufacturer and the user.

It indicates an instance of a device type.

MCSP operates on a simple request/response protocol. When a multicast message with an unknown counter is received, synchronization via MCSP begins by sending a synchronization request via unicast UDP to the multicast message originator’s unicast IPv6 address.

The NetworkIndex field in the ReorderNetwork command contains the 0-based index of the new desired position of the entry in the Networks attribute.

Announcement can be re-initiated via a device-specific user interaction such as a button press or other action defined by the manufacturer.

If the Global Unencrypted Message Counter for a Node is lost, Nodes shall randomize the initial value of this counter on startup as per Section 4.5.1.1, “Message Counter Initialization”.

Reserved bit fields are indicated as zero when conveyed in a message and are ignored when received from another implementation.

Threat T53: Malicious Device off the network interrupts battery powered messages too often and greatly reduces battery life. [CM44, CM51]

Section 4.7.2 describes the process for encrypting Matter messages for transmission, detailing the steps involved in preparing a secure message for transmission.

The base device type requirements for Zigbee are implicit for all device types under the Zigbee protocol.

The WobbleRequest command wobbles the disco ball on its axis at the speed specified in the WobbleSpeed attribute.

Each entry in the Binding attribute represents a binding.

The Data Model layer consists of the data and verb elements supporting the application's functionality, which the Application layer operates on for device interaction.

The Selected ATT_MTU field represents the maximum ATT_MTU for the connection selected by the server as a 16-bit unsigned integer.

The CheckInNodeID field provides the NodeID to which a Check-In message will be sent if there are no active subscriptions matching MonitoredSubject.

The ActiveTimestampPresent field indicates whether the node has an active timestamp present in its operational dataset.

The sender stops the timer upon receiving an authenticated MsgCounterSyncRsp message that matches certain criteria, including the Source Node ID and the Response field corresponding to the Challenge field of the MsgCounterSyncReq message.

An On/Off Light Switch is a controller device that, when bound to a lighting device such as an On/Off Light, is capable of being used to switch the device on or off.

The RxDestAddrFilteredCount attribute indicates the total number of received unique MAC frame requests that have been dropped as a result of a destination address check.

Administrators should take care to use DataVersion conditional writes when administering the list or its contents.

The base device type requirements for Matter are implicit for all device types under the Matter protocol.

The Diagnostic Logs Cluster provides an interface to retrieve unstructured diagnostic logs from a Node, which can be used for diagnostics.

Step 7 involves Re-Assignment, where evicted clients undergo the same proxy discovery/selection process and eventually settle on a new set of proxies.

The signature algorithm used in the PAA certificate is ecdsa-with-SHA256.

The TLV Type for EventDataIB is Structure.

The Reachable Attribute indicates whether the Node can be reached. It's usually True for native Nodes, but in a derived Bridged Device Basic Information cluster, it indicates whether the bridged device is reachable over the non-native network.

The two patterns for endpoint composition are the tree pattern and the full-family pattern.

Matter: Broadcast, HomeKit: Broadcast, Weave: Broadcast, Thread: (Not Applicable), Zigbee: (Not Applicable)

The Privilege field in the AccessControlEntryStruct type specifies the level of privilege granted by the access control entry, determining the actions and operations permitted for entities identified in the associated targets.

When DeltaSystemTimestamp is present, all other timestamp tags are omitted.

The ICD key/value pair indicates whether the Node supports the ICD Long Idle Time operating mode. It has two valid values: '0' for "ICD Long Idle Time operating mode not supported" and '1' for "ICD Long Idle Time operating mode supported". This key/value pair ensures efficient network communication by specifying the Node's support for a particular idle time operating mode.

Counter mode of encryption with CBC-MAC (AEAD mode) (from NIST 800-38C)

The NOCValue and ICACValue fields are validated by verifying the certificates and ensuring the public key of the NOC matches the last generated operational public key.

Remote UIs, like mobile apps or web interfaces, can be used.

In MRP, each time a message requiring acknowledgment is sent, a new retransmission context record is inserted into the retransmission table, or an existing record is updated to increment its send count.

The architecture model provides mechanisms for non-standard or manufacturer-specific items such as clusters, commands, events, attributes, and attribute data fields.

The purpose of encoding items into sigma-2-tbsdata is to prepare data for further verification and processing by the initiator.

Detailed factory reset requirements can be found in the following sections: <br> - Section 6.4.3, “Node Operational Identifier Composition” <br> - Section 6.4.10, “Security Considerations” <br> - Section 6.6.3, “Access Control List Examples” <br> - Section 7.12.1, “Persistence” <br> - Section 7.14, “Event” <br> - Section 11.11, “General Diagnostics Cluster” <br> - Section 11.19.4.2, “Image Verification”

The VendorLandingPageUrl field, when provided, contains a link to a maintained web page containing more information about the device manufacturer, such as contact information and address.

If the discovering Node supports the device type of a Bridged Device, it MAY add this Bridged Device to the list of devices it could interact with or configure.

The AdminPasscodeID field represents the Passcode ID of the Administrator that made the change, if the change occurred via a PASE session.

Unsecured rendezvous are enabled by a user action and, upon time-out or commissioning failure, will cause deletion of any state information.

The compression schemes applied to EventReports include tag compression for Path, omitting EventNumber if consecutive, and using Delta tags for timestamps.

In the LabelList example, the fields are derived from other attributes or sources.

The Access Control Cluster will fail to write and return an appropriate error if an attempt is made to create or update an Access Control Entry or Access Control Extension with invalid contents.

The Label field contains a label to differentiate multiple revocation information partitions of a particular issuer within the Device Attestation PKI Revocation Distribution Points schema.

Over-the-air (used mostly in context of "Over-the-air Software Update")

Node IDs are 64-bit numbers uniquely identifying Nodes on a Fabric, used for core messaging, within internal APIs, the data model, and resolving operational IPv6 addresses of Nodes.

An OTA Requestor determines which OTA Provider to query using methods of its choosing, such as handling AnnounceOTAProvider commands or expunging stale entries from its OTA Provider list.

The TestEventTriggersEnabled attribute indicates whether the Node has any TestEventTrigger configured.

The delivery of message parts to the interaction layer is implementation-specific, but the requirement is that all information or errors must be submitted to the interaction layer.

The algorithm takes as input the incoming message, the Session ID of the incoming message, a conceptual Sessions Metadata database, and the Group Key Management Cluster.

The Day field represents the day of the month, with note that values 29 to 31 may be invalid depending on the month and year.

Before the first commissioning, such as in a factory-reset state, a device contains no pre-allocated operational roots of trust or operational identities. A special primordial fabric ID is reserved to regularize interactions and solve the bootstrapping problem.

The SoftwareVersionCertificationStatus field indicates the current certification status of a particular software version, with values such as "dev-test", "provisional", "certified", or "revoked".

The subject field in the PAA certificate contains the information: Same as the subject field of the example PAI certificate.

Administrators should be careful to avoid unintended access by ensuring that Access Control Entries are updated atomically to avoid accidental wildcards.

Threat T173: Malicious Device or person attempts to pair with a commissioned device. [CM41, CM152, CM154]

A Fabric Index maps to a specific fabric on a node and is used for identifying the accessing fabric index of an interaction or in fabric-scoped data.

Epoch key rotation serves to enhance security by regularly refreshing the keys used for securing group communication. The key distribution Administrator generates new epoch keys at regular intervals and adds them to the list of existing keys within a group. Each new epoch key is assigned a unique ID and a start time scheduled to occur after a configurable key propagation interval. This rotation process ensures that outdated keys are replaced with fresh ones, mitigating the risk of compromise or unauthorized access. The rotation rate for epoch keys is configurable to meet the security requirements of the application, with typical intervals ranging from days to weeks. Epoch key rotation is managed centrally by the Administrator, who ensures that all Nodes within the operational group receive the updated key list within the propagation interval.

The Fixed Label Cluster allows endpoints to be tagged with read-only labels, while the TagList in the Descriptor cluster provides standardized tags for self-description.

The AttestationResponse Command is generated in response to an AttestationRequest command. It contains AttestationElements and AttestationSignature fields. The AttestationElements field contains the serialized attestation_elements_message octet string, while the AttestationSignature field contains the necessary attestation_signature as described in Section 11.17.4.7, “Attestation Information”.

The mandatory message header values for a Status Report message are: Protocol Vendor ID set to 0 (Matter common Vendor ID), Protocol ID set to 0x0000 (PROTOCOL_ID_SECURE_CHANNEL), and Protocol Opcode set to 0x40 (StatusReport).

The message format of a Status Report message is structured as follows: Length: 2 octets, GeneralCode: 4 octets, ProtocolId of Protocol-Specific Status: Variable, ProtocolCode of Protocol-Specific Status: 2 octets, Optional ProtocolData for protocol-specific additional details: Variable

It provides a unique identifier used to identify an action.

Each endpoint supporting the On/Off Light device type SHALL include the following clusters: - Identify Server - Groups Server - Scenes Server - On/Off Server - Level Control Server - Occupancy Sensing Client

Each message in the BDX protocol is mapped to a unique Protocol Opcode under the PROTOCOL_ID_BDX Protocol ID, with specific values assigned to different types of messages.

Cluster revision enforces compatibility and allows for enhancements without changing basic function.

The ReachableChanged event is generated when there is a change in the Reachable attribute of a bridged device. Its purpose is to provide an indication to interested parties that the reachability of a bridged device over the non-Matter network has changed, allowing them to take appropriate action.

Matter: Fabric, HomeKit: Network, Weave: Fabric, Thread: Partition, Zigbee: Network

Crypto_Transcript computes a transcript TT as specified in SPAKE2+, which includes various cryptographic values and parameters used in the PAKE process, ensuring secure communication.

It's an identifier for a transaction as defined in the Interaction Model specification.

The Duplicate condition is applied when sibling endpoints have overlapping application device types, necessitating disambiguation to avoid confusion.

The Cluster ID of the Access Control Cluster is 0x001F.

The Label field should contain human-readable text suitable for display and be present when MfgCode is not null. It should not be used for standard namespace tags unless further qualification is required.

Test Vendor IDs should not commission devices onto an operational Fabric under normal operation unless the user is fully aware of the security risks associated with commissioning an uncertified device.

Upon receiving Pake2, the initiator computes TT, (cA, cB, Ke), verifies Pake2.cB against cB, sends Pake3 with cA, and waits for PakeFinished from the responder.

Upon receipt of a Read Request Action, this layer generates a Report Data action to the subscriber, as defined in the processing rules for incoming Read Request and Subscribe Request Actions.

Matter: Network Manager, HomeKit: Device / Controller, Weave: Nest Service, Thread: Leader, Zigbee: Network manager

Attributes included in the Basic Information Cluster are: Data Model Revision, Vendor Name, VendorID, Product Name, ProductID, NodeLabel, Location, Hardware Version, Hardware Version String, Software Version, Software Version String, Manufacturing Date, Part Number, Product URL, Product Label, Serial Number, LocalConfigDisabled, Reachable, UniqueID, CapabilityMinima, Product Appearance.

Matter minimizes potential information leakage by sharing only the minimum required data for proper and robust operations, thereby reducing the risk of inadvertent exposure of sensitive information.

A UGID resides in the 16-bit subrange reserved for groups common across the Matter standard, enabling multicast, groupcast, or anycast destinations known to all Nodes on any Fabric.

The next sections describe the functional protocol used to request message counter synchronization with a peer and form responses to such message counter synchronization requests.

The Aggregator device type aggregates endpoints as a collection, providing functionality for the collection of descendant endpoints present in the PartsList of the endpoint’s descriptor.

The Element Requirements section lists qualities and conformance that override the cluster specification requirements for Matter devices. Blank entries denote no change.

If the FabricIndex field does not match any entry within the Fabrics list, the command fails with an InvalidFabricIndex status code.

Concatenates initiatorRandom, rootPublicKey, fabricId, and nodeId, then computes a HMAC using IPK.

No, a ProductID value is not present in either the subject or issuer fields of the PAA certificate.

A Commissionee can discover Commissioners on the network using commands such as dns-sd -B or avahi-browse. To discover all Commissioners, the Commissionee can use _matterd._udp as the service type. Additionally, the Commissionee can filter results to find Commissioners with specific device types or Vendor IDs by appending appropriate subtypes, such as _T<ddd> for device type or _V<vvv> for Vendor ID, to the service type.

The DisableActionWithDuration command has ActionID, InvokeID, and Duration as its data fields.

The fields included in the Invoke Request Action Information are SuppressResponse, TimedRequest, and InvokeRequests.

The SessionTimestamp is a timestamp indicating the time at which the last message was sent or received, and the ActiveTimestamp is a timestamp indicating the time at which the last message was received, both initialized with the time the session was created.

The Root Node device type serves as a "read me first" endpoint, providing information about itself and other endpoints within the node. It defines conformance for a root node endpoint.

Message privacy in Matter is implemented using a block cipher in AES-CTR mode as defined in NIST 800-38A.

A subscription is an ephemeral 'session' between a subscriber and a publisher, which can lose synchronization due to various reasons such as network issues, resets, or resource reclamation.

The Crypto_PBKDF function takes an input (password), salt, number of iterations, and the desired length of the output key in bits.

The minimal supported capabilities, subject to the minimal constraints, are reported in the CapabilityMinima of the Basic Information cluster. For example, if a device type requires at least 4 CASE session contexts and a node supports 7 fabrics, it would support at least 28 CASE session contexts.

The algorithm used in the subjectPublicKeyInfo field of the PAI certificate is the object identifier for prime256v1.

The StatusIB is used to respond with errors or success to actions, with the Status field indicating the status and the ClusterStatus field representing status values defined in a cluster specification.

If the EnableKey field is received with all zeroes, the command shall fail with a response status of CONSTRAINT_ERROR.

The Disconnection event indicates that a Node’s Wi-Fi connection has been disconnected as a result of de-authenticated or dis-association, and it provides the reason for the disconnection.

To prepare a multicast message to a Group ID with a given GroupKeySetID and IPv6 hop count parameter, the Node must obtain the current Operational Group Key and Group Session ID associated with the given GroupKeySetID. If no key is found, security processing fails. Then, the Node performs message transmission processing steps with specific arguments, including the Destination Node Id, Session Id, and Security Flags.

A single logical communication from a source node to one or more destination nodes, conveyed through one or more messages, constitutes an action according to this specification.

The Overview section defines common conformance for all device types, including but not limited to: - Certification programs (e.g., Zigbee, Matter) - Underlying protocol stack (e.g., 802.15.4, Wi-Fi, Thread) - Regional regulations - Interfaces (UI, cloud, etc.) - Scale (e.g., residential vs commercial) - Other common limitations or capabilities (e.g., battery-powered or sleepy nodes)

Matter prioritizes simplicity, ease of purchase, and use, along with interoperability, reliability, and security for both developers and users.

The DNS-SD service type for Matter Commissionable Node Discovery is _matterc._udp.

The 'WiFiBandEnum' data type encodes supported Wi-Fi frequency bands present in the WiFiBand field of the WiFiInterfaceScanResultStruct.

Appendix F contains worked examples of encoding a Certification Declaration, which is conveyed by the Attestation Information payload during the Device Attestation Procedure.

The CertificateChainTypeEnum type is used by the CertificateChainRequest command to convey which certificate from the device attestation certificate chain to transmit back to the client. It includes values such as DACCertificate and PAICertificate.

Matter vendors protect DCL private keys in HSM-equipped servers.

Administer level privilege grants must have an AuthMode's AuthModeCategory of "CASE".

The Node should also implement the BDX Initiator and BDX Sender roles as defined in the BDX Protocol.

The NetworkingStatus field in the ConnectNetworkResponse command indicates the status of the last connection attempt.

Hexadecimal numbers are prefixed with "0x" and binary numbers with "0b". All other numbers are assumed to be decimal unless indicated otherwise.

To perform session resumption in CASE, both the Initiator and Responder must remember specific state information from the previous session, including SharedSecret, Local Fabric Index, Peer Node ID, Peer CASE Authenticated Tags, and ResumptionID.

A Router is a device that provides routing services within its network in cooperation with other Routers, facilitating network communication.

The hardware platform provides core security services such as cryptographic primitives, random number generation, secured cryptographic key storage, and tamper resistance, with varying levels of robustness against attacks depending on the platform.

Proxies can achieve functionality with a single firmware image capable of handling any client, cluster, or type of device.

Vendor ID and Product ID, each a 16-bit value, are included to identify the make and model of the device. These identifiers are used during the commissioning flow, such as during the Device Attestation procedure, and help retrieve device model metadata from the Distributed Compliance Ledger. They are also used to retrieve information relevant to the commissioning flow.

AES-CTR encryption in Matter is performed according to Section 6.5 of NIST 800-38A, with counters generated as specified in Appendix A.3 of NIST 800-38C, using a nonce and the value of q = 2.

The subject field in the PAA certificate contains the information: CN = Matter Test PAA, 1.3.6.1.4.1.37244.2.1 = FFF1

The IsOperational field indicates if the Node is currently advertising itself operationally on this network interface and is capable of successfully receiving incoming traffic from other Nodes.

Certainly. The cryptographic protocol used in CASE mirrors the [SIGMA] protocol by involving the exchange of ephemeral elliptic curve public keys to generate a shared secret, exchanging certificates to prove identities, and demonstrating possession of the NOC private key by signing the ephemeral keys and NOC.

A MATTERoBLE Interface MUST implement BTP as a universally compatible transport mode.

To create a new Exchange based on an incoming message: <br> 1. Create a new Exchange and Exchange Context with appropriate settings. <br> 2. Set the Exchange ID, Exchange Role, and Session Context based on the incoming message properties.

Threat T168: DCL Private Key Exfiltration. [CM163]

The OID notation in the examples follows the structure: iso(1) org(3) dod(6) internet(1) private(4) enterprise(1) zigbee(37244) matter-op-cert(1) node-id(1) for Matter Operational Certificate DN attribute for node identifier.

The rules for encoding Matter-specific attribute types in the subject DN of a Matter certificate vary depending on the certificate type: for NOC, ICA, and Root CA certificates.

There is exactly one VendorID value (FFF1) present in the subject field of the PAI certificate.

The cluster ID mentioned for the "Temp Sensor Client" example is 1026.

Border Routers must manage address and route assignment and advertisement, multicast support, and discovery proxying to facilitate network topology and communication.

Application Group Identifier

A status code of 0x00 indicates that the operation was successful.

The resumption session encryption keys are generated using a key derivation function (Crypto_KDF) applied to the SharedSecret. The input key is SharedSecret, and the salt includes Sigma1.initiatorRandom and ResumptionID.

Defined in Section 9.10.5.3, “ACL Attribute”.

Information Blocks are elements that may apply to multiple message types and are defined in a common way to allow reuse as a definition.

Matter specification details everything necessary to implement an application and transport layer stack. It is intended to be used by implementers as a complete specification but where necessary other references are noted with details on how these references apply to this specification.

It has read access.

The value 1 is associated with the elliptic-curve-id tag for the prime256v1 elliptic curve, corresponding to the ASN.1 OID specifying the curve.

Nodes without synchronized clocks can still participate in epoch key rotation by comparing the start times of received epoch keys and selecting the current key based on the second newest time. This allows them to use the current key for local security interactions until contact is made with the distribution Administrator again. To facilitate communication during key updates, the Administrator should provide a sufficient set of epoch keys to these Nodes, allowing them to maintain communication with other group members while a key update is in progress. Additionally, the Administrator should update all Nodes without synchronized time before activating the new epoch key and then let Nodes with synchronized time transition to the new key at the synchronized start time. By ensuring timely distribution of keys and appropriate updates, communication continuity is maintained across the fabric during key rotation.

A discovery mechanism is provided to determine peer IPv6 addresses and operational parameters during commissioning and unicast communication.

Administrators must exercise caution when managing Access Control Lists (ACLs) with wildcards to avoid unintended access. It is recommended to avoid updating Access Control Entries one by one, as removing Subjects or Targets individually may inadvertently result in a wildcard access. Instead, ACL entries should be written atomically in a single action to ensure a complete final state, either with or without a wildcard, and to prevent accidental wildcards from arising.

User-Intent Commissioning Flow devices must follow rules for Manual Pairing Code and QR Code inclusion. Their Distributed Compliance Ledger entries must include the CommissioningCustomFlow field set to '1 - User Intent' and CommissioningModeInitialStepsHint field set to a non-zero integer value.

After 20 failed attempts, the Commissionee exits Commissioning Mode.

Bridge is A Node that represents one or more non-Matter devices on the Fabric.

Threat T7: IoT device advertises information that can be used to identify, profile, or target a home or a user. [CM6, CM7, CM8]

After verifying the signature, the responder encodes the necessary items into sigma-3-tbsdata and proceeds to generate session keys.

EventDataIB is a TLV structure used to encapsulate the data payload of an event message.

Yes, Nodes are required to persist the Global Group Encrypted Message Counters in durable storage to ensure that the value of the counters never rolls back and is monotonic within the bounds of its range for its use for a given group key.

If the ActiveCalendarType attribute is null, the calendar type is determined by any unit implied through the ActiveLocale attribute. If ActiveLocale is not present, the calendar type is unknown.

After completing the message encoding and encryption, the initiator sends the Sigma3 message with the encrypted data.

The Certification Program Conditions include various tags and descriptions for certification programs such as Zigbee Home Automation (ZHA), Zigbee Smart Energy (ZSE), Zigbee Green Power (GP), Zigbee (Zigbee), SuZi Zigbee PRO Sub-GHz (SuZi), and Matter.

The ThreadMetrics attribute contains a list of ThreadMetricsStruct structs, representing metrics for active threads.

The System Model Specification package includes the Interaction Model, System Model, Cluster Library, and Device Library, all of which are agnostic to underlying layers.

The OTA Requestor should use the ApplyUpdateRequest command to proceed with applying a software update (Section UpdateToken usage).

The PAI certificate includes Basic Constraint (critical, cA:TRUE, pathLen:0), Key Usage (critical, keyCertSign and cRLSign bits set), Authority Key Identifier, and Subject Key Identifier extensions.

MCSP offers the Cache-and-sync policy to provide replay protection even in cases where a Node has been rebooted, at the expense of higher latency.

If there exists a Group Key Set associated with the accessing fabric with the same GroupKeySetID as provided in the GroupKeySet field during KeySetWrite command execution, the contents of that group key set will be replaced.

After 20 failed attempts, the Commissionee exits Commissioning Mode.

The Subjects field in the AccessControlEntryStruct type represents a list of subject IDs, defining the entities or users to which the access control entry applies, specifying who is granted or restricted access based on the defined privileges.

The Action field in the ApplyUpdateResponse command expresses the action that the OTA Provider requests from the OTA Requestor (Section ApplyUpdateResponse Command).

The possible states are Inactive, Active, Paused, and Disabled.

The minimum iterations are set to 1,000, and the maximum iterations are set to 100,000.

Manufacturer-specific extensions are identified using an MEI with a prefix for that particular manufacturer and must adhere to constraints, such as being permitted only on standard clusters or another MS extension of a standard cluster from a different manufacturer.

Unicast sessions exist in the Session Establishment Phase and the Application Data Phase.

Event records are buffered on the node with priority given to events of a higher priority level, and newer events overwriting older events within a priority level if there is insufficient space.

The BTP Service UUID is used to specify the actual contents of the packets transmitted over Bluetooth Transport Protocol. For Matter Message frames, the BTP Service UUID is specified as MATTER_BLE_SERVICE_UUID.

Upon receiving Msg1, the responder performs several validation steps. First, if Msg1 contains either a resumptionID or an initiatorResumeMIC field but not both, the responder sends a status report indicating an invalid parameter. Then, it sets the Peer Session Identifier in the Session Context to the value of Msg1.initiatorSessionId. If both the resumptionID and initiatorResumeMIC fields are present, it searches for an existing session with a Resumption ID matching the incoming resumptionID. If found, it follows a different validation procedure specified in the document. Otherwise, it continues with the standard validation process.

The LabelList attribute is used to represent labels associated with endpoints or clusters, providing additional information or metadata.

A length field, present for string types, gives the length of the element’s value field in octets.

The SoftwareFault Event indicates a software fault occurrence on the Node.

The context-specific tags not-before [4] and not-after [5] are used to identify the not-before and not-after fields, respectively.

The responder verifies that the NOC in TBEData3.initiatorNOC and the ICAC in TBEData3.initiatorICAC meet specific constraints, including matching Fabric IDs and chaining back to the Trusted Root CA Certificate.

The FabricIndex Field is used for fabric-scoped data and is included in all reported data that is defined as fabric-scoped.

Use the manufacturer's app to install new firmware and a unique certificate into the device.

If the OTA Requestor is still attempting to discover an OTA Update, it may choose to attempt a QueryImage command on a different OTA Provider in its OTA Provider List, following timing constraints (Section 11.19.3.6).

Long Idle Time ICDs are provisional.

Unencrypted messages use a similar duplicate detection algorithm as encrypted messages, albeit more permissive. Any message counter equal to max_message_counter or within the message counter window, where the corresponding bit is set to true, is considered duplicate. All other message counters, whether behind the window or ahead of max_message_counter, are considered new and update max_message_counter.

The EnableTagCompression tag is used to select between two different interpretations on the receiver when certain tags are omitted, indicating wildcard semantics or the use of a tag compression scheme.

Wildcards permit a rudimentary form of "wildcard" behavior, useful for codifying policies providing common access based on Authentication Mode.

In response to an ApplyUpdateRequest command, the OTA Provider can respond with actions such as Proceed, AwaitNextAction, or Discontinue (Section Update application process).

The data types defined within the Group Key Management Cluster are: GroupKeySecurityPolicyEnum, GroupKeyMulticastPolicyEnum, GroupKeyMapStruct, GroupKeySetStruct, and GroupInfoMapStruct.

The SecurityPolicy type contains information about Thread security policies, including key rotation time and flags.

Manufacturer-specific elements are tagged with context-specific tags defined by the vendor for use in products using their Vendor ID. These tags range from 0x80 to 0xFF.

Nodes SHALL validate the authenticity and integrity of the firmware prior to installation, such as through cryptographic means (see Section 11.19.4.2, “Image Verification”).

Could be. In case of discrepancies between this specification and the SDK [https://github.com/project-chip/connect­ edhomeip/], Matter specification SHALL take precedence.

The VendorName field in the Vendor Schema provides a human-readable (displayable) name for the product manufacturer associated with the record.

No, Crypto_TRNG() should never be called directly but used in the implementation of Crypto_DRBG() in accordance with good security practices.

Matter employs a single strong cryptographic suite based on well-established standards.

Matter: Client, HomeKit: Service client, Weave: Client, Thread: Client, Zigbee: (Not Applicable)

The SupportedLocales attribute represents a list of locale strings that are valid values for the ActiveLocale attribute.

The Cluster ID for the General Diagnostics Cluster is 0x0033.

The responder generates the session keys as described in Section 4.13.2.6.6, “Session Encryption Keys”.

- Enumerations, reserved values, and bit fields have specific rules for their definitions and use. - Number format is specified for hexadecimal, binary, and decimal numbers.

The Challenge field is a 64-bit random number generated using the DRBG by the initiator of the MsgCounterSyncReq to uniquely identify the synchronization request cryptographically.

The algorithm field in subjectPublicKeyInfo must be the object identifier for prime256v1.

The Node Operational Credentials section describes the credentials used by all Nodes to mutually authenticate each other during Certificate-Authenticated Session Establishment, including the Node Operational Certificate (NOC) chain.

Upon receipt of a Read Request action or Subscribe Request action, each request path in the AttributeRequests field is processed.

If the R Flag is set in a received message in MRP, and it is a Group Session Type with the C Flag = 0, the message is dropped.

The setup code is made non-photographable (e.g., NFC) or invisible when installed (e.g., QR code hidden with a flap).

To prepare the message as an IPv6 packet, the Node sets the private, secured message obtained earlier as the IPv6 payload. It sets the IPv6 hop count to the provided value and determines the IPv6 destination address based on the provided destination Group ID, Fabric ID, and GroupKeyMulticastPolicy Field of the group key. The IPv6 source is set to an operational IPv6 Unicast Address of the sending Node, and the IPv6 UDP port number is set to the Matter IPv6 multicast port.

The issuer field in the PAA certificate contains the information: Same as the issuer field of the example PAI certificate.

The Initiator proposes transfer parameters, block size, and other parameters in the SendInit or ReceiveInit message, and the Responder responds with a set of parameters compatible with the Initiator’s proposal, according to the Responder’s subset of capabilities.

The RoutingRoleEnum data type represents different roles a node can have in a Thread network, such as Leader, Router, etc.

Applications presenting the Manual Pairing Code should provide mechanisms (e.g., copy button) for easy conveyance of the information to other commissioners on the same device. Applications acting as commissioners should provide mechanisms (e.g., paste button) for easy conveyance of the information from an administrator on the same device. The receiving application should be robust against characters like dashes and spaces for readability.

The Name attribute indicates a display name for the disco ball.

It indicates the set of battery faults currently detected by the Node on this power source.

A Report transaction is part of a Subscribe interaction and reports data and/or events from the publisher to the subscriber.

The signature field must contain the identifier for the ecdsa-with-SHA256 signature algorithm.

After aggregating responses, clients may unsubscribe from the IPv6 multicast group that maps to the All Proxies universal group.

The UpdateFabricLabel command is used by an Administrator to set the user-visible Label field for a given Fabric.

Upon receiving a QueryImageResponse with a Status of UpdateAvailable, OTA Requestors should download the Software Image from the URI specified in the ImageURI field (Section QueryImageResponse Command).

The ResetCounts command resets the OverrunCount attribute to 0.

The Access Control List is updated by the first action, limiting Administer privilege to only Endpoint 2.

Upon receiving Pake3, the initiator verifies Pake3.cA against cA and sets the SessionTimestamp.

The BeaconRxCount attribute indicates the count of the number of received beacons.

If the decryption of TBEData2 fails, the initiator sends a status report indicating an invalid parameter and performs no further processing.

The signature algorithm used in the PAI certificate is ecdsa-with-SHA256.

Devices support over-the-air (OTA) firmware updates. They also validate the authenticity and integrity of the firmware before installation.

Constraints on incoming session establishment requests may be affected by the Access Control system based on implementation-defined rules.

The NetworkFaultChange event includes the Current list[NetworkFaultEnum] field and the Previous list[NetworkFaultEnum] field.

The HardwareVersionString Attribute provides a more user-friendly representation of the hardware version compared to the HardwareVersion Attribute, allowing easier interpretation by users.

Each endpoint supporting the Bridged Node device type must include clusters such as Basic Information and Power Source Configuration based on the specified conformance.

The Cluster ID of the Basic Information Cluster is 0x0028.

Matter has crypto-flexibility to address new developments and threats.

As an octet string corresponding to the four octets in network byte order, represented in quad-dotted notation.

Constraints related to the exact derivation of Key Identifiers can be found in various subsections: - Matter Certificates (NOC, ICAC, RCAC) Subject Key Identifier extension: see Section 6.5.11.4, “Subject Key Identifier Extension” - Matter Certificates Authority Key Identifier extension: see Section 6.5.11.5, “Authority Key Identifier Extension” - Device Attestation Certificate (DAC) extensions: see Section 6.2.2.3, “Device Attestation Certificate (DAC)” - Product Attestation Intermediate (PAI) Certificate extensions: see Section 6.2.2.4, “Product Attestation Intermediate (PAI) Certificate” - Product Attestation Authority (PAA) Certificate extensions: see Section 6.2.2.5, “Product Attestation Authority (PAA) Certificate”

The PatternChange event is generated when the Rotate, Speed, or WobbleSpeed attributes are written or changed locally as a result of processing the Pattern attribute list.

The figure in the section illustrates the Device Attestation PKI hierarchy, showing how the DAC chains up to the PAI certificate, which in turn chains up to the PAA root certificate.

The CompanyLegalName field specifies the legal name for the product manufacturer.

Membership in the security domain of an operational group is determined by a Node's possession of all the epoch keys required to generate the current, valid operational group key for the group. If a Node possesses these epoch keys, it is considered a member of the operational group. Nodes can be members of multiple operational groups simultaneously, and changes to group membership can occur over time based on application requirements and policies. Groups may be introduced or withdrawn as needed, and Nodes may join or leave groups accordingly.

The Tag type identifies a semantic tag located within a namespace.

The Requested ATT_MTU field contains the size of the GATT PDU (ATT_MTU) that can be received by the sender minus the size of the GATT header. This value is used to validate that both sides of the BLE connection are using the common minimum value.

The TxErrCcaCount attribute indicates the total number of CCA failures.

PBKDF2 is used as the HMAC-based PBKDF function, leveraging Crypto_HMAC as the auxiliary function, and is defined to comply with the specifications in Section 5.3 of NIST 800-132.

The Status field in the RetrieveLogsResponse command indicates the result of an attempt to retrieve diagnostic logs.

In Example 5, after installation, the action is initially in the Inactive state. At the scheduled "on" time, the colorful garden lighting scene is activated, changing the action’s state to Active. At the scheduled "off" time, the lights are switched off, changing the action’s state to Inactive.

It represents common designations for batteries.

The TimeZone attribute represents a list of time zone offsets from UTC and when they take effect. It allows Nodes to handle scheduled regulatory time zone changes.

The HardwareFaultChange event indicates a change in the set of hardware faults currently detected by the Node.

It can accept PASE requests after being factory-reset or entering commissioning mode.

Advertising Data is A data container used in BLE Advertisements to convey a logical grouping of information.

BTP defines a receive window for each side of a session in units of GATT PDUs. Each GATT Write Characteristic Value (ATT_WRITE_REQ) PDU or Indication (ATT_HANDLE_VALUE_IND) PDU is sent with a sequence number, which the receiver uses to acknowledge receipt of each packet and open its receive window from the sender’s perspective.

DeltaEpochTimestamp is used to encode a delta change in UTC timestamp relative to a prior event in a TLV structure.

Both commissioning and unsecured rendezvous actions time-out after at most 15 minutes from the beginning of the commissioning mode when commissioning has not been concluded.

If BDX is requested and the Status field is set to Success, the LogContent field shall be empty.

The value of matter-icac-id and matter-rcac-id DN attribute types may be any 64-bit identifier desired by the certificate’s issuer.

An IPv6 Unicast Address uniquely identifies and addresses a single Node on an IPv6 network, using either a global unicast address (GUA), a link-local address (LLA), or a unique local address (ULA) for connectivity and routability between Nodes.

- Choice conformance defines requirements for implementing one or some elements at the same level, called the choice set. - It allows specifying the number of elements that shall be supported from the choice set.

Yes, multiple operational group keys can be derived from the same epoch key. Each operational group key is derived independently using the epoch key as the input, along with the appropriate salt value. Therefore, different operational group keys can be generated for different groups or applications within the Fabric, all originating from the same epoch key material. This flexibility allows for the creation of distinct security domains and operational groups within the Fabric, each with its own unique operational group key for secure communication.

ReadRequestMessage is a TLV structure used to request data, including attribute and event requests, in a TLV structure format.

The payload of the PBKDFParamRequest message follows the pbkdfparamreq-struct TLV schema.

The Bridge forwards the commands to the relevant Bridged Device after conversion between the Matter protocol and the non-Matter device’s native protocol.

Data model elements and interactions define relationships between devices in this section.

Vendors SHOULD avail themselves of the DCL store-and-forward functionality so that they can control posting of data about their products to the DCL. [CM160 for T170]

If an attempt is made to add an Access Control Entry when no more entries are available, a RESOURCE_EXHAUSTED error is reported, and the entry is not added to the ACL attribute.

Upon completion, the ResetCounts command sends a status code set to a value of SUCCESS back to the initiator.

The ProxyNodeList field contains the list of node IDs stored in the ValidProxyList whose associated fabric matches the accessing fabric.

Devices SHALL use non-repeating initialization vectors for a given session key. [CM78 for T81]

A Controlee is a role of a Node that is configured to be controlled by one or more Nodes, having specific permissions that allow it to respond to control commands.

An Extended Color Light is a lighting device capable of being switched on or off, adjusting the intensity of its light, and adjusting its color. The adjustments can be made using a bound controller device such as a Color Dimmer Switch or Control Bridge. The device supports adjustment of color through various means such as hue/saturation, enhanced hue, color looping, XY coordinates, and color temperature.

The Common Capability Conditions category outlines common limitations or capabilities of a node.

Crypto_TRNG(), or True Random Number Generator, provides an entropy seed to the DRBG algorithm, generating arrays of len random bits.

Since the translation of an X.509 certificate from ASN.1 DER format to human-readable text format may lose fidelity, textual examples SHALL NOT be considered to be normative. Only direct encoding of DER encoding, such as PEM blocks, should be used to further study the examples. In case of unforeseen divergence between an example certificate illustration and the normative rules expressed in prose, the normative prose SHALL take precedence over an ambiguous interpretation of an example.

Each bit in the PH key corresponds to a specific method for entering Commissioning Mode. For example, bit 0 represents Power Cycle, bit 1 represents Device Manufacturer URL, bit 2 represents Administrator, and so on.

The use of the MATTER_BLE_SERVICE_UUID and Bluetooth extensions feature of this specification is strictly prohibited unless the product is certified by both the Bluetooth SIG and the Connectivity Standards Alliance.

The Device Attestation PKI hierarchy consists of the Product Attestation Authority (PAA), Product Attestation Intermediate (PAI), and individual Device Attestation Certificate (DAC). The DAC is verified using the public key from the associated PAI certificate, which is signed and attested by the PAA CA. Similarly, the PAI certificate is verified using the public key from the associated PAA certificate, which is an implicitly trusted self-signed root certificate. Thus, the DAC chains up to the PAI certificate, which chains up to the PAA root certificate.

It signifies that the battery is replaceable by the user or customer.

Installing a group onto a newly commissioned Node involves several sequential steps to ensure the seamless integration of the Node into the group communication network. The process begins with the Administrator generating a fabric-unique group ID (GID) and a random key (key0) for the group key set ID (K). Subsequently, the Administrator writes the group key set (K) to the remote Node, known as the GroupMember, using the KeySetWrite command. Additionally, the Administrator associates the group ID (GID) with the key set (K) by writing an entry to the GroupKeyMap list attribute. Once the key material is distributed and associated with the Node, the Node subscribes to the IPv6 multicast address generated from the fabric ID and group ID. Finally, the Administrator associates the endpoint with the group ID (GID) by sending the AddGroup command to the endpoint. This process ensures that the newly commissioned Node has access to the necessary key material and is seamlessly integrated into the group communication network, enabling secure communication with other group members.

When sending a Matter Message as a BTP SDU over a BTP session, the BTP SDU is split into ordered, non-overlapping BTP segments. Each BTP segment is prepended with a BTP packet header and sent as the payload of a single GATT PDU. The first segment has the Beginning Segment header flag set, and the last segment has the Ending Segment flag set. If a BTP SDU is small enough to fit into a single BTP segment, both Beginning Segment and Ending Segment flags are set for that segment.

Sessions should be discarded and re-established before any Secure Session Message Counter overflow or repetition occurs.

Endpoint composition is the indication of how endpoints are organized within a device, typically defined by Descriptor cluster attributes like DeviceTypeList and PartsList.

When using the PI key, it is recommended to keep the length of the field small and adhere to the guidelines provided in relevant standards. Additionally, if localization is required, the Commissionee is responsible for translating the instructions to the user's preferred language. Furthermore, the PI key should only be returned in the TXT record if the corresponding bit in the PH bitmap has PI Dependency set to True.

The TxBeaconRequestCount attribute indicates the total number of unique MAC Beacon Request frame transmission requests.

The SecurityPolicy attribute indicates the current security policies for the Thread partition to which a Node is connected.

The hardware platform provides core security services such as cryptographic primitives, random number generation, secured cryptographic key storage, and tamper resistance.

Passcodes must not be derived from public information and must use a cryptographically secure random number generator. Devices can support either dynamic or static passcodes, with additional rules for each type. For static passcodes, a random passcode with 27 bits of entropy must be generated and used for each individual device. Certain passcodes are considered invalid and should not be used.

It provides a user-facing description of this source, used to distinguish it from other power sources.

Yes, an interaction may be a single transaction (e.g., Read), or it may involve an unbounded number of transactions (e.g., Subscribe), as illustrated in the provided table in this section.

The CRL is validated using the certificate specified in CRLSignerCertificate as the trust anchor. Delta CRLs are not supported.

The DisableAction command disables a certain action or automation, changing the action’s state to Inactive.

The Secure Channel Protocol defines the control plane for secure channel communication and security.

here are a few external references : AdProx: Advertising Proxy for DNS-SD SRP, URL: https://tools.ietf.org/html/draft-sctl-advertising-proxy

ANSI C18: Provides the ANSI C18 standards on portable cells and batteries, URL: https://ansi.org

Bluetooth® Core Specification 4.2: URL: https://www.bluetooth.org/docman/handlers/download-doc.ashx?doc_id=441541

Bluetooth® Core Specification Supplement 11: URL: https://www.bluetooth.org/DocMan/handlers/DownloadDoc.ashx?doc_id=556598

FIPS 180-4: Outlines the NIST FIPS 180-4 Secure Hash Standard (SHS) document from August 2015. URL: https://csrc.nist.gov/publications/detail/fips/180/4/final

Message counters provide encryption nonces, ensuring each encrypted message is encrypted uniquely, and they help prevent message replay in encrypted communication.

An entry granting privileges to the On/Off Cluster on any endpoint will grant privileges only to the On/Off Cluster on any endpoint, and will not grant privileges to any other cluster.

If VendorID or ProductID Matter-specific OIDs appear in any RelativeDistinguishedName in the subject or issuer fields of a certificate within the Device Attestation Certificate chain path, the commonName, if present, is not parsed for the fallback method in the rest of the issuer or subject field where the Matter-specific OIDs appear. The fallback method is skipped for that field.

The validity period of the DAC is from Jun 28 14:23:43 2021 GMT to Dec 31 23:59:59 9999 GMT.

The BootReasonEnum "PowerOnReboot" indicates that the Node has booted as a result of physical interaction with the device resulting in a reboot.

Manufacturers SHOULD control the number of DACs issued under their Vendor ID. [CM24 for T23, T34]

Matter's architecture is described as comprehensive, strong, easy, and resilient, implying that it addresses security and privacy concerns effectively.

Invalid Matter certificates are those that violate the Matter certificate encoding rules defined in the specification. Processing of invalid Matter certificates should fail, and an error should be reported to the application. A non-exhaustive list of errors that may invalidate the certificate is provided in the specification, including violations such as: elements not defined in the section, incorrect encoding order, wrong type of elements, and invalid lengths of fields, among others.

An empty WriteResponses would occur if all paths were wildcard or group paths that expand to non-accessible data.

The System Model defines relationships managed between endpoints and clusters.

A leaf device type is not composed of other application device types. It mandates specific server clusters and does not require additional device types or endpoints.

Devices rotate keys at specified triggers, such as Factory Device Reset.

"Maximum Number of Scenes" in Scenes cluster in the Cluster Library.

Multiple vendors or companies can use the same CA hierarchy, in which case they will be governed under the same Trusted Root Certificate Authority.

The representations of the onboarding material should be unified and of a certain minimum size to be easily recognizable and usable by users. The Matter Brand Guidelines specify characteristics such as composition, colors, font, font size, QR Code size, and digit-grouping of the Manual Pairing code to support this.

The Targets field specifies a list of AccessControlTargetStruct, defining the clusters on the Node to which the Access Control Entry grants access.

Service Data Unit

The EventFilters and DataVersionFilters fields in the Subscribe Request are one-time parameters for priming the subscription.

The manufacturer custom flow should substitute the placeholder value "_" in the CallbackUrl with desired contents for a returned onboarding payload (MTrop) if present, according to a specific algorithm. The final URL (ExpandedCallbackUrl) is used for a smooth return to the Commissioner during commissioning.

The 'FeatureMap' attribute in the Network Commissioning Cluster represents supported features such as Wi-Fi, Thread, and Ethernet.

Wildcard paths contain wildcard endpoint and/or cluster indications, potentially resolving into multiple paths or element instances, as described in this section.

The UpdateToken is used to track deferred OTA application or otherwise allow short-term tracking of OTA Requestors (Section UpdateToken usage).

Matter ensures interoperability by allowing devices from multiple brands to work together seamlessly without requiring additional setup or configuration.

Administrators may indicate to users which devices are native Matter and which ones are Bridged Devices, determined using the presence of a Bridged Node device type on the endpoint. This ensures users do not make assumptions about Bridged Devices having the same security requirements as native Matter devices.

Section 10.3 outlines the data types defined in the Interaction Model (IM) specification and their encoding onto TLV wire types, along with their specific representations.

The RxErrOtherCount attribute indicates the total number of received unique MAC frame requests that have been dropped as a result of an error that is not counted by any other attribute.

A binding relationship directs a local endpoint to a remote endpoint when the local endpoint does not know the remote endpoints for client-generated actions, enabling control over remote nodes.

If power source-related information is provided in the Power Source cluster, the discovering Node SHOULD use it similarly to how it handles power source-related information for Matter Nodes.

The Sources attribute contains the set of all power sources capable of participating in the power system of a Node, with each entry being the endpoint number of an endpoint having a Power Source cluster.

The AssociationFailure event includes the AssociationFailureCause field, which contains the reason for the failure, and the Status field, which contains the Status Code value that caused the failure of the last trial attempt.

Piggyback acknowledgment processing in MRP involves determining if there is a matching pending acknowledgment for the given message and setting the A Flag on the outbound message if a match is found.

The Discriminator value helps to further identify potential devices during the setup process and improves the speed and robustness of the setup experience for the user. It is included as a 12-bit unsigned integer and should match the value advertised by the device during commissioning.

The Default field indicates the default value for the LabelList attribute.

While the Matter ICD operating mode can leverage Thread's SED behavior for Thread ICD devices, it should not be confused with the SED mode defined by the Thread standard, which specifically optimizes battery life for Thread devices.

It indicates the estimated percentage of battery charge remaining until the battery will no longer be able to provide power.

- Matter-specific DN attribute types under the private arc 1.3.6.1.4.1.37244 are used in the DAC. - Matter-specific RDNs encode values normatively defined as scalars. - Matter-specific OIDs include matter-oid-vid and matter-oid-pid for Vendor ID and Product ID respectively.

Threat T16: Seller of an Device (most likely a used one) intentionally leaves malicious software or configuration on the Device to compromise future traffic. [CM15, CM16, CM17, CM21, CM22, CM35]

The deobfuscated output (M) represents the decrypted message header fields, which are then used in the final private message in place of the encrypted message header fields.

If a pending acknowledgment already exists for the Exchange in MRP, and it has StandaloneAckSent set to false, a standalone acknowledgment shall be sent immediately for that pending message counter, and the acknowledgment table entry shall be replaced for the new message.

Pause/Resume commands are more transitionary in nature, allowing for temporary pausing and resuming of actions, while Disable/Enable commands are more permanent and have a lasting effect until explicitly enabled or disabled again.

A target grants access based on the presence of fields as follows: if it contains the Cluster field, it grants access to all clusters on any endpoint with a Descriptor containing the specified device type (if provided); if it contains the Endpoint field, it grants access to all clusters on only the specified endpoint; if it contains the DeviceType field, it grants access to all clusters on any endpoint with a Descriptor containing the specified device type.

The LatestValue field represents the latest value of the changed entry.

Manufacturers can choose from three flows: Standard, User-Intent, and Custom, each with specific actions, requirements, and packaging instructions.

A Bridged Node root endpoint represents a device on a foreign network but is not the root endpoint of the bridge itself. It describes itself and any other endpoints that make up the Bridged Node.

Root CA certificates trusted for operational credential verification are stored in the TrustedRootCertificates attribute of the Node Operational Credentials cluster. Any certificates trusted for other purposes must not appear in this attribute and can only be added by authorized entities during commissioning or root rotation operations.

The RxBroadcastCount attribute indicates the total number of received unique broadcast MAC frames.

RFC 5652: Cryptographic Message Syntax (CMS), a standard for cryptographically protected messages. URL: https://www.rfc-editor.org/rfc/rfc5652

RFC 5869: HMAC-based Extract-and-Expand Key Derivation Function (HKDF), a method for key derivation. URL: https://www.rfc-editor.org/rfc/rfc5869

RFC 5905: Network Time Protocol Version 4, the protocol for clock synchronization between computer systems. URL: https://www.rfc-editor.org/rfc/rfc5905

RFC 5952: A Recommendation for IPv6 Address Text Representation, guidelines for representing IPv6 addresses as text. URL: https://www.rfc-editor.org/rfc/rfc5952

RFC 6335: Service Name and Port Number Procedures, procedures for the registration of service names and port numbers. URL: https://www.rfc-editor.org/rfc/rfc6335

RFC 6760: Replacement of AppleTalk NBP, discusses the replacement for AppleTalk Name Binding Protocol (NBP). URL: https://www.rfc-editor.org/rfc/rfc6760

RFC 6762: Multicast DNS, defining the Multicast DNS protocol for local network service discovery. URL: https://www.rfc-editor.org/rfc/rfc6762

RFC 6763: DNS-Based Service Discovery, defining how to use DNS records for service discovery. URL: https://www.rfc-editor.org/rfc/rfc6763

RFC 6920: Naming Things with Hashes, a method for naming things with cryptographic hashes. URL: https://www.rfc-editor.org/rfc/rfc6920

RFC 6960: X.509 Internet Public Key Infrastructure Online Certificate Status Protocol - OCSP, a protocol for obtaining the revocation status of an X.509 digital certificate. URL: https://www.rfc-editor.org/rfc/rfc6960

RFC 7230: Hypertext Transfer Protocol (HTTP/1.1): Message Syntax and Routing, part of the HTTP/1.1 standard. URL: https://www.rfc-editor.org/rfc/rfc7230

RFC 7346: IPv6 Multicast Address Scopes, defining scopes for IPv6 multicast addresses. URL: https://www.rfc-editor.org/rfc/rfc7346

RFC 7468: Textual Encodings of PKIX, PKCS, and CMS Structures, guidelines for textual encodings of cryptographic structures. URL: https://www.rfc-editor.org/rfc/rfc7468

RFC 7558: Scalable DNS-SD Requirements, requirements for scalable DNS-based service discovery. URL: https://www.rfc-editor.org/rfc/rfc7558

RFC 8305: Happy Eyeballs Version 2: Better Connectivity Using Concurrency, an algorithm to improve connectivity. URL: https://www.rfc-editor.org/rfc/rfc8305

RFC 8490: DNS Stateful Operations, defining stateful operations for DNS. URL: https://www.rfc-editor.org/rfc/rfc8490

RFC 8765: DNS Push Notifications, specifying a mechanism for DNS servers to send real-time updates. URL: https://www.rfc-editor.org/rfc/rfc8765


An ACL entry with CASE AuthMode granting privileges to Subject IDs [0x0000_0000_1111_1111, 0x0000_0000_2222_2222, 0x0000_0000_3333_3333] will grant access to nodes with Node IDs 0x0000_0000_1111_1111, 0x0000_0000_2222_2222, or 0x0000_0000_3333_3333.

A Group Node ID contains a particular Group ID in the lower half, identifying a set of Nodes associated with a specific group within the Fabric.

It signifies that the cell chemistry is alkaline.

All message counters are initialized with a random value using the Crypto_DRBG(len = 28) + 1 primitive.

The Node Operational Identifier is used for Node discovery, network address resolution, and logical addressing within a network segment. It includes the FabricID, NodeID, and optionally CASEAuthenticatedTag attributes for access control.

The mechanism for encoding the interaction model using tag compression for AttributePathIB, EventPathIB, and AttributeDataIB is provisional, indicating it is in a testing phase and may be adjusted.

MATTER_BLE_SERVICE_UUID is the UUID for the Matter-over-BLE service as assigned by the Bluetooth SIG. Value: 0xFFF6.

The ProtocolData portion of the StatusReport message is composed of all data beyond the ProtocolCode field. If a StatusReport message of size N octets is received, the first 8 octets of payload encode the GeneralCode, ProtocolId, and ProtocolCode, while the remaining N - 8 bytes represent the protocol-specific ProtocolData.

Risks associated with smart home systems and devices include product malfunction through remote control, DDoS attacks, data breaches, theft of intellectual property, and potential harm to humans.

The DetachedRoleCount attribute indicates the number of times the Node entered the OT_DEVICE_ROLE_DETACHED role.

In the context of encrypted messages, message counters ensure that every message is encrypted uniquely, serving as nonces for the encryption algorithm.

The BlockAck message is an application-level acknowledgment that a Block was received, indicating receipt but not necessarily storage of the Block's data.

After successful verification, the initiator sets the Resumption ID, generates session keys, initializes counters and states, and sets session identifiers.

Matter-specific DN attribute types are additional attribute types under the 1.3.6.1.4.1.1.37244 private arc. They are listed in Table 57, “Matter-specific DN Object Identifiers”, and are assigned by the Connectivity Standards Alliance for use with Matter.

The Valid Write Attribute Paths table defines valid attribute data paths for the Path field of an AttributeDataIB in a Write Request action. It includes combinations with wildcards, non-group (node & endpoint), and group paths.

The NetworkFaultEnum data type indicates different types of network faults, such as LinkDown, HardwareFailure, etc.

The ICD's configuration and current operating mode affect message travel time.

Administrators create and maintain a consistent distributed configuration of Access Control Lists (ACLs) across all Nodes.

The responder obtains the SharedSecret from the resumed session, generates the S1RK key, and verifies the Resume1MIC contained in Msg1.sigma1ResumeMIC.

Bindings can be either unicast, targeting a single endpoint on a single node, or groupcast, targeting a group indicating multiple endpoints on multiple nodes.

Commissioning Mode refers to the state of a Node in which it allows Commissioning, making it ready to be integrated into a network or system.

Matter validates certificate paths against the "current time", which can be a trusted real-time clock value or the last-known-good UTC time, with provisions to adjust the Last Known Good UTC Time based on trusted time values.

After receipt, a client cannot expect any previously established PASE session to still be usable, due to the server having cleared such sessions.

A Secure Session Message Counter is a per-session, 32-bit, ephemeral counter used by the encoding of encrypted messages using an associated session key.

If the subject is authenticated over a PASE commissioning channel, the algorithm implicitly grants administer privilege to the commissioner.

If IsRevoked is TRUE after the execution of the algorithm.


The Cluster ID of the User Label Cluster is 0x0041.

The Destination Node ID field, an optional field, contains the unique Node Identifier of the destination Node or group to which the message is being sent. The size and encoding of this field depend on the value of the DSIZ field in the Message Flags.

The Onboarding Payload is composed of required and optional information used by the Commissioner to ensure interoperability between commissioners and devices and provide a consistent user experience. It may be encoded into different formats, including human-readable (such as numeric string) and machine-readable (such as QR code and NFC) formats for printing, display, or integration into the device.

Matter: Commissioner, HomeKit: Admin, Weave: Fabric provisioner, Thread: Commissioner, Zigbee: Coordinator

The Element Requirements section lists qualities and conformance that may override the cluster specification requirements.

Nodes should rotate their encryption keys regularly to retire old keys before a Global Group Encrypted Message Counter has a chance to wrap to a previously used value.

During the Application Data Phase, the conceptual session context data utilized includes Session Type, Session Role, Local Session Identifier, Peer Session Identifier, I2RKey, R2IKey, SharedSecret, Local Message Counter, Message Reception State, Local Fabric Index, Peer Node ID, Resumption ID, SessionTimestamp, ActiveTimestamp, SESSION_IDLE_INTERVAL, SESSION_ACTIVE_INTERVAL, SESSION_ACTIVE_THRESHOLD, and PeerActiveMode.

The computation of the ISD is a pre-condition to the algorithm.

OTA providers that cannot reliably stay available to service OTA requestors are recommended to avoid responding with an available OTA software image unless they have sufficient availability to allow a long-running BDX Protocol transfer to finish (Section 11.19.5.3).

Some of the types of faults described in the HardwareFaultEnum include Unspecified, Radio, Sensor, ResettableOverTemp, NonResettableOverTemp, PowerSource, VisualDisplayFault, AudioOutputFault, UserInterfaceFault, NonVolatileMemoryError, and TamperDetected.

The initiator generates the session encryption keys using the method described in Section 4.13.2.6.6, “Session Encryption Keys”.

The Encryption Key associated with the Session ID and Destination Node ID, along with the Session Type associated with the Destination Node ID, is obtained.

It uses the pkcs7-data type.

The HVAC-related device types listed are: - 0x0300 Heating/Cooling Unit - 0x0301 Thermostat - 0x002B Fan - 0x002D Air Purifier - 0x002C Air Quality Sensor

Attributes in this cluster should be filled with available information, which could come from the Bridged Device provided to the Bridge over the non-Matter interface or provided by the user. The Reachable attribute indicates whether the bridged device is reachable by the bridge over the non-Matter network, and the UniqueID attribute should be updated when the Bridge is factory reset.

Message counters are used by receiving systems to detect messages that have been retransmitted by the sender, such as in response to packet loss in the network.

The semantic validation of Matter certificates involves ensuring compliance with the technical specification of the certificate structure and its conversion to and from X.509 certificates.

In this user journey, the user first initiates an interaction with the Device, indicating a desire to connect the Device with a Commissioner on the network. The Device then uses Commissioner Discovery over DNS-SD on the IP-bearing network, collects candidates from DNS-SD service records found, displays a list of Commissioners discovered to the user, and allows the user to select an entry from the list. The Device then enters Commissioning Mode, displays the onboarding payload to the user, and initiates a User Directed Commissioning session with the selected Commissioner.

The deobfuscated output (M) represents the decrypted message header fields, which are then used in the final private message in place of the encrypted message header fields.

AttributeDataIB = { DataVersion = 1, Path = [[ Endpoint = 10, Cluster = Disco Ball, FieldID = Pattern, ListIndex = 1]], Data = { /* Data fields */ } }

The optional key PH provides a pairing hint, indicating methods supported by the Commissionee for entering Commissioning Mode.

If the path indicated by the Read Request action does not conform to Valid Read Attribute Paths, a Status Response with the INVALID_ACTION Status Code is generated, and the interaction and process are terminated without generating a Report Data action.

All implementations shall accept, parse, and handle Matter certificates with up to 5 RDNs in a single DN.

Providing the ICAC certificate in both X.509 and Matter TLV formats allows for validation of the encoding rules specified for Matter certificates against the widely used X.509 standard, ensuring compliance, interoperability, and ease of integration into existing systems.

An Outgoing Invoke Response Action is generated in response to an Invoke Request action or Invoke Response action, after all valid commands are executed.

Upon receipt of an Incoming Timed Request Action, the layer constructs and sends a Status Response action with SUCCESS to the initiator. Additionally, the layer expects a Write Request or Invoke Request action within Timeout milliseconds of sending the Status Response action.

The ISD is derived from an incoming message based on both incoming message fields and session metadata fields in a deterministic manner.

Device manufacturers provide a way to secure a static Passcode after initial commissioning so that it is not available for unauthorized agents.

It is recommended to define a constraint on the maximum possible count for both lists and octet strings.

The outgoing Status Response Action must be unicast, not generated in response to a groupcast, and generated according to interactions defined in the specification.

Administrators should carefully consider the effect of Access Control Entries targeting entire Endpoints to ensure granted privileges are appropriate for all Clusters on those Endpoints, both now and in the future. They should also be mindful that targeting by Device Type grants privileges to all Clusters on all Endpoints with Descriptors containing that Device Type.

The key usage extension shall be encoded with exactly one flag: digitalSignature.

The TemperatureUnit attribute has three options: Fahrenheit for temperature conveyed in Fahrenheit, Celsius for temperature conveyed in Celsius, and Kelvin for temperature conveyed in Kelvin.

It indicates that the battery is at full charge.

The target host name is constructed using available link-layer addresses such as the 48-bit device MAC address for Ethernet and Wi-Fi or the 64-bit MAC Extended Address for Thread. These addresses are expressed as fixed-length twelve-character (or sixteen-character) hexadecimal strings, encoded in ASCII (UTF-8) using capital letters. In cases where MAC address randomization is employed for privacy, the privacy-preserving randomized version of the MAC address is used, and the hostname is updated whenever the underlying link-layer address changes [RFC 6762].

Yes, the issuer and subject fields in the PAA certificate match exactly.

The Fixed Label Cluster can be used by a bridge to indicate the grouping of bridged devices, such as identifying all devices in the same room.

The algorithm should consider all fields provided by the OTA Requestor and provide the newest matching Software Image (Section 11.19.3.3).

Transactions are defined as sequences of actions in this part of the specification.

If a Global Group Encrypted Message Counter wraps before key rotation, all keys associated with that counter are considered exhausted and are no longer valid for use.

The revisions mentioned in the revision history of the Pump device are: - 0 Represents device definitions prior to Zigbee 3.0 - 1 Initial Zigbee 3.0 release - 2 New data model format and notation

The PartsList attribute indicates the composition of the device type instance, specifying which endpoints are included in the composition based on the Endpoint Composition rules.

Personal Identification Number

If an unsupported node, endpoint, cluster, attribute, or attribute data field is indicated by the path, an AttributeStatusIB is generated with the appropriate UNSUPPORTED_* Status Code, and the path is discarded.

The maximum length of the SupportedCalendarTypes list is equivalent to the number of enumerations within CalendarTypeEnum.

Administrator is A Node having Administer privilege over at least the Access Control Cluster of another Node.

Administrators should use regular actions to administer the Access Control Cluster, including reading and writing entries in the list.

Each endpoint supporting the Dimmable Plug-In Unit device type SHALL include the following clusters: - Identify Server - Groups Server - Scenes Server - On/Off Server - Level Control Server

The elements are Endpoint, Cluster, and Command.

In Example 2, the StartActionWithDuration command triggers the server to activate a dynamic pattern with colors inspired by sunset on the associated lights for a specified duration, such as "play sunset in living room for 1 hour".

Matter uses SPAKE2+, a specific PAKE protocol, which includes roles for the verifier (Commissionee/Responder) and prover (Commissioner/Initiator), and relies on Crypto_PBKDF for its underlying PBKDF.

Nodes SHALL support OTA firmware updates, either using Matter-provided means (see Section 11.19, “Over-the-Air (OTA) Software Update”) or proprietary means.

The AddTrustedRootCertificate command adds a Trusted Root CA Certificate to the TrustedRootCertificates Attribute list and ensures its use in subsequent AddNOC commands.

It indicates the type of action, which, along with its SupportedCommands, can be used by the client in its UX or logic to determine how to present or use such action.

The WobbleSpeed attribute indicates the speed of the wobble rotation in revolutions per minute.

The ProviderLocation structure encodes a fabric-scoped location of an OTA provider on a given fabric.

The Access Control system evaluates all access requests by checking them against the rules defined in Access Control Entries (ACEs) within the Node's Access Control List (ACL). It ensures that access is explicitly granted for the requested action on the specified Targets by the identified Subject. Additionally, administrative access privileges are implicitly granted during the commissioning phase to facilitate initial setup and configuration.

All PASE messages adhere to the specifications outlined in Section 4.4, "Message Frame Format," and are unsecured. The Session ID field is set to 0, the Session Type bits of the Security Flags are set to 0, and the S Flag and DSIZ fields of the Message Flags are set to 0.

Multi-byte integer fields in Matter messages are transmitted in little-endian byte order unless otherwise specified in the field description.

There are no VendorID values present in the subject field of the PAA certificate.

The initiator encodes the following items into sigma-3-tbsdata: initiatorNOC, initiatorICAC (if present), InitiatorEphKeyPair.publicKey, and Msg2.responderEphPubKey.

The ConnectNetworkResponse command relates status information for the last connection attempt.

The PanId attribute indicates the 16-bit identifier of the Node on the Thread network.

Master should always be Matter's best branch. Release branches, once cut, are closed for any feature work. Software fixes for release branches must first land on master unless demonstrably infeasible.

The responder uses Crypto_AEAD_GenerateEncrypt with S2RK key to generate the resumption MIC.

The Sigma2 resumption key (S2RK) is generated using Crypto_KDF with the SharedSecret, Sigma1.initiatorRandom, and ResumptionID.

The command fails if it is received without an armed fail-safe context, if a prior similar command was executed within the fail-safe timer period, or if validity checks on the certificate fail.

Command fields are defined in a table with columns for ID, Name, Type, Constraint, Quality, Default, and Conformance.

The TRCA anchors a Fabric and plays a crucial role in ensuring the authenticity and security of the Fabric.

VendorID is encoded as an AttributeTypeAndValue entry with the type equal to 1.3.6.1.4.1.37244.2.1, following the encoding specified in Section 6.1.1.

The pairing hint is represented as a base-10 numeric value for a bitmap of methods supported by the Commissionee for entering Commissioning Mode.

In X.509 format, the RCAC certificate is represented with its serial number, signature algorithm, issuer and subject information, public key details, X.509 extensions including Basic Constraints, Key Usage, Subject Key Identifier, and Authority Key Identifier, and the signature.

The Statistics feature indicates the ability to collect and read out statistics regarding the usage of the Disco Ball.

IPv4Addresses are represented as a list of IPv4 addresses currently assigned to the network interface.

Matter ensures the highest level of confidentiality and integrity in data communications between devices by implementing civilian standards of network communications, preventing unauthorized entities from eavesdropping or tampering with the data.

The purpose of the Pake3 message is for the initiator to finalize the PAKE protocol and verify the integrity of the exchanged parameters.

An entry granting privileges to the Color Light Bulb Device Type will grant privileges to any cluster on any endpoint that contains the Color Light Bulb device type, and will not grant privileges to any other cluster on any other endpoint.

Matter specifically uses BTP to define a Matter-over-Bluetooth Low Energy (MATTERoBLE) Interface.

The Secure Channel and Message Layer provides a consistent networking service substrate to allow Nodes to communicate securely with one another.

Some Class Tags mentioned include: Node (device type is classified as a Node device type), App (device type is classified as an Application device type), Simple (device type is classified as a Simple device type), Dynamic (device type is classified as a Dynamic device type), Client (there exists a client application cluster on the endpoint), Server (there exists a server application cluster on the endpoint), Composed (device type is composed of 2 or more device types), EZ-Initiator (the endpoint is an Initiator for Zigbee EZ-Mode Finding & Binding), EZ-Target (the endpoint is a Target for Zigbee EZ-Mode Finding & Binding), and BridgedPowerSourceInfo (the endpoint represents a Bridged Device, for which information about the state of its power source is available to the Bridge).

The EnableActionWithDuration command has ActionID, InvokeID, and Duration as its data fields.

- Format version - Vendor ID - Product ID array - Device type ID - Certificate ID - Security level - Security information - Version number - Certification type - DAC origin vendor ID (optional) - DAC origin product ID (optional) - Authorized PAA list (optional)

Operational group keys facilitate generating, disseminating, and managing shared symmetric keys across a group of Nodes in a Fabric. These keys are utilized for authenticating peers, securing group communications, and encrypting data. They enable Nodes to prove their membership in the associated group, exchange messages confidentially, and encrypt data in a manner that only members of the group can decrypt.

Device credentials and privileges are revoked when the Device is removed from the home.

In the Key Usage extension, both the keyCertSign and cRLSign bits must be set. The digitalSignature bit may be set, and other bits must not be set.

Matter security is designed to be easy to use by providing examples, test vectors, and modularly defined software implementations in the Matter core specification and reference implementations. Security assets are well defined, and customers purchasing Matter devices do not need to think about security as it is already integrated.

The purpose of the Pake2 message is for the responder to continue the PAKE protocol after receiving Pake1 from the initiator.

Provide the setup information to any Matter Commissioner using secure means or by displaying it on the device.

The CommissioningCustomFlowUrl can contain a query component with key-value pairs separated by '&'. Keys beginning with "MT" not covered in specific rules are reserved for future use. The keys "MTcu" and "MTop" should be included with specific values.

They can either immediately expire the fail-safe or wait for it to expire before proceeding.

If SuppressResponse is FALSE and the action is part of a Subscribe interaction with an invalid SubscriptionID, the Status Response Action shall have a status code of INVALID_SUBSCRIPTION.

The SEKeys_Info byte array is used as input information for the key derivation function and identifies the purpose of deriving the session encryption keys.

The elements are Path and DataVersion.

It suggests that the charge level is low, and intervention may soon be required.

The overridden element requirements for the Dimmable Plug-In Unit device are: - Identify Command TriggerEffect - Scenes Command EnhancedAddScene - Scenes Command EnhancedViewScene - Scenes Command CopyScene - On/Off Feature - Level Control Feature - Level Control Attribute CurrentLevel - Level Control Attribute MinLevel - Level Control Attribute MaxLevel

AttributePathIB is a TLV structure used to represent a list of attributes within a specific context, such as Endpoint, Cluster, and Attribute.

The Timed Request action defines a time interval within which the Write Request action should be sent.

In Example 4, a user can disable the wake-up routine for the weekend by using the DisableActionWithDuration command, for example, to disable the sequence for 2 days (172,800 seconds), which is equivalent to "22460*60 s".

The ChangeType field indicates the type of change as appropriate.

Each endpoint supporting the Aggregator device type must include clusters based on the specified conformance, including the OTA Software Update Client and OTA Software Update Server clusters.

The 'LastConnectErrorValue' attribute indicates the ErrorValue used in the last failed attempt to connect to an operational network.

The sequence diagram shows an example where the sender transmits a multicast message, receivers receive and process the message, then generate and send MsgCounterSyncReq messages to the sender, followed by the sender responding with MsgCounterSyncRsp messages.

Some types of network faults described in the NetworkFaultEnum include Unspecified, HardwareFailure, NetworkJammed, and ConnectionFailed.

The encoding for Manual Pairing Code does not have a dedicated field for Custom Flow. Instead, the presence or absence of Vendor ID and Product ID in the code indicates the type of commissioning flow (Standard, User-intent, or Custom) to the commissioner.

The Client Window Size specifies the maximum receive window size supported by the server, specified in units of BTP packets. Each packet may be up to 244 bytes in length.

The device management service uses a secure communication mechanism for reconfiguration.

The nonce is formatted as specified in Table 15, “Nonce”, which consists of three octets: Security Flags, Message Counter, and Source Node ID.

The steps involved in processing a received message are as follows: 1. Perform validity checks on the message: a. The Version field SHALL be 0. b. If the message is of Secure Unicast Session Type: i. The DSIZ field SHALL NOT indicate a Group ID is present. c. If the message is of Group Session Type: i. The DSIZ field SHALL NOT be 0. ii. The S Flag field SHALL NOT be 0. 2. If the message is NOT of Unsecured Session Type: a. Obtain the Privacy and Encryption Keys associated with the given Session ID. i. If no keys are found, security processing SHALL indicate a failure to the next higher layer with a status of 'message security failed' and no further security processing SHALL be done on this message. b. For each Privacy and Encryption Key: i. If the P Flag is set, follow Section 4.8.4, “Privacy Processing of Incoming Messages” to deobfuscate the message. ii. Follow Section 4.7.3, “Security Processing of Incoming Messages” to decrypt and authenticate the message. 3. Follow Section 4.5.6, “Counter Processing of Incoming Messages” to enforce replay protection and duplicate detection. 4. If the message transport is UDP, follow Section 4.11.5.2, “Reliable Message Processing of Incoming Messages” to process message reliability. 5. If the message’s Session Type is a Unicast Session: a. Set SessionTimestamp and ActiveTimestamp to a timestamp from a clock which would allow for the eventual determination of the last session use relative to other sessions. 6. The received message is then delivered to Section 4.9.5, “Exchange Message Processing”.

The PartNumber Attribute specifies a human-readable vendor-assigned part number for the Node, with the meaning and numbering scheme defined by the vendor. Multiple products may share a ProductID but have different PartNumbers, which may vary based on factors like regional packaging or product variations.

The DSTTableEmpty event is generated when the node stops applying the current DSTOffset and there are no entries in the list with a larger ValidStarting time, indicating the need to possibly get new DST data.

Cryptographic keys are randomly chosen using strong entropy and cryptographic algorithms and key lengths specified by Matter.

The secured outgoing message consists of the concatenation of the additional data octet string A and the output C from the AEAD generate and encrypt operation.

There should only be one proxy node directly subscribed to a source in a single-fabric setting.

The purpose is to track revisions of the cluster specification.